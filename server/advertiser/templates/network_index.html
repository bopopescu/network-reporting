{% extends "advertiser/base.html" %}

{% load filters %}


{% block pageTitle %}
  <h1> Networks </h1>
{% endblock pageTitle %}


{% block navLinks %}
  <li><a href="{% url publisher_index %}">Dashboard</a></li>
  <li><a href="{% url advertiser_campaign %}">Campaigns</a></li>
  <li><a href="{% url marketplace_index %}">Marketplace</a></li>
  <li class="active"><a href="{% url network_index %}">Networks</a></li>
{% endblock navLinks %}


{% block content %}
  <div class="clearfix">
    <section class="offset nomargin" id="dashboard-stats">

      <h3 class="stats-chart-title">
        Realtime Stats for {{start_date|format_date_compact}} to {{end_date|format_date_compact}}
      </h3>

      {# Controls and stats breakdown for the top realtime stats #}
      <div class="stats">
        <div class="stats-breakdown">
          <table>
            <tbody>
              <tr class="active" id="stats-breakdown-impression_count">
                <td class="stats-breakdown-value today"><span class="inner"></span></td>
                <td class="stats-breakdown-value yesterday"><span class="inner"></span></td>
                <td class="stats-breakdown-value all"><span class="inner"></span></td>
                <th class="stats-breakdown-name"><span class="inner">Impressions</span></th>
              </tr>
              <tr id="stats-breakdown-click_count">
                <td class="stats-breakdown-value today"><span class="inner"></span></td>
                <td class="stats-breakdown-value yesterday"><span class="inner"></span></td>
                <td class="stats-breakdown-value all"><span class="inner"></span></td>
                <th class="stats-breakdown-name"><span class="inner">Clicks</span></th>
              </tr>
              <tr id="stats-breakdown-ctr">
                <td class="stats-breakdown-value today"><span class="inner"></span></td>
                <td class="stats-breakdown-value yesterday"><span class="inner"></span></td>
                <td class="stats-breakdown-value all"><span class="inner"></span></td>
                <th class="stats-breakdown-name"><span class="inner">CTR</span></th>
              </tr>
            </tbody>
          </table>
        </div>
        <div class="stats-breakdown-buttons">
          <span class="buttonset button-small" id="stats-breakdown-dateOptions">
            <input type="radio" name="stats-breakdown-dateOptions-option" value="today" id="stats-breakdown-dateOptions-option-0" checked="checked"/>
            <label for="stats-breakdown-dateOptions-option-0">Today</label>
            <input type="radio" name="stats-breakdown-dateOptions-option" value="yesterday" id="stats-breakdown-dateOptions-option-1"/>
            <label for="stats-breakdown-dateOptions-option-1">Yesterday</label>
            <input type="radio" name="stats-breakdown-dateOptions-option" value="all" id="stats-breakdown-dateOptions-option-2"/>
            <label for="stats-breakdown-dateOptions-option-2">All</label>
          </span>
        </div>
        <div class="chart stats-chart" id="dashboard-stats-chart"></div>
      </div>

    </section>
  </div>

  <br />
  <a id="add_campaign_button" class="right button add icon"  href="{% url advertiser_campaign_create %}#network">Add a network</a>
  <br />
  <br />

  <form method="post" action="{% url advertiser_bid_pause %}" id="campaignForm">
    <input type="hidden" name="action" id="action"/>
    <div id="adgroups">
    </div>
    <div class="form-submit-left">
        <span class="buttonWrap">
            <a class="button pause icon" id="campaignForm-pause">Pause</a>
            <a class="button play icon" id="campaignForm-resume">Resume</a>
            <a class="button stop icon" id="campaignForm-delete">Delete</a>
        </span>
    </div>
  </form>
{% endblock content %}


{% block extraScripts %}
  <script type="text/html" id="adgroups-rollup-template">
    {% include "partials/adgroups_rollup.html" %}
  </script>
  <script type="text/html" id="adgroups-table-template">
    {% include "partials/adgroups_table.html" %}
  </script>
  <script type="text/javascript" src="/js/models.js?v=5"></script>
  <script type="text/javascript" src="/js/views.js?v=5"></script>
  <script type="text/javascript" src="/js/controllers/networks.js?v=5"></script>
  <script>
    $(function() {
      NetworksController(
        [{% for adgroup in network_adgroups %}{
          id: '{{ adgroup.key }}',
          active: {% if adgroup.active %}true{% else %}false{% endif %},
          name: '{{ adgroup.name }}',
          details_url: '{% url advertiser_adgroup_show adgroup_key=adgroup.key %}',
          network_type: '{{ adgroup.network_type }}'}{% if not forloop.last %},{% endif %}{% endfor %}],
        Date.UTC({{ start_date.year }}, {{ start_date.month|add:"-1" }}, {{ start_date.day }}),
        {{ days|add:"-1" }},
        {{ days|add:"-2" }},
        's={{ start_date.year }}-{{ start_date.month }}-{{ start_date.day }}&r={{ date_range }}'
      );
    });
  </script>
{% endblock extraScripts %}
