function checkReport(a){var b=$("#reportKey").val();b&&$.ajax({url:"/reports/check/"+b+"/?retry="+a,success:writeReport})}function writeReport(a){if(a.data=="none"){retry++,setTimeout("checkReport("+retry+")",2500);return}$("#preloader").hide(),$("#table-goes-here").append(a.data),buildTable($("#report-table"))}function buildTable(a){a.dataTable({bJQueryUI:!0,aLengthMenu:[[50,100,-1],[50,100,"All"]],iDisplayLength:50,aoColumnDefs:[{asSorting:["desc","asc"],aTargets:[0,1,2,3,4]}],aaSorting:[[1,"asc"]]})}function loadedArtwork(a){if(!$("#dashboard-searchAppStore-custom-modal").dialog("isOpen"))return;$("#searchAppStore-results").html(""),$("#searchAppStore-loading").hide(),$("#dashboard-searchAppStore-custom-modal").dialog("close"),artwork_json=a;var b=a.resultCount;if(b==0){$("#searchAppStore-results").append("<div class='adForm-appSearch-text' />").append("No results found"),$("#dashboard-searchAppStore-custom-modal").dialog("open");return}for(var c=0;c<b;c++){if(c>10)break;var d=a.results[c];$("#searchAppStore-results").append($("<div class='adForm-appSearch' />").append($("<div class='adForm-appSearch-img' />").append($("<img />").attr("src",d.artworkUrl60).width(40).height(40)).append($("<span />"))).append($("<div class='adForm-appSearch-text' />").append($("<span />").append($('<a href="#" onclick="selectArtwork('+c+');return false";>'+d.trackName+"</a>")).append("<br />"+d.artistName))).append($("<div class='clear' />")))}$("#dashboard-searchAppStore-custom-modal").dialog("open")}function selectArtwork(a){$("#searchAppStore-results").html(""),$("#appForm-icon").html(""),$("#dashboard-searchAppStore-custom-modal").dialog("close");var b=artwork_json.results[a],c=$('input:radio[name="app_type"]:checked').val(),d=$("app_form");$('#appForm input[name="name"]').val(b.trackName),$('#appForm input[name="description"]').val(b.description),c=="iphone"?$('#appForm input[name="url"]').val(b.trackViewUrl):c=="android"&&$('#appForm input[name="package"]').val(b.trackViewUrl),$('#appForm input[name="img_url"]').val(b.artworkUrl60),$('#appForm select[name="primary_category"]').val(b.primaryGenreName.toLowerCase()),$('#appForm select[name="secondary_category"]').val(b.genres[1].toLowerCase()),$("#appForm-icon").append($("<img />").attr("src",b.artworkUrl60).width(40).height(40).append($("<span />")))}function loadedArtwork(a){if(!$("#dashboard-searchAppStore-custom-modal").dialog("isOpen"))return;$("#searchAppStore-results").html(""),$("#searchAppStore-loading").hide(),$("#dashboard-searchAppStore-custom-modal").dialog("close"),artwork_json=a;var b=a.resultCount;if(b==0){$("#searchAppStore-results").append("<div class='adForm-appSearch-text' />").append("No results found"),$("#dashboard-searchAppStore-custom-modal").dialog("open");return}for(var c=0;c<b;c++){if(c>10)break;var d=a.results[c];$("#searchAppStore-results").append($("<div class='adForm-appSearch' />").append($("<div class='adForm-appSearch-img' />").append($("<img />").attr("src",d.artworkUrl60).width(40).height(40)).append($("<span />"))).append($("<div class='adForm-appSearch-text' />").append($("<span />").append($('<a href="#" onclick="selectArtwork('+c+');return false";>'+d.trackName+"</a>")).append("<br />"+d.artistName))).append($("<div class='clear' />")))}$("#dashboard-searchAppStore-custom-modal").dialog("open")}function selectArtwork(a){$("#searchAppStore-results").html(""),$("#appForm-icon").html(""),$("#dashboard-searchAppStore-custom-modal").dialog("close");var b=artwork_json.results[a],c=$('input:radio[name="app_type"]:checked').val(),d=$("app_form");$('#appForm input[name="name"]').val(b.trackName),$('#appForm input[name="description"]').val(b.description),c=="iphone"?$('#appForm input[name="url"]').val(b.trackViewUrl):c=="android"&&$('#appForm input[name="package"]').val(b.trackViewUrl),$('#appForm input[name="img_url"]').val(b.artworkUrl60),$('#appForm select[name="primary_category"]').val(b.primaryGenreName.toLowerCase()),$('#appForm select[name="secondary_category"]').val(b.genres[1].toLowerCase()),$("#appForm-icon").append($("<img />").attr("src",b.artworkUrl60).width(40).height(40).append($("<span />")))}(function(){var a=function(a){var b=navigator.userAgent.toLowerCase();return b.indexOf(a)!==-1},b=function(){return"ie7"};window.Browser={get_browser:b}})();var retry=0;$(document).ready(checkReport(retry)),function(){var a={},b=null,c=null,d=document.title,e=null,f=null,g={},h={width:7,height:9,font:"10px arial",colour:"#ffffff",background:"#F03D25",fallback:!0},i=function(a){var b=navigator.userAgent.toLowerCase();return b.indexOf(a)!==-1},j={chrome:i("chrome"),webkit:i("chrome")||i("safari"),safari:i("safari")&&!i("chrome"),mozilla:i("mozilla")&&!i("chrome")&&!i("safari")},k=function(){var a=document.getElementsByTagName("link");for(var b=0;b<a.length;b++)if(a[b].getAttribute("rel")==="icon")return a[b];return!1},l=function(){var a=document.getElementsByTagName("link"),b=document.getElementsByTagName("head")[0];for(var c=0;c<a.length;c++)a[c].getAttribute("rel")==="icon"&&b.removeChild(a[c])},m=function(){if(!c||!b){var a=k();c=b=a?a.getAttribute("href"):"/favicon.ico"}return b},n=function(){return f||(f=document.createElement("canvas"),f.width=16,f.height=16),f},o=function(a){l();var b=document.createElement("link");b.type="image/x-icon",b.rel="icon",b.href=a,document.getElementsByTagName("head")[0].appendChild(b)},p=function(a){window.console&&window.console.log(a)},q=function(a,b){if(!n().getContext||!j.chrome&&!j.mozilla)return r(a);var c=n().getContext("2d"),b=b||"#000000",a=a||0;e=new Image,e.onload=function(){c.clearRect(0,0,16,16),c.drawImage(e,0,0),a>0&&s(c,a,b),t()},e.src=m()},r=function(a){g.fallback&&(a>0?document.title="("+a+") "+d:document.title=d)},s=function(a,b,c){var d=(b+"").length-1,e=g.width+6*d,f=16-e,h=16-g.height;a.font=(j.webkit?"bold ":"")+g.font,a.fillStyle=g.background,a.strokeStyle=g.background,a.lineWidth=1,a.fillRect(f,h,e-1,g.height),a.beginPath(),a.moveTo(f-.5,h+1),a.lineTo(f-.5,15),a.stroke(),a.beginPath(),a.moveTo(15.5,h+1),a.lineTo(15.5,15),a.stroke(),a.beginPath(),a.strokeStyle="rgba(0,0,0,0.3)",a.moveTo(f,16),a.lineTo(15,16),a.stroke(),a.fillStyle=g.colour,a.textAlign="right",a.textBaseline="top",a.fillText(b,15,j.webkit?6:7)},t=function(){if(!n().getContext)return;o(n().toDataURL())};a.setOptions=function(a){g={};for(var b in h)g[b]=a[b]?a[b]:h[b];return this},a.setImage=function(a){return b=a,t(),this},a.setBubble=function(a,b){return isNaN(a)?p("Bubble must be a number"):(q(a,b),this)},a.reset=function(){a.setImage(c)},a.setOptions(h),window.Tinycon=a}(),function(a){function c(){return a("<div>").css(b.notificationStyles).hover(function(){a(this).css(b.notificationStylesHover)},function(){a(this).css(b.notificationStyles)})}var b=window.ToastjsConfig={defaultTimeOut:3e3,position:["top","right"],notificationStyles:{padding:"12px 18px",margin:"0 0 6px 0",backgroundColor:"#000",opacity:.8,color:"#fff",font:"normal 13px 'Droid Sans', sans-serif",borderRadius:"3px",boxShadow:"#999 0 0 12px",width:"300px"},notificationStylesHover:{opacity:1,boxShadow:"#000 0 0 12px"},container:a("<div></div>")};a(document).ready(function(){b.container.css("position","absolute"),b.container.css("z-index",9999),b.container.css(b.position[0],"12px"),b.container.css(b.position[1],"12px"),a("body").append(b.container)});var d=window.Toast={};d.notify=function(d,e,f,g){var h=c();g=g||b.defaultTimeOut;if(f){var i=a("<img/>",{src:f,css:{width:36,height:36,display:"inline-block",verticalAlign:"middle"}});h.append(i)}var j=a("<div/>").css({display:"inline-block",verticalAlign:"middle",padding:"0 12px"});if(e){var k=a("<div/>");k.append(document.createTextNode(e)),k.css("font-weight","bold"),j.append(k)}if(d){var l=a("<div/>");l.append(document.createTextNode(d)),j.append(l)}h.delay(g).fadeOut(function(){h.remove()}),h.bind("click",function(){h.hide()}),h.append(j),b.container.prepend(h)},d.info=function(a,b){d.notify(a,b,"")},d.warning=function(a,b){d.notify(a,b,"")},d.error=function(a,b){d.notify(a,b,"/images/36x36-error.png")},d.success=function(a,b){d.notify(a,b,"/images/36x36-success.png")}}(this.jQuery),function(a){a.fn.tokenInput=function(b,c){var d=a.extend({url:b,hintText:"Type in a search term",noResultsText:"No results",searchingText:"Searching...",searchDelay:300,minChars:1,tokenLimit:null,jsonContainer:null,method:"GET",contentType:"json",queryParam:"q",onResult:null,onAdd:null,onDelete:null,doImmediate:!0,country:"US",featureClass:null,featureCode:null,maxRows:10},c);return d.classes=a.extend({tokenList:"token-input-list",token:"token-input-token",tokenDelete:"token-input-delete-token",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token"},c.classes),this.each(function(){var b=new a.TokenList(this,d)})},a.TokenData=function(b,c){function i(){var b=d.lat+","+d.lng+":"+d.adminCode1+":"+d.name+":"+d.countryCode;return a('<input type="hidden" class="'+d.countryCode+'" name="cities" id="'+d.name.replace(/ /gi,"_")+'" value="'+b+'" />')}function j(){return a('<input type="hidden" name="geo" id="'+h+'" value="'+h+'" />')}var d=b,e,f,g,h;return c=="city"?(e=d.name+", "+d.adminCode1,f=i,g=d.name):c=="country"&&(h=d.data===undefined?d.code:d.data.code,e=d.data===undefined?d.name:d.data.name,f=j,g=h),{name:e,input:f,raw:b,type:c,id:g}},a.TokenList=function(b,c){function r(){var b=a(".token-input-country").length;b>1?(a(".token-input-city").each(function(b){A(a(this))}),a(".token-input-state").each(function(b){A(a(this))}),a('input[name="location-targeting"]').each(function(b){a(this).val()!="all"?a(this).attr("disabled",!0):a(this).click()})):a('input[name="location-targeting"]').each(function(b){a(this).attr("disabled",!1)});var c=a("#geo_pred_ta").children().length;a(".countryNumDependent").hide(),a(".countryNumDependent."+c).show()}function s(){var b=c.prePopulate.data;if(b&&b.length)for(var d in b){var e=new a.TokenData(b[d],c.prePopulate.type),f=a("<li><p>"+e.name+"</p> </li>").addClass(c.classes.token);e.type=="city"?f.addClass("token-input-city").addClass(e.raw.countryCode):e.type=="country"&&f.addClass("token-input-country"),f.insertBefore(q),a("<span>&times;</span>").addClass(c.classes.tokenDelete).appendTo(f).click(function(){return A(a(this).parent()),!1}),a.data(f.get(0),"tokeninput",e),k.val("").focus(),B(),e.input().appendTo(l)}k.blur()}function t(a){return a>=48&&a<=90||a>=96&&a<=111||a>=186&&a<=192||a>=219&&a<=222?!0:!1}function u(b,c){return a(b.target).closest(c)}function v(b){var d=b.name,e,f=a("<li><p>"+d+"</p> </li>");return b.type=="city"?f.addClass("token-input-city").addClass(b.raw.countryCode):b.type=="country"&&f.addClass("token-input-country"),f.addClass(c.classes.token).insertBefore(q),a("<span>x</span>").addClass(c.classes.tokenDelete).appendTo(f).click(function(){return A(a(this).parent()),!1}),a.data(f.get(0),"tokeninput",b),f}function w(b){r();var d=a.data(b.get(0),"tokeninput"),e=v(d),f=c.onAdd;k.val("").focus(),B(),d.input().appendTo(l),g++,h++,c.tokenLimit!==null&&g>=c.tokenLimit&&(k.hide(),B()),a.isFunction(f)&&f(d.id),r()}function x(a){a.addClass(c.classes.selectedToken),m=a.get(0),k.val(""),B()}function y(a,b){a.removeClass(c.classes.selectedToken),m=null,b==d.BEFORE?q.insertBefore(a):b==d.AFTER?q.insertAfter(a):q.appendTo(o),k.focus()}function z(b){m==b.get(0)?y(b,d.END):(m&&y(a(m),d.END),x(b))}function A(b){var d=a.data(b.get(0),"tokeninput"),e=c.onDelete;b.remove(),m=null,k.focus();if(d===undefined)return;var f=d.id.replace(/ /gi,"_"),h=d.name.replace(/ /gi,"_");a("#"+f).remove(),a("#"+h).remove(),d.type=="country"&&a("li."+d.id+".token-input-city").each(function(b){A(a(this))}),g--,a(".token-input-country").length===0&&a("#advertiser-LocationSpec-all").click(),c.tokenLimit!==null&&k.show().val("").focus(),a.isFunction(e)&&e(d.id),r()}function B(){p.hide().empty(),n=null}function C(){p.html("<p>"+c.searchingText+"</p>").show()}function D(){p.html("<p>"+c.hintText+"</p>").show()}function E(a,b){var c=a.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+b+")(?![^<>]*>)(?![^&;]+;)","gi"),"<b>$1</b>");return c}function G(b,d){var e=d.type;d=d.data;if(d&&d.length){var f=p.clone();f.empty();var g=a("<ul>").appendTo(f).mouseover(function(a){H(u(a,"li"))}).mousedown(function(a){return w(u(a,"li")),!1});F||g.hide();var h;for(var i in d)if(d.hasOwnProperty(i)){var j=new a.TokenData(d[i],e),k=a("<li>"+E(j.name,b)+"</li>").appendTo(g);i%2?k.addClass(c.classes.dropdownItem):k.addClass(c.classes.dropdownItem2),i==0&&H(k),a.data(k.get(0),"tokeninput",j)}p.replaceWith(f),p=f,p.show(),F||(F=!0,g.slideDown("fast"))}else F=!1,p.html("<p>"+c.noResultsText+"</p>").show()}function H(b){b&&(n&&I(a(n)),b.addClass(c.classes.selectedDropdownItem),n=b.get(0))}function I(a){a.removeClass(c.classes.selectedDropdownItem),n=null}function J(b){var e=k.val().toLowerCase();e&&e.length&&(m&&y(a(m),d.AFTER),e.length>=c.minChars?(C(),b?K(e):(clearTimeout(j),j=setTimeout(function(){K(e)},c.searchDelay))):e.length>0?D():B())}function K(b){b=k.val().toLowerCase();var d=i.get(b);if(d){var e={type:"country",data:d};G(b,e)}else{var f=c.url.indexOf("?")<0?"?":"&",g=function(d){a.isFunction(c.onResult)&&(d=c.onResult.call(this,d)),i.add(b,c.jsonContainer?d[c.jsonContainer]:d);var e={type:c.type,data:d.geonames};G(b,e)};if(c.method=="POST")a.post(c.url+f+c.queryParam+"="+encodeURIComponent(b),{},g,c.contentType);else{var h=c.url+f+c.queryParam+"="+encodeURIComponent(b);c.featureClass!==null&&(h+="&featureClass="+encodeURIComponent(c.featureClass)),c.featureCode!==null&&(h+="&featureCode="+encodeURIComponent(c.featureCode)),h+="&country=",a('input[name="geo"]').val()!==undefined?h+=encodeURIComponent(a('input[name="geo"]').val()):h+=encodeURIComponent(c.country),h+="&maxRows="+c.maxRows,a.get(h,{},g,c.contentType)}}}var d={BEFORE:0,AFTER:1,END:2},e={BACKSPACE:8,TAB:9,RETURN:13,ESC:27,LEFT:37,UP:38,RIGHT:39,DOWN:40,COMMA:188},f=[],g=0,h=0,i=new a.TokenList.Cache(c),j,k=a('<input class="token-input-field" type="text"  autocomplete="off">').css({outline:"none"}).focus(function(){(c.tokenLimit===null||c.tokenLimit!=g)&&D(),a(this).addClass("focused"),o.hasClass("focused")||o.addClass("focused"),a(this).val()&&setTimeout(function(){J(c.doImmediate)},5)}).blur(function(){a(this).removeClass("focused"),o.removeClass("focused"),B()}).keydown(function(b){var f,g;switch(b.keyCode){case e.LEFT:case e.RIGHT:case e.UP:case e.DOWN:if(!!a(this).val()){var h=null;return b.keyCode==e.DOWN||b.keyCode==e.RIGHT?h=a(n).next():h=a(n).prev(),h.length&&H(h),!1}f=q.prev(),g=q.next(),f.length&&f.get(0)===m||g.length&&g.get(0)===m?b.keyCode==e.LEFT||b.keyCode==e.UP?y(a(m),d.BEFORE):y(a(m),d.AFTER):b.keyCode!=e.LEFT&&b.keyCode!=e.UP||!f.length?(b.keyCode==e.RIGHT||b.keyCode==e.DOWN)&&g.length&&x(a(g.get(0))):x(a(f.get(0)));break;case e.BACKSPACE:f=q.prev();if(!a(this).val().length)return m?A(a(m)):f.length&&x(a(f.get(0))),!1;a(this).val().length==1?B():setTimeout(function(){J(c.doImmediate)},5);break;case e.TAB:case e.RETURN:case e.COMMA:if(n)return w(a(n)),!1;break;case e.ESC:return B(),!0;default:t(b.keyCode)&&setTimeout(function(){J(c.doImmediate)},5)}}),l=a(b).hide().focus(function(){k.focus()}).blur(function(){k.blur()}),m=null,n=null,o=a("<ul />").addClass(c.classes.tokenList).insertBefore(l).click(function(b){a(this).addClass("focused");var c=u(b,"li");if(c&&c.get(0)!=q.get(0))return z(c),!1;k.focus(),m&&y(a(m),d.END)}).mouseover(function(a){var b=u(a,"li");b&&m!==this&&b.addClass(c.classes.highlightedToken)}).mouseout(function(a){var b=u(a,"li");b&&m!==this&&b.removeClass(c.classes.highlightedToken)}).mousedown(function(a){var b=u(a,"li");if(b)return!1}),p=a("<div>").addClass(c.classes.dropdown).insertAfter(o).hide(),q=a("<li />").addClass(c.classes.inputToken).appendTo(o).append(k);s(),r();var F=!1},a.TokenList.Cache=function(b){function d(a,c){b.matchCase||(a=a.toLowerCase());var d=a.indexOf(c);return d==-1?!1:d===0||b.matchContains}function h(a){function b(b,c){return i(a,b.value)-i(a,c.value)}return b}function i(a,b){return b.length-a.length}function j(g){if(!b.cacheLength||!f)return null;if(!b.url&&c.matchContains){var i=[];for(var j in e)if(j.length>0){var k=e[j];a.each(k,function(a,b){if(d(b.value,g)){var c=!0;for(var e in i){var f=i[e];if(b.result==f.result){c=!1;break}}c&&i.push(b)}})}return i.sort(h(g))}if(e[g])return e[g];if(c.matchSubset)for(var l=g.length-1;l>=1;l--){var k=e[g.substr(0,l)];if(k){var i=[];return a.each(k,function(a,b){d(b.value,g)&&(i[i.length]=b)}),i}}return null}function k(){if(!b.data)return!1;var c={},d=0;b.url||(b.cacheLength=1),c[""]=[];for(var e=0,f=b.data.length;e<f;e++){var g=b.data[e];g=typeof g=="string"?[g]:g;var h=b.formatMatch(g,e+1,b.data.length);for(var i=0;i<h.length;i++){var j=h[i];if(j===!1)continue;var k=j.charAt(0).toLowerCase();c[k]||(c[k]=[]);var m={value:j,data:g,result:b.formatResult&&b.formatResult(g)||j};c[k].push(m),d++<b.max&&c[""].push(m)}}a.each(c,function(a,c){b.cacheLength++,l(a,c)})}function l(a,b){f>c.max_size&&g(),e[a]||f++,e[a]=b}var c=a.extend({max_size:50,matchContains:!0},b),e={},f=0,g=function(){e={},f=0};return setTimeout(k,25),{flush:g,get:j,populate:k,add:l}}}(jQuery),function(a,b,c){var d=b.Model.extend({defaults:{revenue:0,attempts:0,impressions:0,cpm:0,fill_rate:0,clicks:0,cpc:0,ctr:0},url:function(){return"/api/ad_network/account_roll_up/"}}),e=b.Collection.extend({model:g,url:function(){return"/api/ad_network/daily_stats/"}}),f=b.Model.extend({defaults:{revenue:0,attempts:0,impressions:0,cpm:0,fill_rate:0,clicks:0,cpc:0,ctr:0},url:function(){return"/api/ad_network/roll_up/"+this.get("type")+"/id/"+this.id}}),g=b.Model.extend({defaults:{name:"",revenue:0,attempts:0,impressions:0,cpm:0,fill_rate:0,clicks:0,cpc:0,ctr:0},url:function(){return"/api/ad_network/app_on_network/"+this.get("network")+"/pub_id/"+this.id}}),h=b.Collection.extend({model:g});window.AccountRollUp=d,window.DailyStatsCollection=e,window.RollUp=f,window.AppOnNetwork=g,window.AppOnNetworkCollection=h}(this.jQuery,this.Backbone,this._);var mopub=mopub||{};(function(a,b,c){function e(a,b){return a===null||b===null?null:a===0?0:b/a}function f(a,b){return a===null||b===null?null:a===0?0:b/a}function g(a,b){if(b===null)return"--";switch(a){case"click_count":case"conversion_count":case"goal":case"impression_count":case"request_count":return mopub.Utils.formatNumberWithCommas(b);case"cpm":case"revenue":return"$"+mopub.Utils.formatNumberWithCommas(b.toFixed(2));case"conv_rate":case"ctr":case"fill_rate":return mopub.Utils.formatNumberAsPercentage(b);case"status":return b;default:throw'Unsupported stat "'+a+'".'}}"use strict";var d=b.Model.extend({defaults:{name:"",budget:0,budget_type:"",start_datetime:new Date,end_datetime:null,active:!1}}),h={calculate_ctr:e,calculate_fill_rate:f,format_stat:g},i=b.Model.extend({get_stat:function(a){return this.has(a)?this.get(a):null},get_formatted_stat:function(a){return g(a,this.get_stat(a))},get_stat_for_day:function(a,b){if(!this.has("daily_stats"))return null;var c=this.get("daily_stats");if(b>=c.length)return null;var d=c[b];return!a in d?null:d[a]},url:function(){return"/api/adgroup/"+this.id}}),j=b.Collection.extend({model:i,get_stat_sum:function(a){return this.reduce(function(b,c){return b===null||!c.has(a)?null:b+c.get(a)},0)},get_stat:function(a){switch(a){case"ctr":return e(this.get_stat("impression_count"),this.get_stat("click_count"));case"fill_rate":return f(this.get_stat("request_count"),this.get_stat("impression_count"));case"click_count":case"conversion_count":case"impression_count":case"request_count":case"revenue":return this.get_stat_sum(a);default:throw'Unsupported stat "'+a+'".'}},get_formatted_stat:function(a){return g(a,this.get_stat(a))},get_stat_sum_for_day:function(a,b){return this.reduce(function(c,d){return c===null||!d.has("daily_stats")||b>=d.get("daily_stats").length||!(a in d.get("daily_stats")[b])?null:c+d.get("daily_stats")[b][a]},0)},get_stat_for_day:function(a,b){switch(a){case"ctr":return e(this.get_stat_for_day("impression_count",b),this.get_stat_for_day("click_count",b));case"fill_rate":return f(this.get_stat_for_day("request_count",b),this.get_stat_for_day("impression_count",b));case"click_count":case"conversion_count":case"impression_count":case"request_count":case"revenue":return this.get_stat_sum_for_day(a,b);default:throw'Unsupported stat "'+a+'".'}},get_formatted_stat_for_day:function(a,b){return g(a,this.get_stat_for_day(a,b))},get_total_daily_stats:function(a){var b=[],c;for(c in this.at(0).get("daily_stats"))b.push(this.get_stat_for_day(a,c));return b},get_chart_data:function(a){var b=this.filter(function(b){return b.has(a)&&b.has("daily_stats")});if(b.length===0)return[];var d=c.sortBy(b,function(a){return-a.get("impression_count")}),e=d.splice(0,3),f=new j(d),g=e.map(function(b){var d={};return d[b.get("name")]=c.map(b.get("daily_stats"),function(b){return b[a]}),d});return f.size()&&g.push({Others:f.get_total_daily_stats(a)}),a==="ctr"&&g.push({"MoPub Optimized":this.get_total_daily_stats("ctr")}),g},get_days:function(){return this.reduce(function(a,b){return b.has("daily_stats")&&b.get("daily_stats").length>a?b.get("daily_stats").length:a},0)},isFullyLoaded:function(){return this.reduce(function(a,b){return a&&b.has("impression_count")},!0)}}),k=b.Model.extend({defaults:{active:!1,attempts:0,clicks:0,ctr:0,ecpm:0,fill_rate:0,impressions:0,name:"",price_floor:0,requests:0,revenue:0,stats_endpoint:"all"},validate:function(a){if(typeof a.price_floor!="undefined"){var b=Number(a.price_floor);if(isNaN(b))return"Please enter a valid number for the price floor"}},url:function(){var a=this.get("stats_endpoint");return"/api/app/"+this.app_id+"/adunits/"+this.id+"?"+window.location.search.substring(1)+"&endpoint="+a}}),l=b.Collection.extend({model:k,url:function(){var a=this.stats_endpoint;return"/api/app/"+this.app_id+"/adunits/"+"?"+window.location.search.substring(1)+"&endpoint="+a}}),m=b.Model.extend({defaults:{name:"",url:"#",icon_url:"/placeholders/image.gif",app_type:"",active:!1,attempts:0,clicks:0,ctr:0,ecpm:0,fill_rate:0,impressions:0,price_floor:0,requests:0,revenue:0,stats_endpoint:"all"},url:function(){var a=this.get("stats_endpoint");return"/api/app/"+this.id+"?"+window.location.search.substring(1)+"&endpoint="+a},parse:function(a){var b=a[0];return b.app_type==="iphone"&&(b.app_type="iOS"),b.app_type==="android"&&(b.app_type="Android"),b.app_type==="mweb"&&(b.app_type="Mobile Web"),b},get_summed:function(a){if(typeof this.get(a)!="undefined"){var b=this.get(a),d=c.reduce(b,function(a,b){return a+b},0);return d}return null}}),n=b.Collection.extend({model:m,url:function(){var a=this.stats_endpoint;return"/api/app/?"+window.location.search.substring(1)+"&endpoint="+a},fetchAdUnits:function(){this.each(function(a){a.adunits=new l,a.adunits.app_id=a.id,a.adunits.fetch()})}});window.AdUnit=k,window.AdUnitCollection=l,window.App=m,window.AppCollection=n,window.AdGroup=i,window.AdGroups=j,window.ModelHelpers=h})(this.jQuery,this.Backbone,this._),function(a,b){var c=b.View.extend({initialize:function(){this.model.bind("change",this.render,this)},render:function(){var b="#dashboard-stats .stats-breakdown",c=".stats-breakdown-value .inner";return a("#stats-breakdown-revenue "+c,b).text(mopub.Utils.formatCurrency(this.model.get("revenue"))),a("#stats-breakdown-impressions "+c,b).text(mopub.Utils.formatNumberWithCommas(this.model.get("impressions"))),a("#stats-breakdown-clicks "+c,b).html('<span class="muted unbold">('+mopub.Utils.formatNumberWithCommas(this.model.get("clicks"))+")</span> "+mopub.Utils.formatNumberAsPercentage(this.model.get("ctr"))),this}}),d=b.View.extend({initialize:function(){this.collection.bind("reset",this.render,this)},render:function(){models=this.collection.models;var a=models.map(function(a){return a.attributes});return populateGraphWithStats(a),this}}),e=b.View.extend({initialize:function(){this.model.bind("change",this.render,this)},render:function(){this.model.get("type")=="network"&&this.model.get("sync_date")&&a("#"+this.model.id+"-row .network-status span:first").append(this.model.get("sync_date"));var b=a("tr#"+this.model.id+"-row");return a(".revenue",b).text(mopub.Utils.formatCurrency(this.model.get("revenue"))),a(".attempts",b).text(mopub.Utils.formatNumberWithCommas(this.model.get("attempts"))),a(".impressions",b).text(mopub.Utils.formatNumberWithCommas(this.model.get("impressions"))),a(".cpm",b).text(mopub.Utils.formatCurrency(this.model.get("cpm"))),a(".fill-rate",b).text(mopub.Utils.formatNumberAsPercentage(this.model.get("fill_rate"))),a(".clicks",b).text(mopub.Utils.formatNumberWithCommas(this.model.get("clicks"))),a(".cpc",b).text(mopub.Utils.formatCurrency(this.model.get("cpc"))),a(".ctr",b).text(mopub.Utils.formatNumberAsPercentage(this.model.get("ctr"))),this}}),f=b.View.extend({initialize:function(){this.model.bind("change",this.render,this)},render:function(){return context_dict={name:this.model.get("app_name")+"  ",network:this.model.get("network_name"),key:this.model.get("mapper_key"),url:"/ad_network_reports/app_view/"+this.model.get("mapper_key"),revenue:mopub.Utils.formatCurrency(this.model.get("revenue")),attempts:mopub.Utils.formatNumberWithCommas(this.model.get("attempts")),impressions:mopub.Utils.formatNumberWithCommas(this.model.get("impressions")),cpm:mopub.Utils.formatCurrency(this.model.get("cpm")),fill_rate:mopub.Utils.formatNumberAsPercentage(this.model.get("fill_rate")),clicks:mopub.Utils.formatNumberWithCommas(this.model.get("clicks")),cpc:mopub.Utils.formatCurrency(this.model.get("cpc")),ctr:mopub.Utils.formatNumberAsPercentage(this.model.get("ctr"))},network_html=_.template(a("#app-on-network-row-template").html(),context_dict),a("#app-on-"+this.model.get("network")).append(network_html),context_dict.name=this.model.get("network_name")+"  ",app_html=_.template(a("#app-on-network-row-template").html(),context_dict),a("#"+this.model.get("app_key")+"-on-networks").append(app_html),a(".details-row").mouseover(function(){var b=a(this).attr("id");a(".details-"+b).removeClass("hidden")}),a(".details-row").mouseout(function(){var b=a(this).attr("id");a(".details-"+b).addClass("hidden")}),this}});window.AccountRollUpView=c,window.DailyStatsView=d,window.AppOnNetworkView=f,window.RollUpView=e}(this.jQuery,this.Backbone);var mopub=window.mopub||{};(function(a,b,c){"use strict";var d=b.View.extend({initialize:function(){this.collection.bind("change",this.render,this)},filtered_collection:function(){var b=a("#campaigns-filterOptions").find(":checked").val(),c=a("#campaigns-appFilterOptions").val();return new AdGroups(this.collection.reject(function(a){return b&&b!==a.get("status")||c&&a.get("apps").indexOf(c)===-1}))},render:function(){var b=this.filtered_collection(),d;if(b.size()===0)d="<h2>No "+this.options.title+"</h2>";else{d=c.template(a("#adgroups-rollup-template").html(),{adgroups:b,title:this.options.title,type:this.options.type});if(this.options.tables){var e=this.options.type;c.each(this.options.tables,function(f,g){var h=new AdGroups(b.filter(f));h.length&&(d+=c.template(a("#adgroups-table-template").html(),{adgroups:h,title:g,type:e}))})}else d+=c.template(a("#adgroups-table-template").html(),{adgroups:b,title:"Name",type:this.options.type})}return a(this.el).html(d),this}}),e=b.View.extend({initialize:function(){this.collection.bind("change",this.render,this)},show_chart:function(){if(this.collection.isFullyLoaded()){var b=a("#dashboard-stats .stats-breakdown .active"),c=b.attr("id")==="stats-breakdown-ctr";mopub.Chart.setupDashboardStatsChart(c?"line":"area")}},render:function(){var b=this;if(b.collection.isFullyLoaded()){var c=["impression_count","revenue","click_count","ctr"];a.each(c,function(c,d){var e="#stats-breakdown-"+d+" .all .inner";a(e).html(b.collection.get_formatted_stat(d))}),b.options.yesterday!==null&&b.options.today!==null&&(a.each(c,function(c,d){var e="#stats-breakdown-"+d+" .yesterday .inner";a(e).html(b.collection.get_formatted_stat_for_day(d,b.options.yesterday))}),a.each(c,function(c,d){var e="#stats-breakdown-"+d+" .today .inner";a(e).html(b.collection.get_formatted_stat_for_day(d,b.options.today))})),mopub.dashboardStatsChartData={pointStart:b.options.start_date,pointInterval:864e5,impression_count:b.collection.get_chart_data("impression_count"),revenue:b.collection.get_chart_data("revenue"),click_count:b.collection.get_chart_data("click_count"),ctr:b.collection.get_chart_data("ctr")},b.show_chart()}}}),f=b.View.extend({initialize:function(){try{this.template=c.template(a("#app-template").html())}catch(b){}},renderInline:function(){var b=a("tr.app-row#app-"+this.model.id,this.el);return a(".revenue",b).text(mopub.Utils.formatCurrency(this.model.get("revenue"))),a(".impressions",b).text(mopub.Utils.formatNumberWithCommas(this.model.get("impressions"))),a(".ecpm",b).text(mopub.Utils.formatCurrency(this.model.get("ecpm"))),a(".clicks",b).text(mopub.Utils.formatNumberWithCommas(this.model.get("clicks"))),a(".ctr",b).text(mopub.Utils.formatNumberAsPercentage(this.model.get("ctr"))),a(".fill_rate",b).text(mopub.Utils.formatNumberAsPercentage(this.model.get("fill_rate"))),a(".requests",b).text(mopub.Utils.formatNumberWithCommas(this.model.get("requests"))),a(".attempts",b).text(mopub.Utils.formatNumberWithCommas(this.model.get("requests"))),a(".conversions",b).text(mopub.Utils.formatNumberWithCommas(this.model.get("conversions"))),a(".conv_rate",b).text(mopub.Utils.formatNumberAsPercentage(this.model.get("conversion_rate"))),a(".loading-img",b).hide(),this},render:function(){var b=a(this.template(this.model.toJSON()));return a("tbody",this.el).append(b),this}}),g=b.View.extend({initialize:function(){try{this.template=c.template(a("#adunit-template").html())}catch(b){}},renderInline:function(){var b=this.model,c=a("tr.adunit-row#adunit-"+this.model.id,this.el);return a(".revenue",c).text(mopub.Utils.formatCurrency(this.model.get("revenue"))),a(".ecpm",c).text(mopub.Utils.formatCurrency(this.model.get("ecpm"))),a(".impressions",c).text(mopub.Utils.formatNumberWithCommas(this.model.get("impressions"))),a(".price_floor",c).html('<img class="loading-img hidden" src="/images/icons-custom/spinner-12.gif"></img> <input id="'+this.model.id+'" '+'type="text" '+'class="input-text input-text-number number" '+'style="width:50px;margin: -3px 0;" '+'value="'+this.model.get("price_floor")+'"> '),a(".targeting",c).html('<img class="loading-img hidden" src="/images/icons-custom/spinner-12.gif"></img> <input class="targeting-box" type="checkbox">'),a(".fill_rate",c).text(mopub.Utils.formatNumberAsPercentage(this.model.get("fill_rate"))),a(".ctr",c).text(mopub.Utils.formatNumberAsPercentage(this.model.get("ctr"))),a(".clicks",c).text(mopub.Utils.formatNumberWithCommas(this.model.get("clicks"))),a(".requests",c).text(mopub.Utils.formatNumberWithCommas(this.model.get("requests"))),a(".attempts",c).text(mopub.Utils.formatNumberWithCommas(this.model.get("requests"))),a(".conversions",c).text(mopub.Utils.formatNumberWithCommas(this.model.get("conversions"))),a(".conv_rate",c).text(mopub.Utils.formatNumberAsPercentage(this.model.get("conversion_rate"))),this.model.get("active")&&a("input.targeting-box",c).attr("checked","checked"),a("input.targeting-box",c).click(function(){var d=a(".targeting .loading-img",c);d.show(),b.save({active:a(this).is(":checked")},{success:function(){setTimeout(function(){d.hide()},2e3)}})}),a(".price_floor .input-text",c).keyup(function(){var d=a(this);d.removeClass("error");var e=a(".price_floor .loading-img",c);e.show();var f=b.save({price_floor:a(this).val()});f?(f.success(function(){e.hide()}),f.error(function(){e.hide()})):(e.hide(),d.addClass("error"))}),this},render:function(){var b=this.model,c=a(this.template(this.model.toJSON()));a(".price_floor_change",c).change(function(){b.set({price_floor:a(this).val()});var c=a(".save",a(this).parent());c.click(function(a){a.preventDefault(),c.addClass("disabled").text("Saving..."),b.save({},{success:function(){setTimeout(function(){c.removeClass("disabled").text("Saved"),c.text("Save")},2e3)}})})}),a("input.targeting-box",c).click(function(){var d=a(this).attr("name"),e=a(this).is(":checked")?"On":"Off";a('label[for="'+d+'"]',c).text(e),b.set({active:a(this).is(":checked")}),b.save()});var d=a("tr#app-"+this.model.get("app_id"),this.el),e=d.hasClass("even")?"even":"odd";return c.addClass(e),d.after(c),this}});window.AdUnitView=g,window.AppView=f,window.AdGroupsView=d,window.CollectionGraphView=e})(this.jQuery,this.Backbone,this._);var mopub=mopub||{};(function(a){a(document).ready(
function(){a("input:text").addClass("input-text"),a("input:password").addClass("input-text"),a(".button.continue").button({icons:{secondary:"ui-icon-circle-triangle-e"}}),a("#accountForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#accountForm").submit()}),a(".adForm").each(function(){function i(b){var c=a(".ui-button-text",b);return c.length==0&&(c=b),c}function j(a,b){i(a).text(b)}function k(a){a.removeClass("hide"),a.addClass("show"),a.togglebutton.button("option",{icons:{primary:"ui-icon-triangle-1-n"}}),j(a.togglebutton,a.togglebutton.hideText)}function l(a){a.removeClass("show"),a.addClass("hide"),a.togglebutton.button("option",{icons:{primary:"ui-icon-triangle-1-s"}}),j(a.togglebutton,a.togglebutton.showText)}var b=a(this),c=a(".formFields",b),d=a(".adForm-fields-toggleButton",b),e=a(".adForm-fields-infoButton",b),f=a(".accountInfoForm",b),g=a(".adForm-fields-appButton",b),h=a(".adForm-apps",b);c.togglebutton=d,c.togglebutton.showText="Show details",c.togglebutton.hideText="Hide details",h.togglebutton=g,h.togglebutton.showText="Show apps",h.togglebutton.hideText="Hide apps",c.hasClass("show")?k(c):(c.hide(),l(c)),d.click(function(a){a.preventDefault(),c.hasClass("show")?(c.slideUp("fast"),l(c)):(c.slideDown("fast"),k(c))}),e.button({icons:{secondary:"ui-icon-info"}}).click(function(b){b.preventDefault(),f.dialog({width:570,buttons:[{text:"Close",click:function(){a(this).dialog("close")}}]})}),g.button({icons:{primary:"ui-icon-triangle-1-s"}}).click(function(a){a.preventDefault(),h.hasClass("show")?(h.slideUp("fast"),l(h)):(h.slideDown("fast"),k(h))}).click(),h.hasClass("show")?k(h):(h.hide(),l(h))})})})(this.jQuery),$(function(){function a(a,b,c){if(c){var d=new Date;d.setTime(d.getTime()+c*24*60*60*1e3);var e="; expires="+d.toGMTString()}else var e="";document.cookie=a+"="+b+e+"; path=/"}function b(a){var b=a+"=",c=document.cookie.split(";"),d;for(d=0;d<c.length;d++){var e=c[d];while(e.charAt(0)==" ")e=e.substring(1,e.length);if(e.indexOf(b)==0)return e.substring(b.length,e.length)}return null}function c(b){a(b,"",-1)}function d(a){var b=new RegExp(/^(\s*)(("[\w-+\s]+")|([\w-+]+(?:\.[\w-+]+)*)|("[\w-+\s]+")([\w-+]+(?:\.[\w-+]+)*))(@((?:[\w-+]+\.)*\w[\w-+]{0,66})\.([a-z]{2,6}(?:\.[a-z]{2})?)$)|(@\[?((25[0-5]\.|2[0-4][\d]\.|1[\d]{2}\.|[\d]{1,2}\.))((25[0-5]|2[0-4][\d]|1[\d]{2}|[\d]{1,2})\.){2}(25[0-5]|2[0-4][\d]|1[\d]{2}|[\d]{1,2})\]?$)/i);return b.test(a)}var e={initializeAdReportsIndex:function(e){var f=e.networks_data,g=e.apps_data,h=e.ajax_query_string,i=new AccountRollUp,j=new AccountRollUpView({model:i});i.fetch({data:h});var k=new DailyStatsCollection,l=new DailyStatsView({collection:k});k.fetch({data:h});var m;for(m=0;m<f.length;m++){var n=f[m];if(n.models.length>0){var o=new RollUp({id:n.network,type:"network"}),p=new RollUpView({model:o});o.fetch({data:h})}}for(m=0;m<g.length;m++){var q=g[m],o=new RollUp({id:q.id,type:"app"}),p=new RollUpView({model:o});o.fetch({data:h})}for(m=0;m<f.length;m++){var n=f[m];if(n.models.length>0){var r=new AppOnNetworkCollection(n.models);r.each(function(a){var b=new AppOnNetworkView({model:a});a.fetch({data:h})})}}$(".addcreds").click(function(a){a.preventDefault();var b=$(this).attr("href").replace("#","");$("#"+b+"-fields").show(),$("#ad_network_selector").val(b),$("#credential-form").dialog({buttons:{Close:function(){$(this).dialog("close")}},width:500})}),$("#networkSettingsForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(a){a.preventDefault(),$("#networkSettingsForm-loading").show(),$("#settings-form-message").hide();var b=!0,c=$("#network-settingsForm textarea").val().split(",");for(var e=0;e<c.length;e++)d(c[e])||(b=!1);b?$.ajax({type:"POST",url:"/ad_network_reports/settings/",data:$("#networkForm").serialize(),success:function(a){$("#networkSettingsForm-loading").hide()},error:function(a,b,c){$("#settings-form-message").html("Couldn't update settings."),$("#settings-form-message").show(),$("#networkSettingsForm-loading").hide()}}):($("#settings-form-message").html("Please enter a valid email address or a list of valid email addresses."),$("#settings-form-message").show(),$("#networkSettingsForm-loading").hide())}),$("#networkSettingsForm-cancel").click(function(a){a.preventDefault(),$("#network-settingsForm").slideUp("fast")}),$("#network-settingsButton").button({icons:{primary:"ui-icon-wrench"}}).click(function(a){a.preventDefault(),$("#network-settingsForm").is(":visible")?$("#network-settingsForm").slideUp("fast"):$("#network-settingsForm").slideDown("fast")}),$("#dashboard-sort-network").click(function(){c("network-reports-tab")}),$("#dashboard-sort-app").click(function(){a("network-reports-tab","#dashboard-sort-app",7)}),b("network-reports-tab")=="#dashboard-sort-app"&&($("#dashboard-sort-app").click(),$(".apps").addClass("active"),$(".networks").removeClass("active")),$(".show-status").click(function(){var a=$(this).attr("id"),b=$("."+a);b.dialog({buttons:{Update:function(){$("form.loginCredentials",b).submit()},Close:function(){$(this).dialog("close")}}})}),$("#dashboard-sort input").click(function(){$(".tab-section").hide(),$(".tab-section."+$(this).val()).show()}),$(".show-hide").click(function(){var a=$(this).attr("id"),b=$("."+a+"-row"),c=$(this).children("span");$.each(b,function(a,b){$(b).is(":visible")?($(b).slideUp("fast"),$(c).text("Show Apps")):($(b).slideDown("fast"),$(c).text("Hide Apps"))})})},initializeCredentialsPage:function(a){$(".loginCredentials").submit(function(b){b.preventDefault();var c=$(this).serialize(),d=$(this).attr("id");c+="&account_key="+a+"&ad_network_name="+d.substr("form-".length);var e=$("."+d+"-message");$(e).removeClass("hidden"),$(e).html("Verifying login credentials..."),$.ajax({url:"https://checklogincredentials.mopub.com",data:c,crossDomain:!0,dataType:"jsonp",success:function(a){a?($("."+d+"-enable").html("Pending"),$(e).html("Check back in a couple minutes to see your ad network revenue report. You will receive an email when it is ready.")):$(e).html("Invalid login information.")}})}),$("#ad_network_selector").change(function(){var a=$(this).val();$(".network_form").each(function(){$(this).attr("id")==a+"-fields"?$(this).show():$(this).hide()})}).change()}};window.AdNetworkReportsController=e}),function(){function a(){function b(a,b,c,d){var e=/^(\d{1,2}):(\d{2})(\s?(AM|am|PM|pm|aM|pM|Pm|Am))?$/;c<10&&(c="0"+c);var f=a.match(e);if(f==null)return b+":"+c+" "+d;hour=f[1],minute=f[2],ampm=f[4],hour>=12&&hour<=23&&(hour-=12,hour==0?(hour=12,ampm===undefined&&(ampm="PM")):ampm="PM"),hour==0&&(ampm="AM",hour=12);if(minute<0||minute>59)minute=c;if(hour<0||hour>23)hour=b;return ampm===undefined?ampm=d:ampm=ampm.toUpperCase(),hour+":"+minute+" "+ampm}window.location.hash.substring(1)!==""&&$('select[name="campaign_type"]').val(window.location.hash.substring(1));var a=$("form#campaign_and_adgroup").validate({errorPlacement:function(a,b){b.closest("li > div").append(a)},submitHandler:function(b){$(b).ajaxSubmit({data:{ajax:!0},dataType:"json",success:function(b,c,d,e){b.success?(window.location=b.redirect,$("form#campaign_and_adgroup #submit").button({label:"Success...",disabled:!0})):(a.showErrors(b.errors),$("form#campaign_and_adgroup #submit").button({label:"Try Again",disabled:!1}))},error:function(a,b,c){$("form#campaign_and_adgroup #submit").button({label:"Try Again",disabled:!1})},beforeSubmit:function(a,b,c){$("form#campaign_and_adgroup #submit").button({label:"Submitting...",disabled:!0})}})}});$("form#campaign_and_adgroup #submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(a){a.preventDefault(),$("form#campaign_and_adgroup").submit()}),$.each(["type","priority","promo-priority","bid","keyword"],function(a,b){$("#campaignForm-"+b+"-helpLink").click(function(a){a.preventDefault(),$("#campaignForm-"+b+"-helpContent").dialog({buttons:{Close:function(){$(this).dialog("close")}}})})}),$("#campaignForm-customHtml-helpLink").click(function(a){a.preventDefault(),$("#campaignForm-customHtml-helpContent").dialog({buttons:{Close:function(){$(this).dialog("close")}},width:700})}),$('input[type="text"].date').datepicker({minDate:0}),$('input[name="start_datetime_0"]').change(function(a){a.preventDefault();var b=$(this).val();b!=""&&$('input[name="start_datetime_1"]').change()}),$('input[name="end_datetime_0"]').change(function(a){a.preventDefault();var b=$(this).val();b!=""&&$('input[name="end_datetime_1"]').change()}),$('input[name$="_datetime_1"]').change(function(a){a.preventDefault();var c=$(this).attr("name"),d=$(this).val();c=="start_datetime_1"?$('input[name="start_datetime_0"]').val()==""?d="":d=b(d,12,0,"AM"):c=="end_datetime_1"&&($('input[name="end_datetime_0"]').val()==""?d="":d=b(d,11,59,"PM")),$(this).val(d)}),$("#all-adunits").change(function(){$('input[name="site_keys"]').prop("checked",$(this).prop("checked"))}),$('input[name="device_targeting"]').change(function(){$(this).val()=="0"?$("#device_targeting").slideUp():$("#device_targeting").slideDown()}),$('input[name="device_targeting"]').val()=="0"&&$("#device_targeting").hide(),$('select[name="bid_strategy"]').change(function(){bid_strategy=$(this).val(),budget_type_options=$('select[name="budget_type"] option'),bid_strategy=="cpm"?(budget_type_options[0].innerHTML="impressions/day",budget_type_options[1].innerHTML="total impressions"):(budget_type_options[0].innerHTML="USD/day",budget_type_options[1].innerHTML="total USD")}).change();var c={admob_native:"admob_pub_id",adsense:"adsense_pub_id",brightroll:"brightroll_pub_id",ejam:"ejam_pub_id",inmobi:"inmobi_pub_id",jumptap:"jumptap_pub_id",millennial_native:"millennial_pub_id",mobfox:"mobfox_pub_id"};$('select[name="network_type"]').change(function(){var a=$(this).val(),b=c[a];$(".network_type_dependant").each(function(){$(this).toggle($(this).hasClass(a))}),$("ul#apps > li").each(function(){var a=$(this).children("div").children("span");a.children().hide();var c=a.children('input[name$="'+b+'"]'),d=c.val();$(this).children("div").children("label").attr("for",c.attr("id")),d?(c.siblings("span.pub_id").html(d).show(),c.siblings("a.pub_id").show()):c.show(),$(this).children("div").children("ul.adunits").children("li").children("span").each(function(){var a=$(this);a.children().hide();var c=a.children('input[name$="'+b+'"]');if(c.length){var d=c.val();d?c.siblings("span.pub_id").html(d).show():c.siblings("span.pub_id").html("Default").show(),c.siblings("a.pub_id").show()}})}),$("a.pub_id").click(function(){var a=$('select[name="network_type"]').val(),b=c[a];$(this).siblings('input[name$="'+b+'"]').show(),$(this).prev("span").hide(),$(this).hide()})}).change(),$("button.pub_id").click(function(){var a=$('select[name="network_type"]').val(),b=c[a];$(this).siblings("input").hide(),$(this).prev("span").hide(),$(this).hide(),$(this).siblings('input[name$="'+b+'"]').show()}),$('select[name="campaign_type"]').change(function(){campaign_type=$(this).val(),$(".campaign_type_dependant").each(function(){$(this).toggle($(this).hasClass(campaign_type))}),campaign_type=="network"?($('select[name="network_type"]').change(),$('label[for="id_bid_strategy"]').html("Network Rate"),$("#bid-promo-helpLink").attr("id","bid-network-helpLink")):($('label[for="id_bid_strategy"]').html("Rate"),campaign_type=="promo"&&$("#bid-network-helpLink").attr("id","bid-promo-helpLink"))}).change(),$('select[name="budget_type"]').change(function(){budget_type=$(this).val(),$(".budget_type_dependent").each(function(){$(this).toggle($(this).hasClass(budget_type))})}).change(),$("#toggle_advanced").button("option",{icons:{primary:"ui-icon-triangle-1-s"}}).click(function(a){a.preventDefault();var b=$(".ui-button-text",this);$("fieldset#advanced").is(":hidden")?($("fieldset#advanced").slideDown("fast"),$(this).button("option",{icons:{primary:"ui-icon-triangle-1-n"}}),$(".ui-button-text",this).text("Hide Advanced Details")):($("fieldset#advanced").slideUp("fast"),$(this).button("option",{icons:{primary:"ui-icon-triangle-1-s"}}),$(".ui-button-text",this).text("Show Advanced Details"))});var d="http://api.geonames.org/searchJSON?username=MoPub&",e={type:"country",data:[]},f={type:"city",data:[]};window.priors=window.priors||[];for(var g in countries){var h=countries[g];$.inArray(h.code,window.priors)!=-1&&e.data.push(h);if(e.length==priors.length)break}window.city_priors=window.city_priors||[];for(var i in city_priors)if(city_priors.hasOwnProperty(i)){var j=city_priors[i].split(":"),k=j[0].split(","),l=j[1],m=j[2],n=j[3];f.data.push({lat:k[0],lng:k[1],countryCode:n,adminCode1:l,name:m})}$("#geo_pred_ta").tokenInput(null,{data:countries,hintText:"Type in a country name",formatResult:function(a){return a.name},formatMatch:function(a,b,c){return[a.name,a.code]},prePopulate:e}),$("#city_ta").tokenInput(d,{country:"US",doImmediate:!1,hintText:"Type in a city name",queryParam:"name_startsWith",featureClass:"P",prePopulate:f,contentType:"json",type:"city",minChars:3,method:"get"}),$('#campaign_and_adgroup input[name="region_targeting"]').click(function(a){var b=$(this).val();$(".locationDependent","#campaign_and_adgroup").hide(),$("."+b+".locationDependent","#campaign_and_adgroup").show(),$(this).val()=="all"&&$("li.token-input-city span.token-input-delete-token").each(function(){$(this).click()})}).filter(":checked").click()}},function(a){function c(){function c(a,b,c,d){var e=/^(\d{1,2}):(\d{2})(\s?(AM|am|PM|pm|aM|pM|Pm|Am))?$/;c<10&&(c="0"+c);var f=a.match(e);if(f==null)return b+":"+c+" "+d;hour=f[1],minute=f[2],ampm=f[4],hour>=12&&hour<=23&&(hour-=12,hour==0?(hour=12,ampm===undefined&&(ampm="PM")):ampm="PM"),hour==0&&(ampm="AM",hour=12);if(minute<0||minute>59)minute=c;if(hour<0||hour>23)hour=b;return ampm===undefined?ampm=d:ampm=ampm.toUpperCase(),hour+":"+minute+" "+ampm}window.location.hash.substring(1)!==""&&a('select[name="campaign_type"]').val(window.location.hash.substring(1));var b=a("form#campaign_and_adgroup").validate({errorPlacement:function(a,b){b.closest("li > div").append(a)},submitHandler:function(c){a(c).ajaxSubmit({data:{ajax:!0},dataType:"json",success:function(c,d,e,f){c.success?(window.location=c.redirect,a("form#campaign_and_adgroup #submit").button({label:"Success...",disabled:!0})):(b.showErrors(c.errors),a("form#campaign_and_adgroup #submit").button({label:"Try Again",disabled:!1}))},error:function(b,c,d){a("form#campaign_and_adgroup #submit").button({label:"Try Again",disabled:!1})},beforeSubmit:function(b,c,d){a("form#campaign_and_adgroup #submit").button({label:"Submitting...",disabled:!0})}})}});a("form#campaign_and_adgroup #submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("form#campaign_and_adgroup").submit()}),a.each(["type","priority","promo-priority","bid","keyword"],function(b,c){a("#campaignForm-"+c+"-helpLink").click(function(b){b.preventDefault(),a("#campaignForm-"+c+"-helpContent").dialog({buttons:{Close:function(){a(this).dialog("close")}}})})}),a("#campaignForm-customHtml-helpLink").click(function(b){b.preventDefault(),a("#campaignForm-customHtml-helpContent").dialog({buttons:{Close:function(){a(this).dialog("close")}},width:700})}),a('input[type="text"].date').datepicker({minDate:0}),a('input[name="start_datetime_0"]').change(function(b){b.preventDefault();var c=a(this).val();c!=""&&a('input[name="start_datetime_1"]').change()}),a('input[name="end_datetime_0"]').change(function(b){b.preventDefault();var c=a(this).val();c!=""&&a('input[name="end_datetime_1"]').change()}),a('input[name$="_datetime_1"]').change(function(b){b.preventDefault();var d=a(this).attr("name"),e=a(this).val();d=="start_datetime_1"?a('input[name="start_datetime_0"]').val()==""?e="":e=c(e,12,0,"AM"):d=="end_datetime_1"&&(a('input[name="end_datetime_0"]').val()==""?e="":e=c(e,11,59,"PM")),a(this).val(e)}),a("#all-adunits").change(function(){a('input[name="site_keys"]').prop("checked",a(this).prop("checked"))}),a('input[name="device_targeting"]').change(function(){a(this).val()=="0"?a("#device_targeting").slideUp():a("#device_targeting").slideDown()}),a('input[name="device_targeting"]').val()=="0"&&a("#device_targeting").hide(),a('select[name="bid_strategy"]').change(function(){bid_strategy=a(this).val(),budget_type_options=a('select[name="budget_type"] option'),bid_strategy=="cpm"?(budget_type_options[0].innerHTML="impressions/day",budget_type_options[1].innerHTML="total impressions"):(budget_type_options[0].innerHTML="USD/day",budget_type_options[1].innerHTML="total USD")}).change();var d={admob_native:"admob_pub_id",adsense:"adsense_pub_id",brightroll:"brightroll_pub_id",ejam:"ejam_pub_id",inmobi:"inmobi_pub_id",jumptap:"jumptap_pub_id",millennial_native:"millennial_pub_id",mobfox:"mobfox_pub_id"};a('select[name="network_type"]').change(function(){var b=a(this).val(),c=d[b];a(".network_type_dependant").each(function(){a(this).toggle(a(this).hasClass(b))}),a("ul#apps > li").each(function(){var b=a(this).children("div").children("span");b.children().hide();var d=b.children('input[name$="'+c+'"]'),e=d.val();a(this).children("div").children("label").attr("for",d.attr("id")),e?(d.siblings("span.pub_id").html(e).show(),d.siblings("a.pub_id").show()):d.show(),a(this).children("div").children("ul.adunits").children("li").children("span").each(function(){var b=a(this);b.children().hide();var d=b.children('input[name$="'+c+'"]');if(d.length){var e=d.val();e?d.siblings("span.pub_id").html(e).show():d.siblings("span.pub_id").html("Default").show(),d.siblings("a.pub_id").show()}})}),a("a.pub_id").click(function(){var b=a('select[name="network_type"]').val(),c=d[b];a(this).siblings('input[name$="'+c+'"]').show(),a(this).prev("span").hide(),a(this).hide()})}).change(),a("button.pub_id").click(function(){var b=a('select[name="network_type"]').val(),c=d[b];a(this).siblings("input").hide(),a(this).prev("span").hide(),a(this).hide(),a(this).siblings('input[name$="'+c+'"]').show()}),a('select[name="campaign_type"]').change(function(){campaign_type=a(this).val(),a(".campaign_type_dependant").each(function(){a(this).toggle(a(this).hasClass(campaign_type))}),campaign_type=="network"?(a('select[name="network_type"]').change(),a('label[for="id_bid_strategy"]').html("Network Rate"),a("#bid-promo-helpLink").attr("id","bid-network-helpLink")):(a('label[for="id_bid_strategy"]').html("Rate"),campaign_type=="promo"&&a("#bid-network-helpLink").attr("id","bid-promo-helpLink"))}).change(),a('select[name="budget_type"]').change(function(){budget_type=a(this).val(),a(".budget_type_dependent").each(function(){a(this).toggle(a(this).hasClass(budget_type))})}).change(),a("#toggle_advanced").button("option",{icons:{primary:"ui-icon-triangle-1-s"}}).click(function(b){b.preventDefault();var c=a(".ui-button-text",this);a("fieldset#advanced").is(":hidden")?(a("fieldset#advanced").slideDown("fast"),a(this).button("option",{icons:{primary:"ui-icon-triangle-1-n"}}),a(".ui-button-text",this).text("Hide Advanced Details")):(a("fieldset#advanced").slideUp("fast"),a(this).button("option",{icons:{primary:"ui-icon-triangle-1-s"}}),a(".ui-button-text",this).text("Show Advanced Details"))});var e="http://api.geonames.org/searchJSON?username=MoPub&",f={type:"country",data:[]},g={type:"city",data:[]};window.priors=window.priors||[];for(var h in countries){var i=countries[h];a.inArray(i.code,window.priors)!=-1&&f.data.push(i);if(f.length==priors.length)break}window.city_priors=window.city_priors||[];for(var j in city_priors)if(city_priors.hasOwnProperty(j)){var k=city_priors[j].split(":"),l=k[0].split(","),m=k[1],n=k[2],o=k[3];g.data.push({lat:l[0],lng:l[1],countryCode:o,adminCode1:m,name:n})}a("#geo_pred_ta").tokenInput(null,{data:countries,hintText:"Type in a country name",formatResult:function(a){return a.name},formatMatch:function(a,b,c){return[a.name,a.code]},prePopulate:f}),a("#city_ta").tokenInput(e,{country:"US",doImmediate:!1,hintText:"Type in a city name",queryParam:"name_startsWith",featureClass:"P",prePopulate:g,contentType:"json",type:"city",minChars:3,method:"get"}),a('#campaign_and_adgroup input[name="region_targeting"]').click(function(b){var c=a(this).val();a(".locationDependent","#campaign_and_adgroup").hide(),a("."+c+".locationDependent","#campaign_and_adgroup").show(),a(this).val()=="all"&&a("li.token-input-city span.token-input-delete-token").each(function(){a(this).click()})}).filter(":checked").click()}function d(){a("#dashboard-dateOptions input").click(function(){var b=a(this).val();if(b=="custom")a("#dashboard-dateOptions-custom-modal").dialog({width:570,buttons:[{text:"Set dates",css:{fontWeight:"600"},click:function(){var b=a("#dashboard-dateOptions-custom-from").datepicker("getDate"),c=a("#dashboard-dateOptions-custom-to").datepicker("getDate"),d=Math.ceil((c.getTime()-b.getTime())/864e5)+1,e=b.getDate(),f=b.getMonth()+1,g=b.getFullYear();a(this).dialog("close");var h=document.location.href.replace(/\?.*/,"");document.location.href=h+"?r="+d+"&s="+g+"-"+f+"-"+e}},{text:"Cancel",click:function(){a(this).dialog("close")}}]});else{var c=document.location.href.replace(/\?.*/,"");document.location.href=c+"?r="+b}}),a("#stats-breakdown-dateOptions input").click(function(){a(".stats-breakdown-value").hide(),a(".stats-breakdown-value."+a(this).val()).show()}),a("#dashboard-dateOptions-custom-from").datepicker({defaultDate:"-15d",maxDate:"0d",onSelect:function(b){var c=a("#dashboard-dateOptions-custom-to"),d=a(this).data("datepicker"),e=a.datepicker.parseDate(d.settings.dateFormat||a.datepicker._defaults.dateFormat,b,d.settings);c.datepicker("option","minDate",e)}}),a("#dashboard-dateOptions-custom-to").datepicker({defaultDate:"-1d",maxDate:"0d",onSelect:function(b){var c=a("#dashboard-dateOptions-custom-from"),d=a(this).data("datepicker"),e=a.datepicker.parseDate(d.settings.dateFormat||a.datepicker._defaults.dateFormat,b,d.settings);c.datepicker("option","maxDate",e)}})}function e(){a(".appData-details").each(function(){function e(){var b=a(".ui-button-text",d);return b.length===0&&(b=d),b}function f(){c.removeClass("hide"),c.addClass("show"),d.button("option",{icons:{primary:"ui-icon-triangle-1-n"}}),e().text("Hide details")}function g(){c.removeClass("show"),c.addClass("hide"),d.button("option",{icons:{primary:"ui-icon-triangle-1-s"}}),e().text("Show details")}var b=a(this),c=a(".appData-details-inner",b),d=a(".appData-details-toggleButton",b);c.hasClass("show")?f():(c.hide(),g()),d.click(function(a){a.preventDefault(),c.hasClass("show")?(c.slideUp("fast"),g()):(c.slideDown("fast"),f())})})}function f(b){a("#creativeManagementForm-action").val(b);var c=a("#creativeManagementForm");c.find('input[name="key"]').remove(),a("#advertiser-creativeData").find('input[name="creativeManagementForm-key"]:checked').each(function(b){a(this).val(),a("<input></input>").attr("name","key").attr("type","hidden").val(a(this).val()).appendTo(c)}),c.submit()}function g(){a('#creativeCreateForm input[name="ad_type"]').click(function(b){a(".adTypeDependent","#creativeCreateForm").hide(),a(".adTypeDependent."+a(this).val(),"#creativeCreateForm").show()}).filter(":checked").click(),a(".format-options").change(function(b){b.preventDefault(),a(this).val()=="custom"?a(this).parents("form").find(".customc_only").show():a(this).parents("form").find(".customc_only").hide(),a(this).val().search(/full/i)!=-1?a(this).parents().find(".full_only").show():a(this).parents().find(".full_only").hide()}).change(),a("#creativeCreateForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#creativeCreateForm-loading").show(),a("#creativeCreateForm").submit()}),a("#creativeCreateForm-cancel").button().click(function(b){b.preventDefault(),a("#advertiser-creativeAddForm").slideUp("fast",function(){a("#advertiser-adgroups-addCreativeButton").show()})}),a('.creativeEditForm input[name="ad_type"]').click(function(b){var c=a(this).parents("form");a(".adTypeDependent",c).hide(),a(".adTypeDependent."+a(this).val(),c).show()}).filter(":checked").click(),a(".creativeFormAdvancedToggleButton").button("option",{icons:{primary:"ui-icon-triangle-1-s"}}).click(function(b){b.preventDefault();var c=a(this).parents("form").find(".creativeForm-advanced-options");c.is(":hidden")?(c.slideDown("fast").removeClass("hidden"),a(this).button("option",{icons:{primary:"ui-icon-triangle-1-n"}}),a(".ui-button-text",this).text("Less Options")):(c.slideUp("fast").addClass("hidden"),a(this).button("option",{icons:{primary:"ui-icon-triangle-1-s"}}),a(".ui-button-text",this).text("More Options"))}),a(".creativeAddForm-url-helpLink").click(function(b){b.preventDefault(),a("#creativeAddForm-url-helpContent").dialog({buttons:{Close:function(){a(this).dialog("close")}}})}),a('#creativeAddForm input[name="creative_type"]').click(function(b){a("#creativeCreate-text_icon").hide(),a("#creativeCreate-image").hide(),a("#creativeCreate-html").hide(),a("#creativeCreate-"+a(this).val()).show()}).filter(":checked").click(),a("#creativeAddForm-cancel").button().click(function(b){b.preventDefault(),a("#advertiser-creativeAddForm").slideUp("fast",function(){a("#advertiser-adgroups-addCreativeButton").show()})}),a("#creativeCreateForm").ajaxForm({data:{ajax:!0},dataType:"json",success:function(b){a("#creativeCreateForm-loading").hide(),b.success?(a("#creativeCreateForm-success").show(),window.location.reload()):(a.each(b.errors,function(b,c){a(".form-error-text","#creativeCreateForm").remove();var d=c[0],e=a("<div>").append(c[1]).addClass("form-error-text");a("input[name="+d+"]","#creativeCreateForm").addClass("error").parent().append(e)}),g(),window.location.hash="",window.location.hash="advertiser-creativeAddForm",a("#campaignAdgroupForm-submit").button({label:"Continue",disabled:!1}))},error:function(a,b,c){}}),a(".creativeEditForm").each(function(b){var c=a(this),d={data:{ajax:!0},dataType:"json",success:function(b,c,d,e){e.find(".creativeEditForm-loading").hide(),b.success?(e.find(".creativeCreateForm-success").show(),e.parent(),e.find(".creativeCreateForm-success").hide(),window.location.reload()):(a(".form-error-text",e).remove(),a.each(b.errors,function(b,c){var d=c[0],f=a("<div>").append(c[1]).addClass("form-error-text");a("input[name="+d+"]",e).addClass("error").parent().append(f)}),a('.creativeEditForm input[name="ad_type"]').click(function(b){a(this).parents("form").find(".adTypeDependent").hide().end().find("."+a(this).val()).show().end()}).filter(":checked").click(),window.location.hash="",window.location.hash=e.prev("a").attr("name"))}};a(this).ajaxForm(d)}),a(".creativeEditForm-submit").button().click(function(b){b.preventDefault(),a(this).parents("form").find(".creativeEditForm-loading").show(),a(this).parents("form").submit()}),a(".creativeEditForm-cancel").button().click(function(b){b.preventDefault(),a(this).parents(".advertiser-creativeEditForm").dialog("close")})}function h(){function b(){var b=a("#dashboard-stats .stats-breakdown .active");return b.attr("id")=="stats-breakdown-ctr"?"line":"area"}a(".stats-breakdown tr").click(function(c){var d=a(this);d.hasClass("active")||(d.siblings().removeClass("active"),d.addClass("active"),a("#dashboard-stats-chart").fadeOut(100,function(){mopub.Chart.setupDashboardStatsChart(b()),a(this).show()}))}),mopub.Chart.setupDashboardStatsChart(b())}function i(a){var c=new AdUnitCollection;c.adgroup_key=a,c.url=function(){return"/api/adgroup/"+this.adgroup_key+"/adunits/"},c.bind("reset",function(c){c.each(function(c){var d=c.get("app_key"),e=new App({id:d});e.url=function(){return"/api/adgroup/"+a+"/apps/"+d},e.bind("change",function(a){var b=new AppView({model:e,el:"dashboard-app"});b.renderInline()}),e.fetch({error:function(){e.fetch({error:b})}});var f=new AdUnitView({model:c,el:"dashboard-app"});f.renderInline()})}),c.fetch({error:function(){c.fetch({error:b})}})}var b=function(){var b=a("Please <a href='#'>refresh the page</a> and try again.").click(function(a){a.preventDefault(),window.location.reload()});Toast.error(b,"Error fetching app data.")},j={initializeDirectSold:function(c){var d=c.gtee_adgroups_data,e=c.promo_adgroups_data,f=c.backfill_promo_adgroups_data,g=c.ajax_query_string,h=new AdGroups(d),i=new AdGroupsView({collection:h,el:"#gtee-adgroups",tables:{"High Priority":function(a){return a.get("level")=="high"},"Normal Priority":function(a){return a.get("level")=="normal"},"Low Priority":function(a){return a.get("level")=="low"}},title:"Guaranteed Campaigns",type:"gtee"});i.render(),h.each(function(a){a.fetch({data:g,error:function(){a.fetch({error:b})}})});var j=new AdGroups(e),k=new AdGroupsView({collection:j,el:"#promo-adgroups",title:"Promotional Campaigns",type:"promo"});k.render(),j.each(function(a){a.fetch({data:g,error:function(){a.fetch({error:b})}})});var l=new AdGroups(f),m=new AdGroupsView({collection:l,el:"#backfill-promo-adgroups",title:"Backfill Promotional Campaigns",type:"backfill_promo"});m.render(),l.each(function(a){a.fetch({data:g,error:function(){a.fetch({error:b})}})}),a("#campaigns-appFilterOptions").selectmenu({style:"popup",maxHeight:300,width:184}),a("#campaigns-filterOptions, #campaigns-appFilterOptions").change(function(){i.render(),k.render(),m.render()}),a("#add_campaign_button").button({icons:{primary:"ui-icon-circle-plus"}});var n=["pause","resume","activate","archive","delete"];a.each(n,function(b,c){a("#campaignForm-"+c).click(function(b){b.preventDefault(),a("#campaignForm").find("#action").attr("value",c).end().submit()})}),a("#campaigns-filterOptions").buttonset({disabled:!1})},initializeAdGroupDetail:function(b){var c=b.kind,j=b.adgroup_key;g(),h(),e(),d(),i(j),a("#campaign-status-options").change(function(b){var c=a(this).val();a("#fake-campaignForm").find("#action").attr("value",c).end().submit()}),a("#campaign-status-options-menu").find("li").first().hide(),a.each(["pause","resume","delete"],function(b,c){a("#creativeManagementForm-"+c).click(function(a){a.preventDefault(),f(c)})}),a(".creativeManagementForm-key").change(function(b){a('#creativeManagementForm input[name="key"]').remove(),a(".creativeManagementForm-key:checked").each(function(b){a(this).val()});var c=a("#creativeManagementForm")}),a(".advertiser-inLineCreativePreview").button({icons:{primary:"ui-icon-search"}}).click(function(b){b.preventDefault();var c=a(this).attr("id"),d=a("#"+c+"-preview-src").val(),e=parseInt(a("#"+c+"-preview iframe").attr("width")),f=parseInt(a("#"+c+"-preview iframe").attr("height"));a("#"+c+"-preview iframe").attr("src",d),a("#"+c+"-preview").dialog({buttons:[{text:"Close",click:function(){a(this).dialog("close")}}],width:e+100,height:f+130})}),a(".advertiser-inLineCreativeToggle").button({icons:{primary:"ui-icon-wrench"}}).click(function(b){b.preventDefault();var c=a(this).attr("id"),d=a("#"+c+"-edit");d.dialog({width:1e3})}),a("#add_campaign_button").button({icons:{primary:"ui-icon-circle-plus"}}),a("#advertiser-adgroups-addCreativeButton").button({icons:{primary:"ui-icon-circle-plus"}}).click(function(b){b.preventDefault();var c=a("#advertiser-creativeAddForm");c.is(":hidden")?a("#advertiser-creativeAddForm").slideDown("fast"):a("#advertiser-creativeAddForm").slideUp("fast")}),a("#advertisers-addCampaign").button({icons:{primary:"ui-icon-circle-plus"}}),a("#advertisers-adgroups-editAdGroupButton").button({icons:{primary:"ui-icon-wrench"}});var k=["pause","resume","activate","archive","delete"];a.each(k,function(b,c){a("#campaignForm-"+c).click(function(b){b.preventDefault(),a("#campaignForm").find("#action").attr("value",c).end().submit()})}),a("#campaign-status-options-menu").find("li").first().hide(),a("#advertiser-adgroups-exportSelect").change(function(b){b.preventDefault();var c=a(this).val();c!="exp"&&a("#campaignExportForm").find("#campaignExportType").val(c).end().submit(),a(this).selectmenu("index",0)}),a("#advertiser-adgroups-exportSelect-menu").find("li").first().hide(),a("#device_targeting_False").click(function(){a("#target-by-device").slideUp()}),a("#device_targeting_True").click(function(){a("#target-by-device").slideDown()}),a("#device_targeting_True:checked").length===0&&a("#target-by-device").hide(),a(".creativeData").length===0&&c!="network"&&(a("#chartWrapper").hide(),a("#advertiser-creativeData").hide(),a("#advertiser-adgroups-addCreativeButton").click())},initializeCreateCampaign:function(a){c()}};window.CampaignsController=j}(this.jQuery),function(a){function b(){a(".appData-details").each(function(){function e(){var b=a(".ui-button-text",d);return b.length===0&&(b=d),b}function f(){c.removeClass("hide"),c.addClass("show"),d.button("option",{icons:{primary:"ui-icon-triangle-1-n"}}),e().text("Hide details")}function g(){c.removeClass("show"),c.addClass("hide"),d.button("option",{icons:{primary:"ui-icon-triangle-1-s"}}),e().text("Show details"
)}var b=a(this),c=a(".appData-details-inner",b),d=a(".appData-details-toggleButton",b);c.hasClass("show")?f():(c.hide(),g()),d.click(function(a){a.preventDefault(),c.hasClass("show")?(c.slideUp("fast"),g()):(c.slideDown("fast"),f())})})}function c(b){a("#creativeManagementForm-action").val(b);var c=a("#creativeManagementForm");c.find('input[name="key"]').remove(),a("#advertiser-creativeData").find('input[name="creativeManagementForm-key"]:checked').each(function(b){a(this).val(),a("<input></input>").attr("name","key").attr("type","hidden").val(a(this).val()).appendTo(c)}),c.submit()}function d(){a('#creativeCreateForm input[name="ad_type"]').click(function(b){a(".adTypeDependent","#creativeCreateForm").hide(),a(".adTypeDependent."+a(this).val(),"#creativeCreateForm").show()}).filter(":checked").click(),a(".format-options").change(function(b){b.preventDefault(),a(this).val()=="custom"?a(this).parents("form").find(".customc_only").show():a(this).parents("form").find(".customc_only").hide(),a(this).val().search(/full/i)!=-1?a(this).parents().find(".full_only").show():a(this).parents().find(".full_only").hide()}).change(),a("#creativeCreateForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#creativeCreateForm-loading").show(),a("#creativeCreateForm").submit()}),a("#creativeCreateForm-cancel").button().click(function(b){b.preventDefault(),a("#advertiser-creativeAddForm").slideUp("fast",function(){a("#advertiser-adgroups-addCreativeButton").show()})}),a('.creativeEditForm input[name="ad_type"]').click(function(b){var c=a(this).parents("form");a(".adTypeDependent",c).hide(),a(".adTypeDependent."+a(this).val(),c).show()}).filter(":checked").click(),a(".creativeFormAdvancedToggleButton").button("option",{icons:{primary:"ui-icon-triangle-1-s"}}).click(function(b){b.preventDefault();var c=a(this).parents("form").find(".creativeForm-advanced-options");c.is(":hidden")?(c.slideDown("fast").removeClass("hidden"),a(this).button("option",{icons:{primary:"ui-icon-triangle-1-n"}}),a(".ui-button-text",this).text("Less Options")):(c.slideUp("fast").addClass("hidden"),a(this).button("option",{icons:{primary:"ui-icon-triangle-1-s"}}),a(".ui-button-text",this).text("More Options"))}),a(".creativeAddForm-url-helpLink").click(function(b){b.preventDefault(),a("#creativeAddForm-url-helpContent").dialog({buttons:{Close:function(){a(this).dialog("close")}}})}),a('#creativeAddForm input[name="creative_type"]').click(function(b){a("#creativeCreate-text_icon").hide(),a("#creativeCreate-image").hide(),a("#creativeCreate-html").hide(),a("#creativeCreate-"+a(this).val()).show()}).filter(":checked").click(),a("#creativeAddForm-cancel").button().click(function(b){b.preventDefault(),a("#advertiser-creativeAddForm").slideUp("fast",function(){a("#advertiser-adgroups-addCreativeButton").show()})}),a("#creativeCreateForm").ajaxForm({data:{ajax:!0},dataType:"json",success:function(b){a("#creativeCreateForm-loading").hide(),b.success?(a("#creativeCreateForm-success").show(),window.location.reload()):(a.each(b.errors,function(b,c){a(".form-error-text","#creativeCreateForm").remove();var d=c[0],e=a("<div>").append(c[1]).addClass("form-error-text");a("input[name="+d+"]","#creativeCreateForm").addClass("error").parent().append(e)}),d(),window.location.hash="",window.location.hash="advertiser-creativeAddForm",a("#campaignAdgroupForm-submit").button({label:"Continue",disabled:!1}))},error:function(a,b,c){}}),a(".creativeEditForm").each(function(b){var c=a(this),d={data:{ajax:!0},dataType:"json",success:function(b,c,d,e){e.find(".creativeEditForm-loading").hide(),b.success?(e.find(".creativeCreateForm-success").show(),e.parent(),e.find(".creativeCreateForm-success").hide(),window.location.reload()):(a(".form-error-text",e).remove(),a.each(b.errors,function(b,c){var d=c[0],f=a("<div>").append(c[1]).addClass("form-error-text");a("input[name="+d+"]",e).addClass("error").parent().append(f)}),a('.creativeEditForm input[name="ad_type"]').click(function(b){a(this).parents("form").find(".adTypeDependent").hide().end().find("."+a(this).val()).show().end()}).filter(":checked").click(),window.location.hash="",window.location.hash=e.prev("a").attr("name"))}};a(this).ajaxForm(d)}),a(".creativeEditForm-submit").button().click(function(b){b.preventDefault(),a(this).parents("form").find(".creativeEditForm-loading").show(),a(this).parents("form").submit()}),a(".creativeEditForm-cancel").button().click(function(b){b.preventDefault(),a(this).parents(".advertiser-creativeEditForm").dialog("close")})}function e(){function b(){var b=a("#dashboard-stats .stats-breakdown .active");return b.attr("id")=="stats-breakdown-ctr"?"line":"area"}a(".stats-breakdown tr").click(function(c){var d=a(this);d.hasClass("active")||(d.siblings().removeClass("active"),d.addClass("active"),a("#dashboard-stats-chart").fadeOut(100,function(){mopub.Chart.setupDashboardStatsChart(b()),a(this).show()}))}),mopub.Chart.setupDashboardStatsChart(b())}function f(a){var b=new AdUnitCollection;b.adgroup_key=a,b.url=function(){return"/api/adgroup/"+this.adgroup_key+"/adunits/"},b.bind("reset",function(b){b.each(function(b){var c=b.get("app_key");console.log(b),console.log(c);var d=new App({id:c});d.url=function(){return"/api/adgroup/"+a+"/apps/"+c},d.bind("change",function(a){var b=new AppView({model:d,el:"dashboard-app"});b.renderInline()}),d.fetch();var e=new AdUnitView({model:b,el:"dashboard-app"});e.renderInline()})}),b.fetch()}var g={initializeDirectSold:function(b){var c=b.gtee_adgroups_data,d=b.promo_adgroups_data,e=b.backfill_promo_adgroups_data,f=b.ajax_query_string,g=new AdGroups(c),h=new AdGroupsView({collection:g,el:"#gtee-adgroups",tables:{"High Priority":function(a){return a.get("level")=="high"},"Normal Priority":function(a){return a.get("level")=="normal"},"Low Priority":function(a){return a.get("level")=="low"}},title:"Guaranteed Campaigns",type:"gtee"});h.render(),g.each(function(a){a.fetch({data:f})});var i=new AdGroups(d),j=new AdGroupsView({collection:i,el:"#promo-adgroups",title:"Promotional Campaigns",type:"promo"});j.render(),i.each(function(a){a.fetch({data:f})});var k=new AdGroups(e),l=new AdGroupsView({collection:k,el:"#backfill-promo-adgroups",title:"Backfill Promotional Campaigns",type:"backfill_promo"});l.render(),k.each(function(a){a.fetch({data:f})}),a("#campaigns-appFilterOptions").selectmenu({style:"popup",maxHeight:300,width:184}),a("#campaigns-filterOptions, #campaigns-appFilterOptions").change(function(){h.render(),j.render(),l.render()}),a("#add_campaign_button").button({icons:{primary:"ui-icon-circle-plus"}}),a.each(["pause","resume","activate","archive","delete"],function(b,c){a("#campaignForm-"+c).click(function(b){b.preventDefault(),a("#campaignForm").find("#action").attr("value",c).end().submit()})})},initializeAdGroupDetail:function(g){var h=g.kind,i=g.adgroup_key;d(),e(),b(),f(i),a("#campaign-status-options").change(function(b){var c=a(this).val();a("#fake-campaignForm").find("#action").attr("value",c).end().submit()}),a("#campaign-status-options-menu").find("li").first().hide(),a.each(["pause","resume","delete"],function(b,d){a("#creativeManagementForm-"+d).click(function(a){a.preventDefault(),c(d)})}),a(".creativeManagementForm-key").change(function(b){a('#creativeManagementForm input[name="key"]').remove(),a(".creativeManagementForm-key:checked").each(function(b){a(this).val()});var c=a("#creativeManagementForm")}),a(".advertiser-inLineCreativePreview").button({icons:{primary:"ui-icon-search"}}).click(function(b){b.preventDefault();var c=a(this).attr("id"),d=a("#"+c+"-preview-src").val(),e=parseInt(a("#"+c+"-preview iframe").attr("width")),f=parseInt(a("#"+c+"-preview iframe").attr("height"));a("#"+c+"-preview iframe").attr("src",d),a("#"+c+"-preview").dialog({buttons:[{text:"Close",click:function(){a(this).dialog("close")}}],width:e+100,height:f+130})}),a(".advertiser-inLineCreativeToggle").button({icons:{primary:"ui-icon-wrench"}}).click(function(b){b.preventDefault();var c=a(this).attr("id"),d=a("#"+c+"-edit");d.dialog({width:1e3})}),a("#add_campaign_button").button({icons:{primary:"ui-icon-circle-plus"}}),a("#advertiser-adgroups-addCreativeButton").button({icons:{primary:"ui-icon-circle-plus"}}).click(function(b){b.preventDefault();var c=a("#advertiser-creativeAddForm");c.is(":hidden")?a("#advertiser-creativeAddForm").slideDown("fast"):a("#advertiser-creativeAddForm").slideUp("fast")}),a("#advertisers-addCampaign").button({icons:{primary:"ui-icon-circle-plus"}}),a("#advertisers-adgroups-editAdGroupButton").button({icons:{primary:"ui-icon-wrench"}}),a.each(["pause","resume","activate","archive","delete"],function(b,c){a("#campaignForm-"+c).click(function(b){b.preventDefault(),a("#campaignForm").find("#action").attr("value",c).end().submit()})}),a("#campaign-status-options-menu").find("li").first().hide(),a("#advertiser-adgroups-exportSelect").change(function(b){b.preventDefault();var c=a(this).val();c!="exp"&&a("#campaignExportForm").find("#campaignExportType").val(c).end().submit(),a(this).selectmenu("index",0)}),a("#advertiser-adgroups-exportSelect-menu").find("li").first().hide(),a("#device_targeting_False").click(function(){a("#target-by-device").slideUp()}),a("#device_targeting_True").click(function(){a("#target-by-device").slideDown()}),a("#device_targeting_True:checked").length===0&&a("#target-by-device").hide(),a(".creativeData").length===0&&h!="network"&&(a("#chartWrapper").hide(),a("#advertiser-creativeData").hide(),a("#advertiser-adgroups-addCreativeButton").click())}};window.CampaignsController=g}(this.jQuery);var mopub=mopub||{};(function(a,b){function d(d){b.each(d,function(b){var d=new App({id:b,stats_endpoint:"mpx"});d.bind("change",function(a){var b=new AppView({model:a,el:"marketplace-apps"});b.render()}),d.fetch({success:function(){a("table").trigger("update")},error:function(){d.fetch({error:c})}})})}function e(a){b.each(a,function(a){var b=new App({id:a,stats_endpoint:"mpx"});b.bind("change",function(a){var b=new AppView({model:a,el:"marketplace-apps"});b.renderInline()}),b.fetch({error:function(){b.fetch({error:c})}})})}function f(d,e){var f=new AdUnitCollection;f.app_id=d,f.stats_endpoint="mpx",f.bind("reset",function(a){b.each(a.models,function(a){a.app_id=d;var b=new AdUnitView({model:a,el:"#marketplace_stats"});b.renderInline()})}),f.fetch({success:function(){a("table").trigger("update"),a("#"+d+"-img").hide(),e||a(".targeting-box").attr("disabled",!0)},error:function(){f.fetch({error:c})}})}function g(d){var e=new AdUnitCollection;e.app_id=d,e.bind("reset",function(c){var e=b.max(c.models,function(a){return a.get("price_floor")}).get("price_floor"),f=b.min(c.models,function(a){return a.get("price_floor")}).get("price_floor"),g=a("<a href='#"+d+"'"+" class='edit_price_floor' "+"id='"+d+"'> "+"Edit Price Floor</a>");e==f?a(".app-row#app-"+d+" .price_floor").html("All $"+e):a(".app-row#app-"+d+" .price_floor").html("$"+f+" - "+"$"+e),a(".app-row#app-"+d+" .view_targeting").addClass("hidden"),b.each(c.models,function(a){var b=new AdUnitView({model:a,el:"marketplace-apps"});b.render()})}),e.fetch({error:function(){e.fetch({error:c})}})}function h(c){c=a(c);var d="",e=c.attr("class").split(" ");return b.each(e,function(a){a.search("for-app-")>=0&&(d=a.replace("for-app-",""))}),d}function i(){var b=a.post("/campaigns/marketplace/activation/",{activate:"true"});return b.error(function(){Toast.error("There was an error saving your Marketplace settings. Our support team has been notified. Please refresh your page and try again.")}),b.done(function(){}),a(".targeting-box").removeAttr("disabled"),a("#blindness").removeAttr("disabled"),!0}function j(){var b=a.post("/campaigns/marketplace/activation/",{activate:"false"});return a(".targeting-box").attr("disabled",!0),a("#blindness").attr("disabled",!0),!0}function k(c,d,e,f){var g;window.location.origin?g=window.location.origin:(g=window.location.protocol+"//"+window.location.host+"/",window.location.origin=g);var h=g+"/campaigns/marketplace/creatives/",i=a("#report-table").dataTable({bProcessing:!0,bJQueryUI:!0,sPaginationType:"full_numbers",oLanguage:{sEmptyTable:"No creatives have been displayed for this time range."},aoColumns:[{sWidth:"330px"},{sWidth:"190px"},{sWidth:"120px"},{sWidth:"90px"},{sWidth:"90px"}],bAutoWidth:!1,aaSorting:[[2,"desc"]],sAjaxSource:h,fnServerData:function(d,g,h){a.ajax({url:d,data:{pub_id:c,start:e,end:f,format:"jsonp"},success:function(a,c,d){var e=b.map(a,function(a,b){var c=a.stats.pub_rev/(a.stats.imp+1)*1e3;return[a.creative.url,a.creative.ad_dmn,a.stats.pub_rev.toFixed(2),a.stats.imp,c]}),f={aaData:e};h(f,c,d)},dataType:"jsonp",cache:!1})},fnRowCallback:function(c,e,f){a("td:eq(0)",c).html("<iframe width='320px' height='50px' src='"+e[0]+"'></iframe>");var g=e[1];return b.contains(d,g)?a("td:eq(1)",c).text(g+" (Blocked)"):g!=null?a("td:eq(1)",c).html(g):a("td:eq(1)",c).html("<span class='muted'>(Unknown)</span>"),a("td:eq(2)",c).addClass("numeric").text("$"+mopub.Utils.formatNumberWithCommas(e[2])),a("td:eq(3)",c).addClass("numeric").text(mopub.Utils.formatNumberWithCommas(e[3])),a("td:eq(4)",c).addClass("numeric").text(mopub.Utils.formatCurrency(e[4])),c}});return i}function l(b){var c=a("<a href='#'>Remove</a>").click(m),d=a("<li></li>").html(b+" ");d.append(c),a("#blocked_domains").append(d)}function m(b){b.preventDefault();var c=a(this),d=c.attr("id");a("img",c.parent()).removeClass("hidden");var e=a.post("/campaigns/marketplace/settings/blocklist/",{action:"remove",blocklist:d});e.done(function(b){a("img#"+d).addClass("hidden"),c.parent().fadeOut()}),e.error(function(b){a("img#"+d).addClass("hidden"),Toast.error("There was an error adding to your blocklist. Please try again.")})}var c=function(){var b=a("Please <a href='#'>refresh the page</a> and try again.").click(function(a){a.preventDefault(),window.location.reload()});Toast.error(b,"Error fetching app data.")},n={initializeIndex:function(c){function g(){var b=a("#dashboard-stats .stats-breakdown .active");return b.attr("id")=="stats-breakdown-ecpm"?"line":"area"}e(c.app_keys),b.each(c.app_keys,function(a){f(a,c.marketplace_active)});var d=k(c.pub_key,c.blocklist,c.start_date,c.end_date);a(".stats-breakdown tr").click(function(b){var c=a(this);if(!c.hasClass("active")){var d=c.parents("table");a("tr.active",d).removeClass("active"),c.addClass("active")}}),a("#blindness").click(function(){var b=a("#blindness-spinner").show(),c=a("#blindness-save-status .saving").show(),d=a.post("/campaigns/marketplace/settings/blindness/",{activate:a(this).is(":checked")});d.done(function(d){b.hide(),c.hide();if(d.hasOwnProperty("success")){var e=a("#blindness-save-status .saved").show();setTimeout(function(){e.fadeOut()},1e3)}else{var f=a("#blindness-save-status .error").show();setTimeout(function(){f.fadeOut()},1e3)}})}),a.tablesorter.addWidget({id:"adunitSorting",format:function(b){var c={};a(".adunit-row",b).each(function(b,d){var e=Marketplace.getAppId(d),f;c.hasOwnProperty(e)?f=c(e):f=a(".app-row#app-"+e),a(d).remove(),f.after(d)})}}),a("a.block").click(function(b){b.preventDefault();var c=a(this),d=a(this).attr("id");a.ajax({type:"post",url:"/campaigns/marketplace/settings/blocklist/",data:{blocklist:d,action:"add"},success:function(a,b){c.text("Blocked").unbind("click").click(function(){return!1})}})}),a(".lightswitch").lightswitch(i,j),a("#top_switch").click(function(){a("#top_switch .switch").hasClass("on")&&(a("#first_time_toast").fadeIn(),setTimeout(function(){a("#first_time_toast").fadeOut()},3e3))}),a("#bottom_switch").click(function(){a("#bottom_switch .switch").hasClass("off")&&(a("#settings_toast").fadeIn(),setTimeout(function(){a("#settings_toast").fadeOut()},3e3))}),a("#blocklist-submit").click(function(b){b.preventDefault();var c=a("textarea[name='blocklist']").val(),d=a.post("/campaigns/marketplace/settings/blocklist/",{action:"add",blocklist:c});d.done(function(b){var c=b["new"];a.each(c,function(a,b){l(b)}),a("textarea[name='blocklist']").val("")}),d.error(function(a){Toast.warning(a)})}),a("a.blocklist_remove").click(m),a("input.content_level").click(function(){var b=a(this),c=b.attr("value"),d=a("#filter-spinner").show(),e=a("#filter-save-status .saving").show(),f=a.post("/campaigns/marketplace/settings/content_filter/",{filter_level:c});f.success(function(b){d.hide(),e.hide();if(b.hasOwnProperty("success")){var c=a("#filter-save-status .saved").show();setTimeout(function(){c.fadeOut()},1e3)}else{var f=a("#filter-save-status .error").show();setTimeout(function(){f.fadeOut()},1e3)}})}),a(".stats-breakdown tr").click(function(b){a("#dashboard-stats-chart").fadeOut(100,function(){mopub.Chart.setupDashboardStatsChart(g()),a(this).show()})});var h=mopub.accountStats.daily;mopub.dashboardStatsChartData={pointStart:mopub.graphStartDate,pointInterval:864e5,revenue:[{Total:mopub.Stats.statArrayFromDailyStats(h,"revenue")}],impressions:[{Total:mopub.Stats.statArrayFromDailyStats(h,"impressions")}],ecpm:[{Total:mopub.Stats.statArrayFromDailyStats(h,"ecpm")}]},mopub.Chart.setupDashboardStatsChart(g()),a("#dashboard-dateOptions input").click(function(){var b=a(this).val(),c=document.location.hash;if(b=="custom")a("#dashboard-dateOptions-custom-modal").dialog({width:570,buttons:[{text:"Set dates",css:{fontWeight:"600"},click:function(){var b=a("#dashboard-dateOptions-custom-from").datepicker("getDate"),d=a("#dashboard-dateOptions-custom-to").datepicker("getDate"),e=Math.ceil((d.getTime()-b.getTime())/864e5)+1,f=b.getDate(),g=b.getMonth()+1,h=b.getFullYear();a(this).dialog("close");var i=document.location.href.replace(c,"").replace(/\?.*/,"");document.location.href=i+"?r="+e+"&s="+h+"-"+g+"-"+f+c}},{text:"Cancel",click:function(){a(this).dialog("close")}}]});else{var d=document.location.href.replace(c,"").replace(/\?.*/,"");document.location.href=d+"?r="+b+c}}),a("#stats-breakdown-dateOptions input").click(function(){a(".stats-breakdown-value").hide(),a(".stats-breakdown-value."+a(this).val()).show()}),a("#dashboard-dateOptions-custom-from").datepicker({defaultDate:"-15d",maxDate:"0d",onSelect:function(b){var c=a("#dashboard-dateOptions-custom-to"),d=a(this).data("datepicker"),e=a.datepicker.parseDate(d.settings.dateFormat||a.datepicker._defaults.dateFormat,b,d.settings);c.datepicker("option","minDate",e)}}),a("#dashboard-dateOptions-custom-to").datepicker({defaultDate:"-1d",maxDate:"0d",onSelect:function(b){var c=a("#dashboard-dateOptions-custom-from"),d=a(this).data("datepicker"),e=a.datepicker.parseDate(d.settings.dateFormat||a.datepicker._defaults.dateFormat,b,d.settings);c.datepicker("option","maxDate",e)}})}};window.MarketplaceController=n})(this.jQuery,this._);var mopub=mopub||{};mopub.Utils=mopub.Utils||{},typeof window.console=="undefined"&&(window.console={log:function(){}}),function(a){function e(){var a={},b=window.location.search.slice(1).split("&"),c;for(var d=0;d<b.length;d++)c=b[d].split("="),a[c[0]]=c[1];return a}function h(a){return a.hasClass("active")}function i(b,c){c.length>1?c.each(function(){a(this).removeClass("active")}):c.find(".active").removeClass("active"),b.addClass("active")}var b=window.mopub||{},c=window.Chart||{},d=window.Stats||{};a(document).ready(function(){function d(){a(".messageCenter-message").length===0&&a("#messageCenter").hide()}if(typeof mpq.push!="undefined")try{a("#dashboard-dateOptions-option-7").click(function(){mpq.push(["track","7 Day Date-option clicked"])}),a("#dashboard-dateOptions-option-14").click(function(){mpq.push(["track","14 Day Date-option clicked"])}),a("#dashboard-dateOptions-option-30").click(function(){mpq.push(["track","30 Day Date-option clicked"])}),a("#dashboard-dateOptions-option-custom").click(function(){mpq.push(["track","Custom Date-option clicked"])}),a("#stats-breakdown-dateOptions-option-0").click(function(){mpq.push(["track",'"Today" clicked in Stats Breakdown'])}),a("#stats-breakdown-dateOptions-option-1").click(function(){mpq.push(["track",'"Yesterday" clicked in Stats Breakdown'])}),a("#stats-breakdown-dateOptions-option-2").click(function(){mpq.push(["track",'"All" clicked in Stats Breakdown'])})}catch(b){}a("#is_admin_input").val()=="False"&&a(".marketplace").hide();var c="/js/libs/jquery-ui-1.8.7.custom/css/mopub/images";a.preLoadImages("/images/ui/ui-button-active.png","/images/ui/ui-button-default.png","/images/ui/ui-button-hover.png","/images/ui/ui-icons-active.png","/images/ui/ui-icons-focus.png","/images/ui/ui-icons-hover.png","/images/ui/ui-icons-progress.png",c+"/ui-bg_highlight-hard_25_e57300_1x100.png",c+"/ui-bg_highlight-hard_50_dddddd_1x100.png",c+"/ui-bg_highlight-hard_100_f3f3f3_1x100.png",c+"/ui-bg_inset-soft_25_595959_1x100.png",c+"/ui-icons_0090d9_256x240.png",c+"/ui-icons_cc2929_256x240.png",c+"/ui-icons_ffffff_256x240.png","/placeholders/image.gif"),a("legend").each(function(){var b=a(this),c=a("<h2>"+b.html()+"</h2>");c.attr("class",b.attr("class")),c.attr("id",b.attr("id")),b.replaceWith(c)}),a(".button").button().css({visibility:"visible"}),a(".buttonset").buttonset().css({visibility:"visible"}),a(".buttonset-start-disabled").buttonset(),a(".buttonset-start-disabled").buttonset({disabled:!0}),a(".selectmenu").selectmenu().css({visibility:"visible"}),a(".validate").validate(),a(".sortable").tablesorter(),a(".tabs").tabs(),a(".pills").tabs(),a.extend(a.ui.dialog.prototype.options,{modal:!0,resizable:!1,draggable:!1,width:400}),a.datepicker.setDefaults({dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}),a("input[placeholder], textarea[placeholder]").placeholder({preventRefreshIssues:!0}),a("#titlebar .breadcrumb h1, .dataTable-name .inner").textOverflow(" &hellip;"),a(".dropdown-head").dropdown(".dropdown"),a(".alert-message .close").click(function(){a(this).parent().fadeOut()}),a.fn.qtip.styles.mopub={background:"#303030",color:"#ffffff",border:{radius:5},tip:{size:{x:10,y:10}},name:"dark"},a("a[title]").qtip({style:{name:"mopub",tip:!0}}),a(".formFields-field-help-link[title]").click(function(a){a.preventDefault()}),d(),a(".messageCenter-message-moreInfoLink").click(function(b){b.preventDefault();var c=a(this),d=a(".messageCenter-message-moreInfo",c.parents(".messageCenter-message"));d.clone().dialog({buttons:{Close:function(){a(this).dialog("close")}},close:function(b,c){a(this).remove()}})}),a(".messageCenter-message-hide").click(function(b){b.preventDefault();var c=a(this),e=c.parents(".messageCenter-message");e.fadeOut("fast",function(){e.remove(),d()})}),Highcharts.setOptions({chart:{animation:!1,backgroundColor:null,borderRadius:0,margin:[30,0,30,45],height:185},title:{text:null},lang:{loading:"Loading ..."},credits:{enabled:!1},style:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif'},plotOptions:{series:{animation:!1,shadow:!1,stickyTracking:!1},area:{lineWidth:4,fillOpacity:.1,stacking:"normal",marker:{lineWidth:2,radius:5,symbol:"circle",states:{hover:{lineWidth:2,radius:7}}},states:{hover:{lineWidth:4}}}},xAxis:{endOnTick:!1,gridLineWidth:.5,gridLineColor:"#dddddd",lineWidth:1,lineColor:"#cccccc",type:"datetime",labels:{style:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif',color:"#999",fontSize:"10px"},y:20},dateTimeLabelFormats:{second:"%b %e %l:%M:%S%p",minute:"%b %e %l:%M%p",hour:"%b %e %l:%M%p",day:"%b %e",week:"%b %e",month:"%b %Y",year:"%Y"},tickColor:"#dddddd",tickLength:5,tickWidth:.5},yAxis:{showFirstLabel:!1,showLastLabel:!0,gridLineWidth:.5,gridLineColor:"#dddddd",min:0,title:{text:null},labels:{style:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif',color:"#999",fontSize:"10px"},x:-5}},legend:{borderColor:null,borderRadius:0,borderWidth:0,align:"center",verticalAlign:"top",y:-17,itemStyle:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif',size:"12px",cursor:"pointer",color:"#444444"},itemHoverStyle:{color:"#e57300"},itemHiddenStyle:{color:"#ccc"},lineHeight:12,symbolPadding:6,symbolWidth:12},tooltip:{backgroundColor:"rgba(255, 255, 255, .9)",style:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif',fontSize:"13px",padding:"10px"}}}),a(".whatsthis").live("click",function(b){b.preventDefault(),a("#"+a(this).attr("id").replace("helpLink","helpContent")).dialog({buttons:{Close:function(){a(this).dialog("close")}}})})});var f=e(),g=[];a.preLoadImages=function(){var a=arguments.length;for(var b=a;b--;){var c=document.createElement("img");c.src=arguments[b],g.push(c)}},a.fn.dropdown=function(b){function f(){!a(b).hasClass("invisible"),a(b).removeClass("invisible"),a(c).addClass("hovered")}function g(){a(b).hasClass("invisible")||a(b).addClass("invisible"),a(c).removeClass("hovered")}var c=this,d,e=!1;g(),a(this).hover(function(){d=!0},function(){d=!1}),a(b).hover(function(){e=!0},function(){e=!1}),setInterval(function(){d||e?f():g()},1)},a.fn.tabs=function(){var b=a(".tab-section"),c=a(this),d=a("li",c);a.each(d,function(d,e){var f=a("a",e);a(f).click(function(a){a.preventDefault()});var g=f.attr("href");a(e).click(function(){i(a(this),c),i(a(g),b),window.location.hash=g+"-tab"}),window.location.hash==g+"-tab"&&a(e).click()})},a.unescapeHTML=function(b){return a("<div />").html(b).text()},a.escapeHTML=function(b){return a("<div />").text(b).html()},a.fn.lightswitch=function(b,c){typeof b=="undefined"&&(b=function(){return!0}),typeof c=="undefined"&&(c=function(){return!0});var d=a(this),e=a(".switch",d);d.click(function(){if(e.hasClass("on")){var a=c();a&&e.removeClass("on").addClass("off")}else if(e.hasClass("off")){var a=b();a&&e.removeClass("off").addClass("on")}else e.addClass("off")})},a.fn.lightswitchOn=function(){var b=a(this),c=a(".switch",b);c.removeClass("off").addClass("on")},a.fn.lightswitchOff=function(){var b=a(this),c=a(".switch",b);c.removeClass("on").addClass("off")},b.Utils=b.Utils||{},b.Utils.formatNumberWithCommas=function(a){a+="";var b=a.split("."),c=b[0],d=b.length>1?"."+b[1]:"",e=/(\d+)(\d{3})/;while(e.test(c))var c=c.replace(e,"$1,$2");return c+d},b.Utils.formatCurrency=function(a){return"$"+b.Utils.formatNumberWithCommas(a.toFixed(2))},b.Utils.formatNumberAsPercentage=function(a){return(a*100).toFixed(2)+"%"},b.Utils.getKeysFromObject=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},d.sortStatsObjectsByStat=function(a,b){return a.sort(function(a,c){var d=parseFloat(a.stats.sum[b]),e=parseFloat(c.stats.sum[b]);return d<e?1:d>e?-1:0}),a},d.statArrayFromDailyStats=function(b,c){return a.map(b,function(a){return parseFloat(a[c])})},d.getGraphSummedStatsForStatName=function(b,c){var e=[],f=c.splice(0,3),g=c;a.each(f,function(a,c){var f=c.key,g=c.stats.daily_stats,h={};h[f]=d.statArrayFromDailyStats(g,b),e.push(h)});if(g.length==0)return e;var h=d.sumDailyStatsAcrossStatsObjects(g,b),i={Others:h};return e.push(i),e},d.sumDailyStatsAcrossStatsObjects=function(b,c){var d=[];return a.each(b,function(b,e){var f=e.stats.daily_stats;a.each(f,function(a,b){d[a]||(d[a]=0),d[a]+=parseFloat(b[c])})}),d},d.getGraphCtrStats=function(b){var c=[],e=b.splice(0,3),f=b;a.each(e,function(a,b){var e=b.key,f=b.stats.daily_stats,g={};g[e]=d.statArrayFromDailyStats(f,"ctr"),c.push(g)});if(f.length==0)return c;var g=d.getDailyCtrAcrossStatsObjects(f),h={Others:g};return c.push(h),c},d.getDailyCtrAcrossStatsObjects=function(a){var b=[],c=d.sumDailyStatsAcrossStatsObjects(a,"click_count"),e=d.sumDailyStatsAcrossStatsObjects(a,"impression_count");for(var f=0,g=c.length;f<g;f++)b[f]=e[f]===0?0:c[f]/e[f];return b},c.moneyLabelFormatter=function(){return"$"+Highcharts.numberFormat(this.value,0)},c.percentageLabelFormatter=function(){return Highcharts.numberFormat(this.value,0)+"%"},c.numberLabelFormatter=function(){return this.value>=1e9?Highcharts.numberFormat(this.value/1e9,0)+"B":this.value>=1e6?Highcharts.numberFormat(this.value/1e6,0)+"M":this.value>=1e3?Highcharts.numberFormat(this.value/1e3,0)+"K":this.value>0?Highcharts.numberFormat(this.value,0):"0"},c.defaultTooltipFormatter=function(){var a=Highcharts.numberFormat(this.y,0),b=Highcharts.numberFormat(this.total,0),c='<span style="font-size: 14px;">'+Highcharts.dateFormat("%A, %B %e, %Y",this.x)+"</span>"+"<br/>"+'<span style="padding: 0; '+"font-weight: 600; "+"color: "+this.series.color+'">'+this.series.name+"</span>"+': <strong style="font-weight: 600;">'+a+"</strong><br/>";return c},c.highChartDefaultOptions={chart:{defaultSeriesType:"line",margin:[30,0,30,45]},legend:{verticalAlign:"bottom",y:-7,enabled:!0},yAxis:{labels:{formatter:c.numberLabelFormatter}},tooltip:{formatter:c.defaultTooltipFormatter}},c.createStatsChart=function(b,d,e){typeof e=="undefined"&&(e={});if(typeof d=="undefined"){c.chartError();return}var f=["#0090d9","#e57300","#53a600","#444444","#60beef"];a.each(d,function(a,b){typeof b.color=="undefined"&&(b.color=f[a%f.length]),b.lineWidth=4});var g=a.extend(c.highChartDefaultOptions,{chart:{renderTo:b.replace("#","")},series:d}),h=new Highcharts.Chart(g)},c.insertStatsChart=function(b,c,d){var e=a(b)},c.setupDashboardStatsChart=function(d){var e=a("#dashboard-stats .stats-breakdown .active");if(e===null||e.length===0)return;var f=e.attr("id").split("-"),g=f[f.length-1],h=b.dashboardStatsChartData;if(typeof h=="undefined"){c.chartError();return}var i=["#0090d9","#e57300","#53a600","#444444"],j=[],k=h[g];if(typeof k=="undefined"){c.chartError();return}a.each(k,function(b,c){var e,f,g;a.each(c,function(a,b){e=a,f=b,d=="line"?g=e=="MoPub Optimized"?3:2:g=4}),j.push({name:e,data:f,color:i[b],lineWidth:g})}),this.trafficChart=new Highcharts.Chart({chart:{renderTo:"dashboard-stats-chart",defaultSeriesType:d,marginTop:0,marginBottom:55,height:185},plotOptions:{series:{pointStart:h.pointStart,pointInterval:h.pointInterval}},legend:{verticalAlign:"bottom",y:-7,enabled:j.length>1},yAxis:{labels:{formatter:function(){return g=="revenue"||g=="ecpm"?"$"+Highcharts.numberFormat(this.value,0):g=="ctr"?Highcharts.numberFormat(this.value,0)+"%":this.value>=1e9?Highcharts.numberFormat(this.value/1e9,0)+"B":this.value>=1e6?Highcharts.numberFormat(this.value/1e6,0)+"M":this.value>=1e3?Highcharts.numberFormat(this.value/1e3,0)+"K":this.value>0?Highcharts.numberFormat(this.value,0):"0"}}},tooltip:{formatter:function(){var a="",b="",c="";return g=="revenue"||g=="ecpm"?(b="$"+Highcharts.numberFormat(this.y,2),c="$"+Highcharts.numberFormat(this.total,2)+" total"):g=="clicks"?(b=Highcharts.numberFormat(this.y,0)+" "+g,c=Highcharts.numberFormat(this.total,0)+" total "+g):g=="ctr"?(b=Highcharts.numberFormat(this.y*100,2)+"% click through",c=""):(b=Highcharts.numberFormat(this.y,0)+" "+g,c=Highcharts.numberFormat(this.total,0)+" total "+g),a+='<span style="font-size: 14px;">'+Highcharts.dateFormat("%A, %B %e, %Y",this.x)+"</span><br/>",a+='<span style="padding: 0; font-weight: 600; color: '+this.series.color+'">'+this.series.name+"</span>"+': <strong style="font-weight: 600;">'+b+"</strong><br/>",j.length>1&&(a+='<span style="font-size: 12px; color: #666;">',this.total>0&&c?a+="("+Highcharts.numberFormat(this.percentage,0)+"% of "+c+")":c&&(a+="("+c+")"),a+="</span>"),a}},series:j}),a("#dashboard-stats-chart").removeClass("chart-loading")},c.setupPieChart=function(a,b,c){this.impressionPieChart=new Highcharts.Chart({chart:{renderTo:a,plotBackgroundColor:null,plotShadow:!0,margin:0},title:{text:b},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+this.point.total+" "+b}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1,color:"#000000",connectorColor:"#000000",formatter:function(){return"<b>"+this.point.name+"</b>: "+this.percentage.toFixed(2)+" %"}},showInLegend:!0}},legend:{verticalAlign:"bottom"},series:[{type:"pie",name:b,data:c}]})},c.chartError=function(){a("#dashboard-stats-chart").removeClass("chart-loading").addClass("chart-error")},window.Chart=c,window.Stats=d,window.mopub=b,window.mopub.Stats=d,window.mopub.Chart=c,window.Mopub=b}(this.jQuery),function(a){function c(){return a("<div>").css(b.notificationStyles).hover(function(){a(this).css(b.notificationStylesHover)},function(){a(this).css(b.notificationStyles)})}var b=window.ToastjsConfig={defaultTimeOut:3e3,position:["top","right"],notificationStyles:{padding:"12px 18px",margin:"0 0 6px 0",backgroundColor:"#000",opacity:.8,color:"#fff",font:"normal 13px 'Droid Sans', sans-serif",borderRadius:"3px",boxShadow:"#999 0 0 12px",width:"300px"},notificationStylesHover:{opacity:1,boxShadow:"#000 0 0 12px"},container:a("<div></div>")};a(document).ready(function(){b.container.css("position","absolute"),b.container.css("z-index",9999),b.container.css(b.position[0],"12px"),b.container.css(b.position[1],"12px"),a("body").append(b.container)});var d=window.Toast={};d.notify=function(d,e,f,g){var h=c();g=g||b.defaultTimeOut;if(f){var i=a("<img/>",{src:f,css:{width:36,height
:36,display:"inline-block",verticalAlign:"middle","float":"left"}});h.append(i)}var j=a("<div/>").css({display:"inline-block",verticalAlign:"middle",padding:"0 12px"});if(e){var k=a("<div/>");k.append(document.createTextNode(e)),k.css("font-weight","bold"),j.append(k)}if(d){var l=a("<div/>");l.css("width","230px"),l.css("float","left"),l.html(d),j.append(l)}h.delay(g).fadeOut(function(){h.remove()}),h.bind("click",function(){h.hide()}),h.append(j),b.container.prepend(h)},d.info=function(a,b){d.notify(a,b,"")},d.warning=function(a,b){d.notify(a,b,"")},d.error=function(a,b){d.notify(a,b,"/images/36x36-error.png")},d.success=function(a,b){d.notify(a,b,"/images/36x36-success.png")}}(this.jQuery);var mopub=mopub||{};mopub.Utils=mopub.Utils||{},typeof window.console=="undefined"&&(window.console={log:function(){}}),function(a){function e(){var a={},b=window.location.search.slice(1).split("&"),c;for(var d=0;d<b.length;d++)c=b[d].split("="),a[c[0]]=c[1];return a}function h(a){return a.hasClass("active")}function i(b,c){c.length>1?c.each(function(){a(this).removeClass("active")}):c.find(".active").removeClass("active"),b.addClass("active")}var b=window.mopub||{},c=window.Chart||{},d=window.Stats||{};a(document).ready(function(){function d(){a(".messageCenter-message").length===0&&a("#messageCenter").hide()}if(typeof mpq.push!="undefined")try{a("#dashboard-dateOptions-option-7").click(function(){mpq.push(["track","7 Day Date-option clicked"])}),a("#dashboard-dateOptions-option-14").click(function(){mpq.push(["track","14 Day Date-option clicked"])}),a("#dashboard-dateOptions-option-30").click(function(){mpq.push(["track","30 Day Date-option clicked"])}),a("#dashboard-dateOptions-option-custom").click(function(){mpq.push(["track","Custom Date-option clicked"])}),a("#stats-breakdown-dateOptions-option-0").click(function(){mpq.push(["track",'"Today" clicked in Stats Breakdown'])}),a("#stats-breakdown-dateOptions-option-1").click(function(){mpq.push(["track",'"Yesterday" clicked in Stats Breakdown'])}),a("#stats-breakdown-dateOptions-option-2").click(function(){mpq.push(["track",'"All" clicked in Stats Breakdown'])})}catch(b){}a("#is_admin_input").val()=="False"&&a(".marketplace").hide();var c="/js/libs/jquery-ui-1.8.7.custom/css/mopub/images";a.preLoadImages("/images/ui/ui-button-active.png","/images/ui/ui-button-default.png","/images/ui/ui-button-hover.png","/images/ui/ui-icons-active.png","/images/ui/ui-icons-focus.png","/images/ui/ui-icons-hover.png","/images/ui/ui-icons-progress.png",c+"/ui-bg_highlight-hard_25_e57300_1x100.png",c+"/ui-bg_highlight-hard_50_dddddd_1x100.png",c+"/ui-bg_highlight-hard_100_f3f3f3_1x100.png",c+"/ui-bg_inset-soft_25_595959_1x100.png",c+"/ui-icons_0090d9_256x240.png",c+"/ui-icons_cc2929_256x240.png",c+"/ui-icons_ffffff_256x240.png","/placeholders/image.gif"),a("legend").each(function(){var b=a(this),c=a("<h2>"+b.html()+"</h2>");c.attr("class",b.attr("class")),c.attr("id",b.attr("id")),b.replaceWith(c)}),a(".button").button().css({visibility:"visible"}),a(".buttonset").buttonset().css({visibility:"visible"}),a(".buttonset-start-disabled").buttonset(),a(".buttonset-start-disabled").buttonset({disabled:!0}),a(".selectmenu").selectmenu().css({visibility:"visible"}),a(".validate").validate(),a(".sortable").tablesorter(),a(".tabs").tabs(),a(".pills").tabs(),a.extend(a.ui.dialog.prototype.options,{modal:!0,resizable:!1,draggable:!1,width:400}),a.datepicker.setDefaults({dayNamesMin:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]}),a("input[placeholder], textarea[placeholder]").placeholder({preventRefreshIssues:!0}),a("#titlebar .breadcrumb h1, .dataTable-name .inner").textOverflow(" &hellip;"),a(".dropdown-head").dropdown(".dropdown"),a(".alert-message .close").click(function(){a(this).parent().fadeOut()}),a.fn.qtip.styles.mopub={background:"#303030",color:"#ffffff",border:{radius:5},tip:{size:{x:10,y:10}},name:"dark"},a("a[title]").qtip({style:{name:"mopub",tip:!0}}),a(".formFields-field-help-link[title]").click(function(a){a.preventDefault()}),d(),a(".messageCenter-message-moreInfoLink").click(function(b){b.preventDefault();var c=a(this),d=a(".messageCenter-message-moreInfo",c.parents(".messageCenter-message"));d.clone().dialog({buttons:{Close:function(){a(this).dialog("close")}},close:function(b,c){a(this).remove()}})}),a(".messageCenter-message-hide").click(function(b){b.preventDefault();var c=a(this),e=c.parents(".messageCenter-message");e.fadeOut("fast",function(){e.remove(),d()})}),Highcharts.setOptions({chart:{animation:!1,backgroundColor:null,borderRadius:0,margin:[30,0,30,45],height:185},title:{text:null},lang:{loading:"Loading ..."},credits:{enabled:!1},style:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif'},plotOptions:{series:{animation:!1,shadow:!1,stickyTracking:!1},area:{lineWidth:4,fillOpacity:.1,stacking:"normal",marker:{lineWidth:2,radius:5,symbol:"circle",states:{hover:{lineWidth:2,radius:7}}},states:{hover:{lineWidth:4}}}},xAxis:{endOnTick:!1,gridLineWidth:.5,gridLineColor:"#dddddd",lineWidth:1,lineColor:"#cccccc",type:"datetime",labels:{style:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif',color:"#999",fontSize:"10px"},y:20},dateTimeLabelFormats:{second:"%b %e %l:%M:%S%p",minute:"%b %e %l:%M%p",hour:"%b %e %l:%M%p",day:"%b %e",week:"%b %e",month:"%b %Y",year:"%Y"},tickColor:"#dddddd",tickLength:5,tickWidth:.5},yAxis:{showFirstLabel:!1,showLastLabel:!0,gridLineWidth:.5,gridLineColor:"#dddddd",min:0,title:{text:null},labels:{style:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif',color:"#999",fontSize:"10px"},x:-5}},legend:{borderColor:null,borderRadius:0,borderWidth:0,align:"center",verticalAlign:"top",y:-17,itemStyle:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif',size:"12px",cursor:"pointer",color:"#444444"},itemHoverStyle:{color:"#e57300"},itemHiddenStyle:{color:"#ccc"},lineHeight:12,symbolPadding:6,symbolWidth:12},tooltip:{backgroundColor:"rgba(255, 255, 255, .9)",style:{fontFamily:'"myriad-pro-1", "myriad-pro-2", Helvetica, Arial, sans-serif',fontSize:"13px",padding:"10px"}}}),a(".whatsthis").live("click",function(b){b.preventDefault(),a("#"+a(this).attr("id").replace("helpLink","helpContent")).dialog({buttons:{Close:function(){a(this).dialog("close")}}})})});var f=e(),g=[];a.preLoadImages=function(){var a=arguments.length;for(var b=a;b--;){var c=document.createElement("img");c.src=arguments[b],g.push(c)}},a.fn.dropdown=function(b){function f(){!a(b).hasClass("invisible"),a(b).removeClass("invisible"),a(c).addClass("hovered")}function g(){a(b).hasClass("invisible")||a(b).addClass("invisible"),a(c).removeClass("hovered")}var c=this,d,e=!1;g(),a(this).hover(function(){d=!0},function(){d=!1}),a(b).hover(function(){e=!0},function(){e=!1}),setInterval(function(){d||e?f():g()},1)},a.fn.tabs=function(){var b=a(".tab-section"),c=a(this),d=a("li",c);a.each(d,function(d,e){var f=a("a",e);a(f).click(function(a){a.preventDefault()});var g=f.attr("href");a(e).click(function(){i(a(this),c),i(a(g),b),window.location.hash=g+"-tab"}),window.location.hash==g+"-tab"&&a(e).click()})},a.unescapeHTML=function(b){return a("<div />").html(b).text()},a.escapeHTML=function(b){return a("<div />").text(b).html()},a.fn.lightswitch=function(b,c){typeof b=="undefined"&&(b=function(){return!0}),typeof c=="undefined"&&(c=function(){return!0});var d=a(this),e=a(".switch",d);d.click(function(){if(e.hasClass("on")){var a=c();a&&e.removeClass("on").addClass("off")}else if(e.hasClass("off")){var a=b();a&&e.removeClass("off").addClass("on")}else e.addClass("off")})},a.fn.lightswitchOn=function(){var b=a(this),c=a(".switch",b);c.removeClass("off").addClass("on")},a.fn.lightswitchOff=function(){var b=a(this),c=a(".switch",b);c.removeClass("on").addClass("off")},b.Utils=b.Utils||{},b.Utils.formatNumberWithCommas=function(a){a+="";var b=a.split("."),c=b[0],d=b.length>1?"."+b[1]:"",e=/(\d+)(\d{3})/;while(e.test(c))var c=c.replace(e,"$1,$2");return c+d},b.Utils.formatCurrency=function(a){return"$"+b.Utils.formatNumberWithCommas(a.toFixed(2))},b.Utils.formatNumberAsPercentage=function(a){return(a*100).toFixed(2)+"%"},b.Utils.getKeysFromObject=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b},d.sortStatsObjectsByStat=function(a,b){return a.sort(function(a,c){var d=parseFloat(a.stats.sum[b]),e=parseFloat(c.stats.sum[b]);return d<e?1:d>e?-1:0}),a},d.statArrayFromDailyStats=function(b,c){return a.map(b,function(a){return parseFloat(a[c])})},d.getGraphSummedStatsForStatName=function(b,c){var e=[],f=c.splice(0,3),g=c;a.each(f,function(a,c){var f=c.key,g=c.stats.daily_stats,h={};h[f]=d.statArrayFromDailyStats(g,b),e.push(h)});if(g.length==0)return e;var h=d.sumDailyStatsAcrossStatsObjects(g,b),i={Others:h};return e.push(i),e},d.sumDailyStatsAcrossStatsObjects=function(b,c){var d=[];return a.each(b,function(b,e){var f=e.stats.daily_stats;a.each(f,function(a,b){d[a]||(d[a]=0),d[a]+=parseFloat(b[c])})}),d},d.getGraphCtrStats=function(b){var c=[],e=b.splice(0,3),f=b;a.each(e,function(a,b){var e=b.key,f=b.stats.daily_stats,g={};g[e]=d.statArrayFromDailyStats(f,"ctr"),c.push(g)});if(f.length==0)return c;var g=d.getDailyCtrAcrossStatsObjects(f),h={Others:g};return c.push(h),c},d.getDailyCtrAcrossStatsObjects=function(a){var b=[],c=d.sumDailyStatsAcrossStatsObjects(a,"click_count"),e=d.sumDailyStatsAcrossStatsObjects(a,"impression_count");for(var f=0,g=c.length;f<g;f++)b[f]=e[f]===0?0:c[f]/e[f];return b},c.moneyLabelFormatter=function(){return"$"+Highcharts.numberFormat(this.value,0)},c.percentageLabelFormatter=function(){return Highcharts.numberFormat(this.value,0)+"%"},c.numberLabelFormatter=function(){return this.value>=1e9?Highcharts.numberFormat(this.value/1e9,0)+"B":this.value>=1e6?Highcharts.numberFormat(this.value/1e6,0)+"M":this.value>=1e3?Highcharts.numberFormat(this.value/1e3,0)+"K":this.value>0?Highcharts.numberFormat(this.value,0):"0"},c.defaultTooltipFormatter=function(){var a=Highcharts.numberFormat(this.y,0),b=Highcharts.numberFormat(this.total,0),c='<span style="font-size: 14px;">'+Highcharts.dateFormat("%A, %B %e, %Y",this.x)+'</span><br/><span style="padding: 0; font-weight: 600; color: '+this.series.color+'">'+this.series.name+'</span>: <strong style="font-weight: 600;">'+a+"</strong><br/>";return c},c.highChartDefaultOptions={chart:{defaultSeriesType:"line",margin:[30,0,30,45]},legend:{verticalAlign:"bottom",y:-7,enabled:!0},yAxis:{labels:{formatter:c.numberLabelFormatter}},tooltip:{formatter:c.defaultTooltipFormatter}},c.createStatsChart=function(b,d,e){typeof e=="undefined"&&(e={});if(typeof d=="undefined"){c.chartError();return}var f=["#0090d9","#e57300","#53a600","#444444","#60beef"];a.each(d,function(a,b){typeof b.color=="undefined"&&(b.color=f[a%f.length]),b.lineWidth=4});var g=a.extend(c.highChartDefaultOptions,{chart:{renderTo:b.replace("#","")},series:d}),h=new Highcharts.Chart(g)},c.insertStatsChart=function(b,c,d){var e=a(b)},c.setupDashboardStatsChart=function(d){var e=a("#dashboard-stats .stats-breakdown .active");if(e===null||e.length===0)return;var f=e.attr("id").split("-"),g=f[f.length-1],h=b.dashboardStatsChartData;if(typeof h=="undefined"){c.chartError();return}var i=["#0090d9","#e57300","#53a600","#444444"],j=[],k=h[g];if(typeof k=="undefined"){c.chartError();return}a.each(k,function(b,c){var e,f,g;a.each(c,function(a,b){e=a,f=b,d=="line"?g=e=="MoPub Optimized"?3:2:g=4}),j.push({name:e,data:f,color:i[b],lineWidth:g})}),this.trafficChart=new Highcharts.Chart({chart:{renderTo:"dashboard-stats-chart",defaultSeriesType:d,marginTop:0,marginBottom:55,height:185},plotOptions:{series:{pointStart:h.pointStart,pointInterval:h.pointInterval}},legend:{verticalAlign:"bottom",y:-7,enabled:j.length>1},yAxis:{labels:{formatter:function(){return g=="revenue"||g=="ecpm"?"$"+Highcharts.numberFormat(this.value,0):g=="ctr"?Highcharts.numberFormat(this.value,0)+"%":this.value>=1e9?Highcharts.numberFormat(this.value/1e9,0)+"B":this.value>=1e6?Highcharts.numberFormat(this.value/1e6,0)+"M":this.value>=1e3?Highcharts.numberFormat(this.value/1e3,0)+"K":this.value>0?Highcharts.numberFormat(this.value,0):"0"}}},tooltip:{formatter:function(){var a="",b="",c="";return g=="revenue"||g=="ecpm"?(b="$"+Highcharts.numberFormat(this.y,2),c="$"+Highcharts.numberFormat(this.total,2)+" total"):g=="clicks"?(b=Highcharts.numberFormat(this.y,0)+" "+g,c=Highcharts.numberFormat(this.total,0)+" total "+g):g=="ctr"?(b=Highcharts.numberFormat(this.y*100,2)+"% click through",c=""):(b=Highcharts.numberFormat(this.y,0)+" "+g,c=Highcharts.numberFormat(this.total,0)+" total "+g),a+='<span style="font-size: 14px;">'+Highcharts.dateFormat("%A, %B %e, %Y",this.x)+"</span><br/>",a+='<span style="padding: 0; font-weight: 600; color: '+this.series.color+'">'+this.series.name+'</span>: <strong style="font-weight: 600;">'+b+"</strong><br/>",j.length>1&&(a+='<span style="font-size: 12px; color: #666;">',this.total>0&&c?a+="("+Highcharts.numberFormat(this.percentage,0)+"% of "+c+")":c&&(a+="("+c+")"),a+="</span>"),a}},series:j}),a("#dashboard-stats-chart").removeClass("chart-loading")},c.setupPieChart=function(a,b,c){this.impressionPieChart=new Highcharts.Chart({chart:{renderTo:a,plotBackgroundColor:null,plotShadow:!0,margin:0},title:{text:b},tooltip:{formatter:function(){return"<b>"+this.point.name+"</b>: "+this.point.total+" "+b}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1,color:"#000000",connectorColor:"#000000",formatter:function(){return"<b>"+this.point.name+"</b>: "+this.percentage.toFixed(2)+" %"}},showInLegend:!0}},legend:{verticalAlign:"bottom"},series:[{type:"pie",name:b,data:c}]})},c.chartError=function(){a("#dashboard-stats-chart").removeClass("chart-loading").addClass("chart-error")},window.Chart=c,window.Stats=d,window.mopub=b,window.mopub.Stats=d,window.mopub.Chart=c,window.Mopub=b}(this.jQuery),$(function(){var a=function(){var a=$("Please <a href='#'>refresh the page</a> and try again.").click(function(a){a.preventDefault(),window.location.reload()});Toast.error(a,"Error fetching app data.")},b={initialize:function(b){var c=b.adgroups_data,d=b.graph_start_date,e=b.today,f=b.yesterday,g=b.ajax_query_string,h=new AdGroups(c),i=new CollectionGraphView({collection:h,start_date:d,today:e,yesterday:f});i.render();var j=new AdGroupsView({collection:h,el:"#adgroups",title:"Ad Networks",type:"network"});j.render(),h.each(function(b){b.fetch({data:g,error:function(){b.fetch({error:a})}})}),$("#dashboard-dateOptions input").click(function(){var a=$(this).val(),b=document.location.hash;if(a=="custom")$("#dashboard-dateOptions-custom-modal").dialog({width:570,buttons:[{text:"Set dates",css:{fontWeight:"600"},click:function(){var a=$("#dashboard-dateOptions-custom-from").datepicker("getDate"),c=$("#dashboard-dateOptions-custom-to").datepicker("getDate"),d=Math.round((c.getTime()-a.getTime())/864e5),e=a.getDate(),f=a.getMonth()+1,g=a.getFullYear();$(this).dialog("close");var h=document.location.href.replace(b,"").replace(/\?.*/,"");document.location.href=h+"?r="+d+"&s="+g+"-"+f+"-"+e+b}},{text:"Cancel",click:function(){$(this).dialog("close")}}]});else{var c=document.location.href.replace(b,"").replace(/\?.*/,"");document.location.href=c+"?r="+a+b}}),$("#dashboard-dateOptions-custom-from").datepicker({defaultDate:"-15d",maxDate:"0d",onSelect:function(a){var b=$("#dashboard-dateOptions-custom-to"),c=$(this).data("datepicker"),d=$.datepicker.parseDate(c.settings.dateFormat||$.datepicker._defaults.dateFormat,a,c.settings);b.datepicker("option","minDate",d)}}),$("#dashboard-dateOptions-custom-to").datepicker({defaultDate:"-1d",maxDate:"0d",onSelect:function(a){var b=$("#dashboard-dateOptions-custom-from"),c=$(this).data("datepicker"),d=$.datepicker.parseDate(c.settings.dateFormat||$.datepicker._defaults.dateFormat,a,c.settings);b.datepicker("option","maxDate",d)}});var k=this;$(".stats-breakdown tr").click(function(a){var b=$(this);b.hasClass("active")||(b.siblings().removeClass("active"),b.addClass("active"),$("#dashboard-stats-chart").fadeOut(100,function(){i.show_chart(),$(this).show()}))}),$("#stats-breakdown-dateOptions input").click(function(){$(".stats-breakdown-value").hide(),$(".stats-breakdown-value."+$(this).val()).show()}),$(".stats-breakdown-value").hide(),$(".stats-breakdown-value.all").show(),$("#add_campaign_button").button({icons:{primary:"ui-icon-circle-plus"}});var l=["pause","resume","activate","archive","delete"];$.each(l,function(a,b){$("#campaignForm-"+b).click(function(a){a.preventDefault(),$("#campaignForm").find("#action").attr("value",b).end().submit()})})}};window.NetworksController=b});var mopub=mopub||{};(function(a){a(document).ready(function(){a("#header-icons a").css({opacity:.25}).hover(function(){a(this).stop().animate({opacity:.75},200)},function(){a(this).stop().animate({opacity:.25},400)})})})(this.jQuery);var mopub=mopub||{};(function(a,b,c){function e(){var b=a("#dashboard-stats .stats-breakdown .active");return b.attr("id")=="stats-breakdown-ctr"?"line":"area"}function f(a,b){var c=a.all_stats["||"].daily_stats;mopub.dashboardStatsChartData={pointStart:b,pointInterval:864e5,requests:[{Total:mopub.Stats.statArrayFromDailyStats(c,"request_count")}],impressions:[{Total:mopub.Stats.statArrayFromDailyStats(c,"impression_count")}],clicks:[{Total:mopub.Stats.statArrayFromDailyStats(c,"click_count")}],users:[{Total:mopub.Stats.statArrayFromDailyStats(c,"user_count")}]},mopub.Chart.setupDashboardStatsChart(e())}function g(a){c.each(a,function(a){var b=new App({id:a,stats_endpoint:"all"});b.bind("change",function(a){var b=new AppView({model:a,el:"#dashboard-apps"});b.renderInline()}),b.fetch({error:function(){b.fetch({error:d})}})})}function h(b){var e=new AdUnitCollection;e.app_id=b,e.stats_endpoint="all",e.bind("reset",function(a){c.each(a.models,function(a){var b=new AdUnitView({model:a,el:"#dashboard-apps"});b.renderInline()})}),e.fetch({success:function(c){a("table").trigger("update"),a("#"+b+"-img").hide()},error:function(){e.fetch({error:d})}})}function i(){p(),a("#appForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#appForm").submit()}),a('#appForm input[name="app_type"]').click(function(b){a("#appForm .appForm-platformDependent").removeClass("iphone").removeClass("android").addClass(a(this).val())}).filter(":checked").click(),a('input[name="name"]').change(function(){var b=a.trim(a(this).val());a("#appForm-adUnitName").val(b+" banner ad")}),a("#appForm-search-button").button({icons:{primary:"ui-icon-search"}}).click(function(b){b.preventDefault();if(a(this).button("option","disabled"))return;a("#searchAppStore-loading").show(),a("#dashboard-searchAppStore-custom-modal").dialog({buttons:[{text:"Cancel",click:function(){a("#searchAppStore-results").html(""),a(this).dialog("close")}}]});var c=a('#appForm input[name="name"]').val(),d=document.createElement("script");d.src="http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/wa/wsSearchNaN"+c;var e=document.getElementsByTagName("head")[0];(e||document.body).appendChild(d)}),a("#appForm-name").val()===""&&(a("#appForm-search-button").button("disable"),a("#appForm-search").button("disable"),a("#appForm-market-search-button").button("disable"),a("#appForm-market-search").button("disable")),a("#appForm-name").keyup(function(b){var c=a.trim(a(this).val()),d=a('input:radio[name="app_type"]:checked').val();c.length?(a("#appForm-search-button").button("enable"),a("#appForm-market-search-button").button("enable")):(a("#appForm-search-button").button("disable"),a("#appForm-market-search-button").button("disable")),b.keyCode==13&&(d=="iphone"?a("#appForm-search-button").click():d=="android"&&a("#appForm-market-search-button").click())}),a("#appForm-changeIcon-link").click(function(b){b.preventDefault(),a(this).hide(),a("#appForm-icon-upload").show(),a('#appForm input[name="img_url"]').val("")}),a('input[name="app_type"]').click(function(b){a("#appForm .appForm-platformDependent").removeClass("iphone").removeClass("android").removeClass("mweb").addClass(a(this).val())}).filter(":checked").click()}function j(){i(),a("#appForm.appEditForm").ajaxForm({data:{ajax:!0},dataType:"json",success:function(b,c,d,e){a("#appEditForm-loading").hide(),b.success?window.location.reload():(a(".form-error-text","#appForm").remove(),a.each(b.errors,function(b,c){var d=c[0],e=a("<div>").append(c[1]).addClass("form-error-text");a("input[name="+d+"]","#appForm").addClass("error").parent().append(e),a("select[name="+d+"]","#appForm").addClass("error").parent().append(e)}),i(),window.location.hash="",window.location.hash="appForm")}}),a("#appEditForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#appEditForm-loading").show(),a("#appForm").submit()}),a("#appEditForm-cancel").click(function(b){b.preventDefault(),a("#dashboard-appEditForm").slideUp("fast")}),a("#dashboard-apps-editAppButton").button({icons:{primary:"ui-icon-wrench"}}).click(function(b){b.preventDefault(),a("#dashboard-appEditForm").is(":visible")?a("#dashboard-appEditForm").slideUp("fast"):a("#dashboard-appEditForm").slideDown("fast")})}function k(){a("#adunit-device_format_phone").parent().buttonset(),a("#adunit-device_format_phone").click(function(b){a("#adForm-tablet-container").hide(),a("#adForm-phone-container").show().find('input[type="radio"]')[0].click()}),a("#adunit-device_format_tablet").click(function(b){console.log("tablet clicked"),a("#adForm-phone-container").hide(),a("#adForm-tablet-container").show().find('input[type="radio"]')[0].click()}),a("#dashboard-apps-addAdUnitButton").button({icons:{primary:"ui-icon-circle-plus"}}).click(function(b){b.preventDefault(),a("#dashboard-adunitAddForm").is(":visible")?a("#dashboard-adunitAddForm").slideUp("fast"):a("#dashboard-adunitAddForm").slideDown("fast")}),a("#adunitAddForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#adunitForm-loading").show(),a("#adunitAddForm").submit()}),a("#adunitAddForm-cancel").click(function(b){b.preventDefault(),a("#dashboard-adunitAddForm").slideUp("fast",function(){a("#dashboard-apps-addAdUnitButton").show()})}),a("#adunitAddForm").ajaxForm({data:{ajax:!0},dataType:"json",success:function(b,c,d,e){a("#adunitForm-loading").hide(),b.success?window.location.reload():(i(),k(),window.location.hash="",window.location.hash="adunitForm")}}),a("#adForm-phone-formats").each(function(){var b=a(this);a('input[type="radio"]',b).click(function(b){var c=a(this),d=c.parents(".adForm-format");a(".adForm-format-image").css({opacity:.5}),a(".adForm-format-image",d).css({opacity:1});var e=a(".full_only"),f=a(".banner_only");a(this).attr("id")=="appForm-adUnitFormat-full-tablet"||a(this).attr("id")=="appForm-adUnitFormat-full"?(e.show(),f.hide()):(e.hide(),f.show());var g=a(".custom_only");a(this).attr("id")=="appForm-adUnitFormat-tablet-custom"||a(this).attr("id")=="appForm-adUnitFormat-custom"?g.show():g.hide()}).filter(":checked").click(),a(".adForm-format-image",b).click(function(b){var c=a(this),d=c.parents(".adForm-format");a('input[type="radio"]',d).click()}),a('.adForm-format-details input[type="text"]',b).focus(function(){var b=a(this),c=b.parents(".adForm-format");a('input[type="radio"]',c).click()})}),a("#adForm-tablet-formats").each(function(){var b=a(this);a(this).find('input[type="radio"]').click(function(b){var c=a(this).parent().index(),d=a("#adForm-images-container");d.children().hide();var e=d.children()[c];a(e).show().css({opacity:1});var f=a(".full_only"),g=a(".banner_only");a(this).attr("id")=="appForm-adUnitFormat-full-tablet"||a(this).attr("id")=="appForm-adUnitFormat-full"?(f.show(),g.hide()):(f.hide(),g.show());var h=a(".custom_only");a(this).attr("id")=="appForm-adUnitFormat-tablet-custom"||a(this).attr("id")=="appForm-adUnitFormat-custom"?h.show():h.hide()}).first().click()}),a("#adunit-device_format_phone").parent().children().filter(":checked").click().each(function(){var b=a(this).val(),c="#adForm-"+b+"-container";a(c).find(".possible-format").click()})}function l(){k(),a("#dashboard-apps-editAdUnitButton").button({icons:{primary:"ui-icon-wrench"}}).click(function(b){b.preventDefault(),a("#dashboard-adunitEditForm").is(":visible")?a("#dashboard-adunitEditForm").slideUp("fast"):a("#dashboard-adunitEditForm").slideDown("fast")}),a("#adunitEditForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#adunitForm-loading").show(),a("#adunitAddForm").submit()}),a("#adunitEditForm-cancel").click(function(b){b.preventDefault(),a("#dashboard-adunitEditForm").slideUp("fast")}),a("#adunitAddForm").ajaxForm({data:{ajax:!0},dataType:"json",success:function(b,c,d,e){a("#adunitForm-loading").hide(),b.success?window.location.reload():(i(),k(),window.location.hash="",window.location.hash="adunitForm")}})}function m(){var b=a(".appData-details-toggleButton");b.button();var c=a("#appData-individual");b.click(function(a){a.preventDefault(),c.hasClass("hidden")?(c.removeClass("hidden"),b.button("option","label","Hide Details")):(c.addClass("hidden"),b.button("option","label","Show Details"),b.button())})}function n(){a("#dashboard-dateOptions input").click(function(){var b=a(this).val();if(b=="custom")a("#dashboard-dateOptions-custom-modal").dialog({width:570,buttons:[{text:"Set dates",css:{fontWeight:"600"},click:function(){var b=a("#dashboard-dateOptions-custom-from").datepicker("getDate"),c=a("#dashboard-dateOptions-custom-to").datepicker("getDate"),d=Math.ceil((c.getTime()-b.getTime())/864e5)+1,e=b.getDate(),f=b.getMonth()+1,g=b.getFullYear();a(this).dialog("close");var h=document.location.href.replace(/\?.*/,"");document.location.href=h+"?r="+d+"&s="+g+"-"+f+"-"+e}},{text:"Cancel",click:function(){a(this).dialog("close")}}]});else{var c=document.location.href.replace(/\?.*/,"");document.location.href=c+"?r="+b}}),a("#stats-breakdown-dateOptions input").click(function(){a(".stats-breakdown-value").hide(),a(".stats-breakdown-value."+a(this).val()).show()}),a("#dashboard-dateOptions-custom-from").datepicker({defaultDate:"-15d",maxDate:"0d",onSelect:function(b){var c=a("#dashboard-dateOptions-custom-to"),d=a(this).data("datepicker"),e=a.datepicker.parseDate(d.settings.dateFormat||a.datepicker._defaults.dateFormat,b,d.settings);c.datepicker("option","minDate",e)}}),a("#dashboard-dateOptions-custom-to").datepicker({defaultDate:"-1d",maxDate:"0d",onSelect:function(b){var c=a("#dashboard-dateOptions-custom-from"),d=a(this).data("datepicker"),e=a.datepicker.parseDate(d.settings.dateFormat||a.datepicker._defaults.dateFormat,b,d.settings);c.datepicker("option","maxDate",e)}})}function o(){a("#dashboard-delete-link").click(function(b){b.preventDefault(),a("#dashboard-delete-modal").dialog({buttons:[{text:"Delete",click:function(){a(this).dialog("close"),a("#dashboard-deleteForm").submit()}},{text:"Cancel",click:function(){a(this).dialog("close")}}]})})}function p(){a("#appForm-search-button").button({icons:{primary:"ui-icon-search"}}).click(function(b){b.preventDefault();if(a(this).button("option","disabled"))return;a("#searchAppStore-loading").show(),a("#dashboard-searchAppStore-custom-modal").dialog({buttons:[{text:"Cancel",click:function(){a("#searchAppStore-results").html(""),a(this).dialog("close")}}]});var c=a('#appForm input[name="name"]').val(),d=document.createElement("script");d.src="http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/wa/wsSearch?entity=software&limit=10&callback=loadedArtwork&term="+c;var e=document.getElementsByTagName("head")[0];(e||document.body).appendChild(d)})}function q(){n(),a(".stats-breakdown tr").click(function(b){a("#dashboard-stats-chart").fadeOut(100,function(){mopub.Chart.setupDashboardStatsChart(e()),a(this).show()})}),a(".stats-breakdown tr").click(function(b){var c=a(this);if(!c.hasClass("active")){var d=c.parents("table");a("tr.active",d).removeClass("active"),c.addClass("active")}}),a(".appData-id").each(function(){var b=a(this),c=b.parents("tr");c.hover(function(){b.show()},function(){b.hide()})})}function r(a){}var d=function(){var b=a("Please <a href='#'>refresh the page</a> and try again.").click(function(a){a.preventDefault(),window.location.reload()});Toast.error(b,"Error fetching app data.")},s={initializeIndex:function(b){q(),f(b.account_stats,b.start_date),g(b.app_keys),c.each(b.app_keys,function(a){h(a)}),a("#dashboard-apps-addAppButton").button({icons:{primary:"ui-icon-circle-plus"}}),a("#publisher-dashboard-exportSelect").change(function(b){b.preventDefault();var c=a(this).val();c!="exp"&&a("#dashboardExportForm").find("#appExportType").val(c).end().submit(),a(this).selectmenu("index",0)}),a("#publisher-dashboard-exportSelect-menu").find("li").first().hide()},initializeGeo:function(a){q(),mopub.Chart.setupDashboardStatsChart(e())},initializeAppDetail:function(b){q(),j(),k(),o(),p(),m(),mopub.Chart.setupDashboardStatsChart(e()),a("#publisher-app-exportSelect").change(function(b){b.preventDefault();var c=a(this).val();c!="exp"&&a("#appExportForm").find("#appExportType").val(c).end().submit(),a(this).selectmenu("index",0)}),a("#publisher-app-exportSelect-menu").find("li").first().hide(),g([b.app_key]),h(b.app_key)},initializeAdunitDetail:function(b){q(),o(),m(),l(),mopub.Chart.setupDashboardStatsChart(e()),a("#advertisers-testAdServer").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#adserverTest").dialog({buttons:{Close:function(){a(this).dialog("close")}}}),a("#adserverTest-iFrame").attr("src",a("#adserverTest-iFrame-src").text())})},initializeAppCreate:function(a){q(),i(),k()}};window.DashboardController=s})(this.jQuery,this.Backbone,this._);var artwork_json,mopub=mopub||{};(function(a,b,c){function d(){var b=a("#dashboard-stats .stats-breakdown .active");return b.attr("id")=="stats-breakdown-ctr"?"line":"area"}function e(a,b){var c=a.all_stats["||"].daily_stats;mopub.dashboardStatsChartData={pointStart:b,pointInterval:864e5,requests:[{Total:mopub.Stats.statArrayFromDailyStats(c,"request_count")}],impressions:[{Total:mopub.Stats.statArrayFromDailyStats(c,"impression_count")}],clicks:[{Total:mopub.Stats.statArrayFromDailyStats(c,"click_count")}],users:[{Total:mopub.Stats.statArrayFromDailyStats(c,"user_count")}]},mopub.Chart.setupDashboardStatsChart(d())}function f(a){c.each(a,function(a){var b=new App({id:a,stats_endpoint:"all"});b.bind("change",function(a){var b=new AppView({model:a,el:"#dashboard-apps"});b.renderInline()}),b.fetch()})}function g(b){var d=new AdUnitCollection;d.app_id=b,d.stats_endpoint="all",d.bind("reset",function(a){c.each(a.models,function(a){var b=new AdUnitView({model:a,el:"#dashboard-apps"});b.renderInline()})}),d.fetch({success:function(c){a("table").trigger("update"),a("#"+b+"-img").hide()}})}function h(){o(),a("#appForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#appForm").submit()}),a('#appForm input[name="app_type"]').click(function(b){a("#appForm .appForm-platformDependent").removeClass("iphone").removeClass("android").addClass(a(this).val())}).filter(":checked").click(),a('input[name="name"]').change(function(){var b=a.trim(a(this).val());a("#appForm-adUnitName").val(b+" banner ad")}),a("#appForm-search-button").button({icons:{primary:"ui-icon-search"}}).click(function(b){b.preventDefault();if(a(this).button("option","disabled"))return;a("#searchAppStore-loading").show(),a("#dashboard-searchAppStore-custom-modal").dialog({buttons:[{text:"Cancel",click:function(){a("#searchAppStore-results").html(""),a(this).dialog("close")}}]});var c=a('#appForm input[name="name"]').val(),d=document.createElement("script");d.src="http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/wa/wsSearchNaN"+c;var e=document.getElementsByTagName("head")[0];(e||document.body).appendChild(d)}),a("#appForm-name").val()===""&&(a("#appForm-search-button").button("disable"),a("#appForm-search").button("disable"),a("#appForm-market-search-button").button("disable"),a("#appForm-market-search").button("disable")),a("#appForm-name").keyup(function(b){var c=a.trim(a(this).val()),d=a('input:radio[name="app_type"]:checked').val();c.length?(a("#appForm-search-button").button("enable"),a("#appForm-market-search-button").button("enable")):(a("#appForm-search-button").button("disable"),a("#appForm-market-search-button").button("disable")),b.keyCode==13&&(d=="iphone"?a("#appForm-search-button").click():d=="android"&&a("#appForm-market-search-button").click())}),a("#appForm-changeIcon-link").click(function(b){b.preventDefault(),a(this).hide(),a("#appForm-icon-upload").show(),a('#appForm input[name="img_url"]').val("")}),a('input[name="app_type"]'
).click(function(b){a("#appForm .appForm-platformDependent").removeClass("iphone").removeClass("android").removeClass("mweb").addClass(a(this).val())}).filter(":checked").click()}function i(){h(),a("#appForm.appEditForm").ajaxForm({data:{ajax:!0},dataType:"json",success:function(b,c,d,e){a("#appEditForm-loading").hide(),b.success?window.location.reload():(a(".form-error-text","#appForm").remove(),a.each(b.errors,function(b,c){var d=c[0],e=a("<div>").append(c[1]).addClass("form-error-text");a("input[name="+d+"]","#appForm").addClass("error").parent().append(e),a("select[name="+d+"]","#appForm").addClass("error").parent().append(e)}),h(),window.location.hash="",window.location.hash="appForm")}}),a("#appEditForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#appEditForm-loading").show(),a("#appForm").submit()}),a("#appEditForm-cancel").click(function(b){b.preventDefault(),a("#dashboard-appEditForm").slideUp("fast")}),a("#dashboard-apps-editAppButton").button({icons:{primary:"ui-icon-wrench"}}).click(function(b){b.preventDefault(),a("#dashboard-appEditForm").is(":visible")?a("#dashboard-appEditForm").slideUp("fast"):a("#dashboard-appEditForm").slideDown("fast")})}function j(){a("#adunit-device_format_phone").parent().buttonset(),a("#adunit-device_format_phone").click(function(b){a("#adForm-tablet-container").hide(),a("#adForm-phone-container").show().find('input[type="radio"]')[0].click()}),a("#adunit-device_format_tablet").click(function(b){console.log("tablet clicked"),a("#adForm-phone-container").hide(),a("#adForm-tablet-container").show().find('input[type="radio"]')[0].click()}),a("#dashboard-apps-addAdUnitButton").button({icons:{primary:"ui-icon-circle-plus"}}).click(function(b){b.preventDefault(),a("#dashboard-adunitAddForm").is(":visible")?a("#dashboard-adunitAddForm").slideUp("fast"):a("#dashboard-adunitAddForm").slideDown("fast")}),a("#adunitAddForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#adunitForm-loading").show(),a("#adunitAddForm").submit()}),a("#adunitAddForm-cancel").click(function(b){b.preventDefault(),a("#dashboard-adunitAddForm").slideUp("fast",function(){a("#dashboard-apps-addAdUnitButton").show()})}),a("#adunitAddForm").ajaxForm({data:{ajax:!0},dataType:"json",success:function(b,c,d,e){a("#adunitForm-loading").hide(),b.success?window.location.reload():(h(),j(),window.location.hash="",window.location.hash="adunitForm")}}),a("#adForm-phone-formats").each(function(){var b=a(this);a('input[type="radio"]',b).click(function(b){var c=a(this),d=c.parents(".adForm-format");a(".adForm-format-image").css({opacity:.5}),a(".adForm-format-image",d).css({opacity:1});var e=a(".full_only"),f=a(".banner_only");a(this).attr("id")=="appForm-adUnitFormat-full-tablet"||a(this).attr("id")=="appForm-adUnitFormat-full"?(e.show(),f.hide()):(e.hide(),f.show());var g=a(".custom_only");a(this).attr("id")=="appForm-adUnitFormat-tablet-custom"||a(this).attr("id")=="appForm-adUnitFormat-custom"?g.show():g.hide()}).filter(":checked").click(),a(".adForm-format-image",b).click(function(b){var c=a(this),d=c.parents(".adForm-format");a('input[type="radio"]',d).click()}),a('.adForm-format-details input[type="text"]',b).focus(function(){var b=a(this),c=b.parents(".adForm-format");a('input[type="radio"]',c).click()})}),a("#adForm-tablet-formats").each(function(){var b=a(this);a(this).find('input[type="radio"]').click(function(b){var c=a(this).parent().index(),d=a("#adForm-images-container");d.children().hide();var e=d.children()[c];a(e).show().css({opacity:1});var f=a(".full_only"),g=a(".banner_only");a(this).attr("id")=="appForm-adUnitFormat-full-tablet"||a(this).attr("id")=="appForm-adUnitFormat-full"?(f.show(),g.hide()):(f.hide(),g.show());var h=a(".custom_only");a(this).attr("id")=="appForm-adUnitFormat-tablet-custom"||a(this).attr("id")=="appForm-adUnitFormat-custom"?h.show():h.hide()}).first().click()}),a("#adunit-device_format_phone").parent().children().filter(":checked").click().each(function(){var b=a(this).val(),c="#adForm-"+b+"-container";a(c).find(".possible-format").click()})}function k(){j(),a("#dashboard-apps-editAdUnitButton").button({icons:{primary:"ui-icon-wrench"}}).click(function(b){b.preventDefault(),a("#dashboard-adunitEditForm").is(":visible")?a("#dashboard-adunitEditForm").slideUp("fast"):a("#dashboard-adunitEditForm").slideDown("fast")}),a("#adunitEditForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#adunitForm-loading").show(),a("#adunitAddForm").submit()}),a("#adunitEditForm-cancel").click(function(b){b.preventDefault(),a("#dashboard-adunitEditForm").slideUp("fast")}),a("#adunitAddForm").ajaxForm({data:{ajax:!0},dataType:"json",success:function(b,c,d,e){a("#adunitForm-loading").hide(),b.success?window.location.reload():(h(),j(),window.location.hash="",window.location.hash="adunitForm")}})}function l(){a(".appData-details").each(function(){function e(){var b=a(".ui-button-text",d);return b=d,b.length!==0,b}function f(){c.removeClass("hide"),c.addClass("show"),d.button("option",{icons:{primary:"ui-icon-triangle-1-n"}}),e().text("Hide details")}function g(){c.removeClass("show"),c.addClass("hide"),d.button("option",{icons:{primary:"ui-icon-triangle-1-s"}}),e().text("Show details")}var b=a(this),c=a(".appData-details-inner",b),d=a(".appData-details-toggleButton",b);c.hasClass("show")?f():(c.hide(),g()),d.click(function(a){a.preventDefault(),c.hasClass("show")?(c.slideUp("fast"),g()):(c.slideDown("fast"),f())})})}function m(){a("#dashboard-dateOptions input").click(function(){var b=a(this).val();if(b=="custom")a("#dashboard-dateOptions-custom-modal").dialog({width:570,buttons:[{text:"Set dates",css:{fontWeight:"600"},click:function(){var b=a("#dashboard-dateOptions-custom-from").datepicker("getDate"),c=a("#dashboard-dateOptions-custom-to").datepicker("getDate"),d=Math.ceil((c.getTime()-b.getTime())/864e5)+1,e=b.getDate(),f=b.getMonth()+1,g=b.getFullYear();a(this).dialog("close");var h=document.location.href.replace(/\?.*/,"");document.location.href=h+"?r="+d+"&s="+g+"-"+f+"-"+e}},{text:"Cancel",click:function(){a(this).dialog("close")}}]});else{var c=document.location.href.replace(/\?.*/,"");document.location.href=c+"?r="+b}}),a("#stats-breakdown-dateOptions input").click(function(){a(".stats-breakdown-value").hide(),a(".stats-breakdown-value."+a(this).val()).show()}),a("#dashboard-dateOptions-custom-from").datepicker({defaultDate:"-15d",maxDate:"0d",onSelect:function(b){var c=a("#dashboard-dateOptions-custom-to"),d=a(this).data("datepicker"),e=a.datepicker.parseDate(d.settings.dateFormat||a.datepicker._defaults.dateFormat,b,d.settings);c.datepicker("option","minDate",e)}}),a("#dashboard-dateOptions-custom-to").datepicker({defaultDate:"-1d",maxDate:"0d",onSelect:function(b){var c=a("#dashboard-dateOptions-custom-from"),d=a(this).data("datepicker"),e=a.datepicker.parseDate(d.settings.dateFormat||a.datepicker._defaults.dateFormat,b,d.settings);c.datepicker("option","maxDate",e)}})}function n(){a("#dashboard-delete-link").click(function(b){b.preventDefault(),a("#dashboard-delete-modal").dialog({buttons:[{text:"Delete",click:function(){a(this).dialog("close"),a("#dashboard-deleteForm").submit()}},{text:"Cancel",click:function(){a(this).dialog("close")}}]})})}function o(){a("#appForm-search-button").button({icons:{primary:"ui-icon-search"}}).click(function(b){b.preventDefault();if(a(this).button("option","disabled"))return;a("#searchAppStore-loading").show(),a("#dashboard-searchAppStore-custom-modal").dialog({buttons:[{text:"Cancel",click:function(){a("#searchAppStore-results").html(""),a(this).dialog("close")}}]});var c=a('#appForm input[name="name"]').val(),d=document.createElement("script");d.src="http://ax.itunes.apple.com/WebObjects/MZStoreServices.woa/wa/wsSearch?entity=software&limit=10&callback=loadedArtwork&term="+c;var e=document.getElementsByTagName("head")[0];(e||document.body).appendChild(d)})}function p(){m(),a(".stats-breakdown tr").click(function(b){a("#dashboard-stats-chart").fadeOut(100,function(){mopub.Chart.setupDashboardStatsChart(d()),a(this).show()})})}function q(a){}var r={initializeIndex:function(b){p(),e(b.account_stats,b.start_date),f(b.app_keys),c.each(b.app_keys,function(a){g(a)}),a("#dashboard-apps-addAppButton").button({icons:{primary:"ui-icon-circle-plus"}}),a(".appData-id").each(function(){var b=a(this),c=b.parents("tr");c.hover(function(){b.show()},function(){b.hide()})})},initializeGeo:function(a){p(),mopub.Chart.setupDashboardStatsChart(d())},initializeAppDetail:function(b){p(),i(),j(),n(),o(),l(),mopub.Chart.setupDashboardStatsChart(d()),a("#publisher-app-exportSelect").change(function(b){b.preventDefault();var c=a(this).val();c!="exp"&&a("#appExportForm").find("#appExportType").val(c).end().submit(),a(this).selectmenu("index",0)}),a("#publisher-app-exportSelect-menu").find("li").first().hide()},initializeAdunitDetail:function(b){p(),n(),l(),k(),mopub.Chart.setupDashboardStatsChart(d()),a("#advertisers-testAdServer").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),a("#adserverTest").dialog({buttons:{Close:function(){a(this).dialog("close")}}}),a("#adserverTest-iFrame").attr("src",a("#adserverTest-iFrame-src").text())})},initializeAppCreate:function(a){p(),h(),j()}};window.DashboardController=r})(this.jQuery,this.Backbone,this._);var artwork_json;(function(a){a(document).ready(function(){function b(){a(".reportData-placeholder").hide(),a("table").each(function(){visible=a(this).find(".reportData:visible"),visible.length===0&&a(this).find(".reportData-placeholder").show()})}function c(b){var c=!0;return a("#d1Error").hide(),a("#dateError").hide(),a("select.selectmenu-required").each(function(){a(this).val()==""&&(a("#d1Error").show(),c=!1)}),a(".date-required").each(function(){a(this).removeClass("form-error"),a(this).val()==""&&(a(this).addClass("form-error"),a("#dateError").show(),c=!1)}),c}function e(){a.ajax({url:"http://"+window.location.host+"/reports/save/"+a("#reportKey").val()+"/",success:function(){a("#reports-view-toIndex").click()}})}function f(a){return a<10?"0"+a:a}function g(a){return f(a.getMonth()+1)+"/"+f(a.getDate())+"/"+a.getFullYear()}function j(b){d1_sel.selectmenu("index",b.d1),o(a("#d1")),d2_sel.selectmenu("index",b.d2),r(a("#d2")),d3_sel.selectmenu("index",b.d3),a("#end-input").val(b.end),a("#start-input").val(b.start),a("#interval").selectmenu("index",b.interv),a("#sched_interval").selectmenu("index",b.sched_interv),a("#interval").change(),a("#sched_interval").change(),a("#reportName-input").val(b.name),b.email?a("#email-input-checkbox").attr("checked"):a("#email-input-checkbox").removeAttr("checked")}function k(){return l(m(d1_sel),m(d2_sel),m(d3_sel),m(a("#interval")),m(a("#sched_interval")),a("#end-input").val(),a("#start-input").val(),a("#reportName-input").val(),a("#email-input-checkbox"))}function l(a,b,c,d,e,f,g,h,i){return{d1:a,d2:b,d3:c,interv:d,sched_interv:e,end:f,start:g,name:h,email:i.is(":checked")}}function m(a){return a.selectmenu("index")}function o(b){var c=b.selectmenu("index");for(var d=0;d<14;d++)d3_sel.selectmenu("enable",d),d2_sel.selectmenu("enable",d);var e=d2_sel.selectmenu("index"),f=d3_sel.selectmenu("index");a("#d2-show").show();switch(b.val()){case"":d2_sel.selectmenu("index",0),d3_sel.selectmenu("index",0),a("#d2-show").hide(),a("#d3-show").hide();break;case"adunit":e==2&&d2_sel.selectmenu("index",0),f==2&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","2"),d3_sel.selectmenu("disable","2");case"app":e==1&&d2_sel.selectmenu("index",0),f==1&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","1"),d3_sel.selectmenu("disable","1");break;case"creative":e==5&&d2_sel.selectmenu("index",0),f==5&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","5"),d3_sel.selectmenu("disable","5");case"campaign":e==4&&d2_sel.selectmenu("index",0),f==4&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","4"),d3_sel.selectmenu("disable","4");case"priority":e==3&&d2_sel.selectmenu("index",0),f==3&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","3"),d3_sel.selectmenu("disable","3");break;case"hour":e==9&&d2_sel.selectmenu("index",0),f==9&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","9"),d3_sel.selectmenu("disable","9");case"day":e==8&&d2_sel.selectmenu("index",0),f==8&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","8"),d3_sel.selectmenu("disable","8");case"week":e==7&&d2_sel.selectmenu("index",0),f==7&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","7"),d3_sel.selectmenu("disable","7");case"month":e==6&&d2_sel.selectmenu("index",0),f==6&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","6"),d3_sel.selectmenu("disable","6");break;case"country":e==10&&d2_sel.selectmenu("index",0),f==10&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable","10"),d3_sel.selectmenu("disable","10");break;case"marketing":e==11&&d2_sel.selectmenu("index",0),f==11&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable",11),d3_sel.selectmenu("disable",11);break;case"os_ver":e==13&&d2_sel.selectmenu("index",0),f==13&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable",13),d3_sel.selectmenu("disable",13);case"os":e==12&&d2_sel.selectmenu("index",0),f==12&&d3_sel.selectmenu("index",0),d2_sel.selectmenu("disable",12),d3_sel.selectmenu("disable",12);break;default:}}function q(a,b){for(p in b)if(typeof a[p]=="undefined")return!1;for(p in b)if(b[p])switch(typeof b[p]){case"object":if(!b[p].equals(a[p]))return!1;break;case"function":if(typeof a[p]=="undefined"||p!="equals"&&b[p].toString()!=a[p].toString())return!1;break;default:if(b[p]!=a[p])return!1}else if(a[p])return!1;for(p in a)if(typeof b[p]=="undefined")return!1;return!0}function r(b){var c=b.selectmenu("index"),d=d3_sel.selectmenu("index");a("#d3-show").show();switch(b.val()){case"":d3_sel.selectmenu("index",0),a("#d3-show").hide();break;case"adunit":d==2&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","2");case"app":d==1&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","1");break;case"creative":d==5&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","5");case"campaign":d==4&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","4");case"priority":d==3&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","3");break;case"hour":d==9&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","9");case"day":d==8&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","8");case"week":d==7&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","7");case"month":d==6&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","6");break;case"country":d==10&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable","10");break;case"marketing":d==11&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable",11);break;case"os_ver":d==13&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable",13);case"os":d==12&&d3_sel.selectmenu("index",0),d3_sel.selectmenu("disable",12);break;default:}}b(),a('input[name="start"]').datepicker().change(function(b){var c=new Date(a(this).val());a('input[name="end"]').datepicker("option","minDate",c)}),a('input[name="end"]').datepicker({maxDate:new Date}).change(function(b){var c=new Date(a(this).val());a('input[name="start"]').datepicker("option","maxDate",c)});var d;window.location.pathname=="/reports/"?d="Run":d="Save",a("#reportCreateForm-submit").button({label:d,icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(b){b.preventDefault(),c(a("#reportCreateForm"))?a("#reportCreateForm").submit():a("#formError").show()}),a("#reports-view-runReportButton").button({icons:{secondary:"ui-icon-circle-triangle-e"}}),a("#reports-view-saveAsButton").button({icons:{secondary:"ui-icon-check"}}).click(function(b){b.preventDefault(),a("#saveAs").val("True"),a("#reportName-input").val("Copy of "+a("#reportName-input").val()),a(".dim-selectmenu").selectmenu("disable"),a("#interval").selectmenu("disable"),a("#start-input").datepicker("disable"),a("#end-input").datepicker("disable"),a("#reportCreateForm-submit").button({label:"Save As"}),a("#sched_interval").selectmenu("index",0).change(),a("#reportForm-container").dialog({width:750})}),a("#reportCreateForm-cancel").button().click(function(b){b.preventDefault(),a("#reports-reportAddForm").slideUp("fast")}),a("#reports-addReportButton").button({icons:{primary:"ui-icon-circle-plus"}}).click(function(b){b.preventDefault();var c=a("#reports-reportAddForm");c.is(":hidden")?a("#reports-reportAddForm").slideDown("fast"):a("#reports-reportAddForm").slideUp("fast")}),a("#reports-view-editReportButton").button({icons:{primary:"ui-icon-wrench"}}).click(function(b){b.preventDefault(),a("#saveAs").val("False"),a("#reportCreateForm-submit").button({label:"Save"});var c=a("#reportForm-container");c.dialog({width:750})}),a("#reportCreateForm-cancel").button().click(function(b){b.preventDefault(),a(".dim-selectmenu").selectmenu("enable"),a("#interval").selectmenu("enable"),a("#start-input").datepicker("enable"),a("#end-input").datepicker("enable"),j(n),a(this).parents("#reportForm-container").dialog("close")}),a("#reportUpdateForm-cancel").button().click(function(b){b.preventDefault(),a(this).parents("#reportFormSaveAs-container").dialog("close")}),a("#reportUpdateForm-submit").button().click(function(b){b.preventDefault(),a("#start-input").datepicker("isDisabled")&&a("#start-input").datepicker("enable"),a("#end-input").datepicker("isDisabled")&&a("#end-input").datepicker("enable"),a(this).parents("form").submit()}),a("#reports-view-exportSelect").change(function(b){b.preventDefault();var c=a(this).val();c!="exp"&&a("#reportExportForm").find("#report-exportFtype").val(c).end().submit(),a(this).selectmenu("index",0)}),a("#reports-view-exportSelect-menu").find("li").first().hide(),a("#reports-view-exportButton").click(function(b){b.preventDefault(),a("#reportExportForm").submit()}),a(".int-selectmenu").selectmenu({style:"popup",maxHeight:300,width:115}),a("#sched_interval").selectmenu({style:"popup",maxHeight:300,width:135});var h=!0;a("#interval").change(function(b){h=!1;var c=a(this).val(),d=new Date;if(c=="custom")return;a("#interval-toggle").val(2);var e=864e5;switch(c){case"yesterday":d.setTime(d.getTime()-e);var f=g(d);a("#end-input").val(f).change(),a("#start-input").val(f).change();break;case"7days":var f=g(d);a("#end-input").val(f).change(),d.setTime(d.getTime()-7*e),f=g(d),a("#start-input").val(f).change();break;case"lmonth":var i=d.getMonth();while(d.getMonth()==i)d.setTime(d.getTime()-e);var f=g(d);a("#end-input").val(f).change(),d.setDate(1),f=g(d),a("#start-input").val(f).change()}}).change(),a(".date-field").change(function(b){var c=a("#interval-toggle").val();a("#interval-toggle").val()==0?a("#interval").selectmenu("index",3):a("#interval-toggle").val(c-1)});var i=a(".dim-selectmenu").selectmenu({style:"popup",maxHeight:320,width:110});d1_sel=a(i[0]),d2_sel=a(i[1]),d3_sel=a(i[2]);var n=k();a("#d1").change(function(b){a(this).val()!=""&&a("#d1Error").hide(),b.preventDefault(),o(a(this)),r(a("#d2"))}).change(),a("#d2").change(function(b){b.preventDefault(),o(a("#d1")),r(a(this))}),a(".update-button").change(function(b){b.preventDefault(),q(n,k())?a("#reportCreateForm-submit").button({label:"Save"}):a("#reportCreateForm-submit").button({label:"Save and Run"})}).change(),a("#sched_interval").change(function(b){a(".schedule-help").hide(),a(".schedule-help."+a(this).val()).show()}).change(),a("#email-input-checkbox").change(function(b){a(this).attr("checked")?a("#email-recipients").show():a("#email-recipients").hide()}).change(),a("#reportStateChangeForm-delete").click(function(b){b.preventDefault(),a("#reportStateChangeForm").find("#action").val("delete").end().submit()})})})(this.jQuery);
