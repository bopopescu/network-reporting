(function(a){a(document).ready(function(){function o(){a(".reportData-placeholder").hide();a("table").each(function(){visible=a(this).find(".reportData:visible");if(visible.length===0){a(this).find(".reportData-placeholder").show()}})}o();a('input[name="start"]').datepicker().change(function(t){var s=new Date(a(this).val());a('input[name="end"]').datepicker("option","minDate",s)});a('input[name="end"]').datepicker({maxDate:new Date()}).change(function(t){var s=new Date(a(this).val());a('input[name="start"]').datepicker("option","maxDate",s)});function d(s){var t=true;a("#d1Error").hide();a("#dateError").hide();a("select.selectmenu-required").each(function(){if(a(this).val()==""){a("#d1Error").show();t=false}});a(".date-required").each(function(){a(this).removeClass("form-error");if(a(this).val()==""){a(this).addClass("form-error");a("#dateError").show();t=false}});return t}var j;if(window.location.pathname=="/reports/"){j="Run"}else{j="Save"}a("#reportCreateForm-submit").button({label:j,icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(s){s.preventDefault();if(d(a("#reportCreateForm"))){a("#reportCreateForm").submit()}else{a("#formError").show()}});a("#reports-view-runReportButton").button({icons:{secondary:"ui-icon-circle-triangle-e"}});function c(){a.ajax({url:"http://"+window.location.host+"/reports/save/"+a("#reportKey").val()+"/",success:function(){a("#reports-view-toIndex").click()}})}a("#reports-view-saveAsButton").button({icons:{secondary:"ui-icon-check"}}).click(function(s){s.preventDefault();a("#saveAs").val("True");a("#reportName-input").val("Copy of "+a("#reportName-input").val());a(".dim-selectmenu").selectmenu("disable");a("#interval").selectmenu("disable");a("#start-input").datepicker("disable");a("#end-input").datepicker("disable");a("#reportCreateForm-submit").button({label:"Save As"});a("#sched_interval").selectmenu("index",0).change();a("#reportForm-container").dialog({width:750})});a("#reportCreateForm-cancel").button().click(function(s){s.preventDefault();a("#reports-reportAddForm").slideUp("fast")});a("#reports-addReportButton").button({icons:{primary:"ui-icon-circle-plus"}}).click(function(t){t.preventDefault();var s=a("#reports-reportAddForm");if(s.is(":hidden")){a("#reports-reportAddForm").slideDown("fast")}else{a("#reports-reportAddForm").slideUp("fast")}});a("#reports-view-editReportButton").button({icons:{primary:"ui-icon-wrench"}}).click(function(t){t.preventDefault();a("#saveAs").val("False");a("#reportCreateForm-submit").button({label:"Save"});var s=a("#reportForm-container");s.dialog({width:750})});a("#reportCreateForm-cancel").button().click(function(s){s.preventDefault();a(".dim-selectmenu").selectmenu("enable");a("#interval").selectmenu("enable");a("#start-input").datepicker("enable");a("#end-input").datepicker("enable");e(q);a(this).parents("#reportForm-container").dialog("close")});a("#reportUpdateForm-cancel").button().click(function(s){s.preventDefault();a(this).parents("#reportFormSaveAs-container").dialog("close")});a("#reportUpdateForm-submit").button().click(function(s){s.preventDefault();a(this).parents("form").submit()});a("#reports-view-exportSelect").change(function(s){s.preventDefault();var t=a(this).val();if(t!="exp"){a("#reportExportForm").find("#report-exportFtype").val(t).end().submit()}a(this).selectmenu("index",0)});a("#reports-view-exportSelect-menu").find("li").first().hide();a("#reports-view-exportButton").click(function(s){s.preventDefault();a("#reportExportForm").submit()});a(".int-selectmenu").selectmenu({style:"popup",maxHeight:300,width:115});a("#sched_interval").selectmenu({style:"popup",maxHeight:300,width:135,});function g(s){if(s<10){return"0"+s}return s}function n(s){return g(s.getMonth()+1)+"/"+g(s.getDate())+"/"+s.getFullYear()}var f=true;a("#interval").change(function(w){f=false;var x=a(this).val();var t=new Date();if(x!="custom"){a("#interval-toggle").val(2);var s=1000*60*60*24;switch(x){case"yesterday":t.setTime(t.getTime()-s);var u=n(t);a("#end-input").val(u).change();a("#start-input").val(u).change();break;case"7days":var u=n(t);a("#end-input").val(u).change();t.setTime(t.getTime()-(7*s));u=n(t);a("#start-input").val(u).change();break;case"lmonth":var v=t.getMonth();while(t.getMonth()==v){t.setTime(t.getTime()-s)}var u=n(t);a("#end-input").val(u).change();t.setDate(1);u=n(t);a("#start-input").val(u).change();break}}else{return}}).change();a(".date-field").change(function(t){var s=a("#interval-toggle").val();if(a("#interval-toggle").val()==0){a("#interval").selectmenu("index",3)}else{a("#interval-toggle").val(s-1)}});var k=a(".dim-selectmenu").selectmenu({style:"popup",maxHeight:320,width:110});d1_sel=a(k[0]);d2_sel=a(k[1]);d3_sel=a(k[2]);function e(s){d1_sel.selectmenu("index",s.d1);m(a("#d1"));d2_sel.selectmenu("index",s.d2);b(a("#d2"));d3_sel.selectmenu("index",s.d3);a("#end-input").val(s.end);a("#start-input").val(s.start);a("#interval").selectmenu("index",s.interv);a("#sched_interval").selectmenu("index",s.sched_interv);a("#interval").change();a("#sched_interval").change();a("#reportName-input").val(s.name);if(s.email){a("#email-input-checkbox").attr("checked")}else{a("#email-input-checkbox").removeAttr("checked")}}function i(){return r(h(d1_sel),h(d2_sel),h(d3_sel),h(a("#interval")),h(a("#sched_interval")),a("#end-input").val(),a("#start-input").val(),a("#reportName-input").val(),a("#email-input-checkbox"))}function r(t,s,A,y,x,w,v,u,z){return{d1:t,d2:s,d3:A,interv:y,sched_interv:x,end:w,start:v,name:u,email:z.is(":checked"),}}function h(s){return s.selectmenu("index")}var q=i();a("#d1").change(function(s){if(a(this).val()!=""){a("#d1Error").hide()}s.preventDefault();m(a(this));b(a("#d2"))}).change();function m(w){var t=w.selectmenu("index");for(var u=0;u<14;u++){d3_sel.selectmenu("enable",u);d2_sel.selectmenu("enable",u)}var v=d2_sel.selectmenu("index");var s=d3_sel.selectmenu("index");a("#d2-show").show();switch(w.val()){case"":d2_sel.selectmenu("index",0);d3_sel.selectmenu("index",0);a("#d2-show").hide();a("#d3-show").hide();break;case"adunit":if(v==2){d2_sel.selectmenu("index",0)}if(s==2){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","2");d3_sel.selectmenu("disable","2");case"app":if(v==1){d2_sel.selectmenu("index",0)}if(s==1){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","1");d3_sel.selectmenu("disable","1");break;case"creative":if(v==5){d2_sel.selectmenu("index",0)}if(s==5){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","5");d3_sel.selectmenu("disable","5");case"campaign":if(v==4){d2_sel.selectmenu("index",0)}if(s==4){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","4");d3_sel.selectmenu("disable","4");case"priority":if(v==3){d2_sel.selectmenu("index",0)}if(s==3){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","3");d3_sel.selectmenu("disable","3");break;case"hour":if(v==9){d2_sel.selectmenu("index",0)}if(s==9){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","9");d3_sel.selectmenu("disable","9");case"day":if(v==8){d2_sel.selectmenu("index",0)}if(s==8){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","8");d3_sel.selectmenu("disable","8");case"week":if(v==7){d2_sel.selectmenu("index",0)}if(s==7){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","7");d3_sel.selectmenu("disable","7");case"month":if(v==6){d2_sel.selectmenu("index",0)}if(s==6){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","6");d3_sel.selectmenu("disable","6");break;case"country":if(v==10){d2_sel.selectmenu("index",0)}if(s==10){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable","10");d3_sel.selectmenu("disable","10");break;case"marketing":if(v==11){d2_sel.selectmenu("index",0)}if(s==11){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable",11);d3_sel.selectmenu("disable",11);break;case"os_ver":if(v==13){d2_sel.selectmenu("index",0)}if(s==13){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable",13);d3_sel.selectmenu("disable",13);case"os":if(v==12){d2_sel.selectmenu("index",0)}if(s==12){d3_sel.selectmenu("index",0)}d2_sel.selectmenu("disable",12);d3_sel.selectmenu("disable",12);break;default:break}}a("#d2").change(function(s){s.preventDefault();m(a("#d1"));b(a(this))});a(".update-button").change(function(s){s.preventDefault();if(!l(q,i())){a("#reportCreateForm-submit").button({label:"Save and Run"})}else{a("#reportCreateForm-submit").button({label:"Save"})}}).change();function l(s,t){for(p in t){if(typeof(s[p])=="undefined"){return false}}for(p in t){if(t[p]){switch(typeof(t[p])){case"object":if(!t[p].equals(s[p])){return false}break;case"function":if(typeof(s[p])=="undefined"||(p!="equals"&&t[p].toString()!=s[p].toString())){return false}break;default:if(t[p]!=s[p]){return false}}}else{if(s[p]){return false}}}for(p in s){if(typeof(t[p])=="undefined"){return false}}return true}function b(u){var t=u.selectmenu("index");var s=d3_sel.selectmenu("index");a("#d3-show").show();switch(u.val()){case"":d3_sel.selectmenu("index",0);a("#d3-show").hide();break;case"adunit":if(s==2){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","2");case"app":if(s==1){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","1");break;case"creative":if(s==5){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","5");case"campaign":if(s==4){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","4");case"priority":if(s==3){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","3");break;case"hour":if(s==9){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","9");case"day":if(s==8){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","8");case"week":if(s==7){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","7");case"month":if(s==6){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","6");break;case"country":if(s==10){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable","10");break;case"marketing":if(s==11){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable",11);break;case"os_ver":if(s==13){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable",13);case"os":if(s==12){d3_sel.selectmenu("index",0)}d3_sel.selectmenu("disable",12);break;default:break}}a("#sched_interval").change(function(s){a(".schedule-help").hide();a(".schedule-help."+a(this).val()).show()}).change();a("#email-input-checkbox").change(function(s){if(a(this).attr("checked")){a("#email-recipients").show()}else{a("#email-recipients").hide()}}).change();a("#reportStateChangeForm-delete").click(function(s){s.preventDefault();a("#reportStateChangeForm").find("#action").val("delete").end().submit()})})})(this.jQuery);