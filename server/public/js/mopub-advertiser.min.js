var mopub=mopub||{};(function(a){a(document).ready(function(){if(typeof creatives=="undefined"){creatives=false}if(a("#is_admin_input").val()!="True"){a(".admin_only").hide()}function e(){a("#campaignAdgroupForm-budget-display").hide();a("#campaignAdgroupForm-budget-display_full").hide();if(a("#adgroupForm-bid_strategy-select").val()=="cpm"){var af=a('#campaignAdgroupForm input[name="bid"]').val();if(a("#adgroupForm-budget_type-select").val()=="daily"){var ai=a('#campaignAdgroupForm input[name="impressions"]').val();var ae=af*ai/1000;if(ae){var ag=ae.toFixed(2);a("#campaignAdgroupForm-budget-display").html("("+ag+" USD / day)");a('#campaignAdgroupForm input[name="budget"]').val(ae);a("#campaignAdgroupForm-budget-display").show()}else{a("#campaignAdgroupForm-budget-display").html(null);a('#campaignAdgroupForm input[name="budget"]').val(null)}}else{var ai=a('#campaignAdgroupForm input[name="full_impressions"]').val();var ah=af*ai/1000;if(ah){var aj=ah.toFixed(2);a("#campaignAdgroupForm-budget-display_full").html("("+aj+" total USD)");a('#campaignAdgroupForm input[name="full_budget"]').val(ah);a("#campaignAdgroupForm-budget-display_full").show()}else{a("#campaignAdgroupForm-budget-display_full").html(null);a('#campaignAdgroupForm input[name="full_budget"]').val(null)}}}}function m(){if(window.location.hash.substring(1)!==""){a("#campaign_type_select").val(window.location.hash.substring(1))}a("#campaign_type_select").change(function(aj){var ai=a(this).val();window.location.hash="#"+ai;a(".campaignDependent","#campaignAdgroupForm").hide();a("."+ai+".campaignDependent","#campaignAdgroupForm").show();a("#campaignAdgroupForm").find(".campaignDependent").hide().end().find("."+a(this).val()).show().end();if(a(this).val()=="network"){a("#bid_strategy :selected").removeAttr("selected");a("option#bid_strategy-cpm").attr("selected","selected");a("#bid-max").attr("name","bid-max");a("#bid-network").attr("name","bid");a("#adgroupForm-bid_strategy-select").attr("name","bid_strategy_std");a("#adgroupForm-bid_strategy-select-network").attr("name","bid_strategy")}else{a("#bid-network").attr("name","bid-network");a("#bid-max").attr("name","bid");a("#adgroupForm-bid_strategy-select").attr("name","bid_strategy");a("#adgroupForm-bid_strategy-select-network").attr("name","bid_strategy_network")}if(a(this).val()=="marketplace"){a("#mpx_message").removeClass("hidden");a(".ui-button-text","#campaignAdgroupForm-submit").text("Accept New Terms and Continue")}else{a("#mpx_message").addClass("hidden");a(".ui-button-text","#campaignAdgroupForm-submit").text("Continue")}}).change();a("#network_select").change(function(aj){var ai=a(this).val();a(".networkDependent").hide();a("."+ai+".networkDependent").show();if(ai=="admob_native"||ai=="millennial_native"){a("#network_select_sdk_msg").show()}else{a("#network_select_sdk_msg").hide()}if(ai=="iAd"){a("div.adunit-Target.mweb").hide().find("input").removeAttr("checked");a("div.adunit-Target.android").hide().find("input").removeAttr("checked")}else{a("div.adunit-Target:hidden").show()}}).change();a("#adgroupForm-budget_type-select").change(function(aj){var ai=a(this).val();a(".budgetDependent").hide();a("."+ai+".budgetDependent").show();if(a("#adgroupForm-bid_strategy-select").val()=="cpm"){if(ai=="full_campaign"){a("#campaignAdgroupForm-budget-display_full").show()}if(ai=="daily"){a("#campaignAdgroupForm-budget-display").show()}}}).change();a('#campaignAdgroupForm input[name="location-targeting"]').click(function(aj){var ai=a(this).val();a(".locationDependent","#campaignAdgroupForm").hide();a("."+ai+".locationDependent","#campaignAdgroupForm").show();if(a(this).val()=="all"){a("li.token-input-city span.token-input-delete-token").each(function(){a(this).click()})}}).filter(":checked").click();a("#adgroupForm-advanced-toggleButton").button("option",{icons:{primary:"ui-icon-triangle-1-s"}}).click(function(aj){aj.preventDefault();var ai=a(".ui-button-text",this);if(a(".adgroupForm-advanced").is(":hidden")){a(".adgroupForm-advanced").slideDown("fast");a(this).button("option",{icons:{primary:"ui-icon-triangle-1-n"}});a(".ui-button-text",this).text("Hide Advanced Details")}else{a(".adgroupForm-advanced").slideUp("fast");a(this).button("option",{icons:{primary:"ui-icon-triangle-1-s"}});a(".ui-button-text",this).text("Show Advanced Details")}});if(a("#adgroupForm-bid_strategy-select").val()=="cpm"){var ag=a('#campaignAdgroupForm input[name="bid"]').val();if(a("#adgroupForm-budget_type-select").val()=="daily"){var af=a('#campaignAdgroupForm input[name="budget"]').val();var ah=1000*af/ag;if(ah){fixed_impressions=ah.toFixed();a('#campaignAdgroupForm input[name="impressions"]').val(fixed_impressions);e()}}else{var af=a('#campaignAdgroupForm input[name="full_budget"]').val();var ae=1000*af/ag;if(ae){fixed_full_impressions=ae.toFixed();a('#campaignAdgroupForm input[name="full_impressions"]').val(fixed_full_impressions);e()}}}a("#adgroupForm-bid_strategy-select").change(function(){if(a(this).val()=="cpm"){a(".campaignAdgroupForm-budget").hide();a("#campaignAdgroupForm-budget-fullimpressions").show();a("#campaignAdgroupForm-budget-impressions").show();a("#adgroupForm-budget_type-select option[value='full_campaign']").text("total impressions");a("#adgroupForm-budget_type-select option[value='daily']").text("impressions/day")}else{a(".campaignAdgroupForm-budget").hide();a("#campaignAdgroupForm-budget-fullbid").show();a("#campaignAdgroupForm-budget-bid").show();a("#adgroupForm-budget_type-select option[value='full_campaign']").text("total USD");a("#adgroupForm-budget_type-select option[value='daily']").text("USD/day")}e()}).change();a('#campaignAdgroupForm input[name="impressions"]').keyup(function(){e()});a('#campaignAdgroupForm input[name="full_impressions"]').keyup(function(){e()});a("#bid-max").keyup(function(){e()});a("#terms").dialog({autoOpen:false,height:530,buttons:{OK:function(){a(this).dialog("close")}}});a("#accept_terms").click(function(){a("#terms").dialog("open")})}m();a("#campaignAdgroupForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(ae){ae.preventDefault();if(v(a("#campaignAdgroupForm"))){a("#campaignAdgroupForm").submit()}else{a("#formError").show()}});a(".adgroupForm-editNetwork-link").click(function(af){af.preventDefault();var ae=a(this).parents(".adgroupForm-Network");ae.find(".adgroupForm-editNetwork").show();ae.find(".adgroupForm-showNetwork").hide()});function v(ae){var af=true;a("#formError").hide();a("#fullCampaignError-date").hide();a("#fullCampaignError-budget").hide();a("#fullCampaignError-name").hide();a("#fullCampaignError-bid").hide();a('#campaignAdgroupForm input[name="start_date"]').removeClass("form-error");a('#campaignAdgroupForm input[name="end_date"]').removeClass("form-error");a('#campaignAdgroupForm input[name="full_budget"]').removeClass("form-error");a('#campaignAdgroupForm input[name="full_impressions"]').removeClass("form-error");a('#campaignAdgroupForm input[name="name"]').removeClass("form-error");a('#campaignAdgroupForm input[name="bid"]').removeClass("form-error");if(a("#adgroupForm-budget_type-select").val()=="full_campaign"&&a("input[name='campaign_type']").filter(":checked").val()=="gtee"){if(a("input[name='budget_strategy']").filter(":checked").val()=="evenly"){if(a('#campaignAdgroupForm input[name="start_date"]').val()==""){a('#campaignAdgroupForm input[name="start_date"]').addClass("form-error");a("#fullCampaignError-date").show();af=false}if(a('#campaignAdgroupForm input[name="end_date"]').val()==""){a('#campaignAdgroupForm input[name="end_date"]').addClass("form-error");a("#fullCampaignError-date").show();af=false}}if(a('#campaignAdgroupForm input[name="full_budget"]').val()==""){a('#campaignAdgroupForm input[name="full_budget"]').addClass("form-error");a('#campaignAdgroupForm input[name="full_impressions"]').addClass("form-error");a("#fullCampaignError-budget").show();af=false}if(a('#campaignAdgroupForm input[name="name"]').val()==""){a('#campaignAdgroupForm input[name="name"]').addClass("form-error");a("#fullCampaignError-name").show();af=false}if(a('#campaignAdgroupForm input[name="bid"]').val()==""){a('#campaignAdgroupForm input[name="bid"]').addClass("form-error");a("#fullCampaignError-bid").show();af=false}}return af}var A={data:{ajax:true},dataType:"json",success:function(af,ag,ah,ae){a("#campaignAdgroupForm-loading").hide();if(af.success){a("#campaignAdgroupForm-success").show();window.location=af.new_page;a("#campaignAdgroupForm-submit").button({label:"Success...",disabled:true})}else{m();a("#campaignAdgroupForm-submit").button({label:"Continue",disabled:false})}},error:function(ae,ag,af){a("#campaignAdgroupForm-submit").button({label:"Try Again",disabled:false})},beforeSubmit:function(ae,af,ag){a("#campaignAdgroupForm-submit").button({label:"Submitting...",disabled:true})}};a("#campaignAdgroupForm").validate(A);a("#campaignAdgroupForm").ajaxForm(A);a.each(["type","priority","promo-priority","customHtml","bid","keyword"],function(ae,af){a("#campaignForm-"+af+"-helpLink").click(function(ag){ag.preventDefault();a("#campaignForm-"+af+"-helpContent").dialog({buttons:{Close:function(){a(this).dialog("close")}}})})});a("#advertisers-testAdServer").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(ae){ae.preventDefault();a("#adserverTest").dialog({buttons:{Close:function(){a(this).dialog("close")}}});a("#adserverTest-iFrame").attr("src",a("#adserverTest-iFrame-src").text())});a('#campaignAdgroupForm input[name="start_date"]').datepicker({minDate:0});a('#campaignAdgroupForm input[name="end_date"]').datepicker({minDate:0});function y(af){a("#creativeManagementForm-action").val(af);var ae=a("#creativeManagementForm");ae.find('input[name="key"]').remove();a("#advertiser-creativeData").find('input[name="creativeManagementForm-key"]:checked').each(function(ag){a(this).val();a("<input></input>").attr("name","key").attr("type","hidden").val(a(this).val()).appendTo(ae)});ae.submit()}a.each(["pause","resume","delete"],function(ae,af){a("#creativeManagementForm-"+af).click(function(ag){ag.preventDefault();y(af)})});a(".creativeManagementForm-key").change(function(af){a('#creativeManagementForm input[name="key"]').remove();a(".creativeManagementForm-key:checked").each(function(ag){a(this).val()});var ae=a("#creativeManagementForm")});A={data:{ajax:true},dataType:"json",success:function(ae){a("#creativeCreateForm-loading").hide();if(ae.success){a("#creativeCreateForm-success").show();window.location.reload()}else{a.each(ae.errors,function(af,ai){a(".form-error-text","#creativeCreateForm").remove();var ag=ai[0];var ah=a("<div>").append(ai[1]).addClass("form-error-text");a("input[name="+ag+"]","#creativeCreateForm").addClass("error").parent().append(ah)});o();window.location.hash="";window.location.hash="advertiser-creativeAddForm";a("#campaignAdgroupForm-submit").button({label:"Continue",disabled:false})}},error:function(ae,ag,af){}};a("#creativeCreateForm").ajaxForm(A);a(".creativeEditForm").each(function(af){var ag=a(this);var ae={data:{ajax:true},dataType:"json",success:function(ai,aj,ak,ah){ah.find(".creativeEditForm-loading").hide();if(ai.success){ah.find(".creativeCreateForm-success").show();ah.parent();ah.find(".creativeCreateForm-success").hide();window.location.reload()}else{a(".form-error-text",ah).remove();a.each(ai.errors,function(al,ao){var am=ao[0];var an=a("<div>").append(ao[1]).addClass("form-error-text");a("input[name="+am+"]",ah).addClass("error").parent().append(an)});a('.creativeEditForm input[name="ad_type"]').click(function(al){a(this).parents("form").find(".adTypeDependent").hide().end().find("."+a(this).val()).show().end()}).filter(":checked").click();window.location.hash="";window.location.hash=ah.prev("a").attr("name")}}};a(this).ajaxForm(ae)});a(".creativeEditForm-submit").button().click(function(ae){ae.preventDefault();a(this).parents("form").find(".creativeEditForm-loading").show();a(this).parents("form").submit()});a(".creativeEditForm-cancel").button().click(function(ae){ae.preventDefault();a(this).parents(".advertiser-creativeEditForm").dialog("close")});a(".advertiser-inLineCreativePreview").button({icons:{primary:"ui-icon-search"}}).click(function(ai){ai.preventDefault();var af=a(this).attr("id");var ah=a("#"+af+"-preview-src").val();var ag=parseInt(a("#"+af+"-preview iframe").attr("width"));var ae=parseInt(a("#"+af+"-preview iframe").attr("height"));a("#"+af+"-preview iframe").attr("src",ah);a("#"+af+"-preview").dialog({buttons:[{text:"Close",click:function(){a(this).dialog("close")}}],width:ag+100,height:ae+130})});a(".advertiser-inLineCreativeToggle").button({icons:{primary:"ui-icon-wrench"}}).click(function(af){af.preventDefault();var ae=a(this).attr("id");var ag=a("#"+ae+"-edit");ag.dialog({width:1000})});a("#advertiser-adgroups-addCreativeButton").button({icons:{primary:"ui-icon-circle-plus"}}).click(function(ae){ae.preventDefault();var af=a("#advertiser-creativeAddForm");if(af.is(":hidden")){a("#advertiser-creativeAddForm").slideDown("fast")}else{a("#advertiser-creativeAddForm").slideUp("fast")}});if(!creatives){a("#chartWrapper").hide();a("#advertiser-creativeData").hide();a("#advertiser-adgroups-addCreativeButton").click()}function o(){a('#creativeCreateForm input[name="ad_type"]').click(function(ae){a(".adTypeDependent","#creativeCreateForm").hide();a(".adTypeDependent."+a(this).val(),"#creativeCreateForm").show()}).filter(":checked").click();a(".format-options").change(function(ae){ae.preventDefault();if(a(this).val()=="custom"){a(this).parents("form").find(".customc_only").show()}else{a(this).parents("form").find(".customc_only").hide()}if(a(this).val().search(/full/i)!=-1){a(this).parents().find(".full_only").show()}else{a(this).parents().find(".full_only").hide()}}).change()}o();a('.creativeEditForm input[name="ad_type"]').click(function(af){var ae=a(this).parents("form");a(".adTypeDependent",ae).hide();a(".adTypeDependent."+a(this).val(),ae).show()}).filter(":checked").click();a("#advertisers-addCampaign").button({icons:{primary:"ui-icon-circle-plus"}});a("#advertisers-adgroups-editAdGroupButton").button({icons:{primary:"ui-icon-wrench"}});a.each(["pause","resume","activate","archive","delete"],function(ae,af){a("#campaignForm-"+af).click(function(ag){ag.preventDefault();a("#campaignForm").find("#action").attr("value",af).end().submit()})});function r(){a(".campaignData").removeClass("campaignData-alt");a("table").each(function(){a(this).find(".campaignData:visible:odd").addClass("campaignData-alt")})}function c(ae){return"campaigns-filterOptions-option-"+ae.split("campaign-status-")[1]}function Y(){var ai=window.location.hash.split("&");var ak,ag;if(ai[0].indexOf("status")!=-1){ak=ai[0];ag=ai[1]}else{ak=ai[1];ag=ai[0]}try{ak=ak.split("status:")[1];ag=ag.split("app:")[1]}catch(ah){return}var af=a('input[value="'+ak+'"]');var ae=a('label[for="'+c(ak)+'"]');var aj=a('option[value="'+ag+'"]');aj.attr("selected","selected");af.click();ae.click()}Y();function V(ae){var af=parseInt(ae.replace(/,/g,""),10);return(isNaN(af))?0:af}function ab(ae){var af=parseFloat(ae.replace(/,/g,""));return(isNaN(af))?0:af}function N(ag,ah){var af=ag.split("_")[0];var ae="#"+af+"-loading-img";if(ah){a(ae).hide()}else{a(ae).show()}}function W(ah,al){var am,ae,ai,ak,ao,ag,ap,aj;am=ae=ai=ak=ao=ag=ap=aj=0;var an=ah.split("_")[0];var af=al?"":":visible";a("."+an+"-req"+af).each(function(){am+=V(a(this).text())});a("."+an+"-imp"+af).each(function(){ae+=V(a(this).text())});a("."+an+"-clk"+af).each(function(){ai+=V(a(this).text())});a("."+an+"_row"+af+" ."+an+"-rev").each(function(){ak+=ab(a(this).text().replace("$",""))});a("."+an+"-conv"+af).each(function(){ao+=V(a(this).text())});ag=(ai===0||ae===0)?0:ai/ae;ap=(ae===0||am===0)?0:ae/am;aj=(ak===0||ae===0)?0:1000*(ak/ae);a("#"+an+"-total-req").text(mopub.Utils.formatNumberWithCommas(am));a("#"+an+"-total-imp").text(mopub.Utils.formatNumberWithCommas(ae));a("#"+an+"-total-clk").text(mopub.Utils.formatNumberWithCommas(ai));a("#"+an+"-total-rev").text("$"+mopub.Utils.formatNumberWithCommas(ak.toFixed(2)));a("#"+an+"-total-conv").text(mopub.Utils.formatNumberWithCommas(ao));a("#"+an+"-total-ctr").text(mopub.Utils.formatNumberAsPercentage(ag));a("#"+an+"-total-fill").text(mopub.Utils.formatNumberAsPercentage(ap)+" ("+mopub.Utils.formatNumberWithCommas(am)+")");a("#"+an+"-total-ecpm").text("$"+mopub.Utils.formatNumberWithCommas(aj.toFixed(2)));a("#"+an+"-rollups").show();N(ah,true)}function d(){if(!g()){return}var ae=[n.Guaranteed,n.Promotional,n.Marketplace,n.Network,n.Backfill];a.each(ae,function(ag,ah){var af=(ah===n.Marketplace);W(ah,af)})}var n={Guaranteed:"gtee_row",Promotional:"promo_row",Network:"network_row",Backfill:"bfill_row",Marketplace:"marketplace_row",BackfillMarketplace:"backfill_marketplace_row",All:"campaignData"};var M={status:"status",on_schedule:"on_schedule",revenue:"rev",impression_count:"imp",conversion_count:"conv",request_count:"req",click_count:"clk",cpa:"cpa",cpc:"cpc",cpm:"ecpm",ctr:"ctr",fill_rate:"fill"};var s={};var S,H,T,B,ad,I;if(mopub.isCampaignsPage){setTimeout(w,0)}else{mopub.Chart.setupDashboardStatsChart(i())}function w(){l();J();G(true);b(mopub.accountStats);E(mopub.accountStats);t()}function l(){var ae=u(n.Guaranteed);if(ae.length==0){a("#stats-breakdown-revenue").hide()}else{a("#stats-breakdown-revenue").show()}}function u(ae){return a("."+ae).map(function(){return a(this).attr("id")})}function J(){a("#ajaxRetry").click(function(ae){x();a("#ajaxFailure").fadeOut();ae.preventDefault()});a("#ajaxDismiss").click(function(ae){a("#ajaxFailure").fadeOut();ae.preventDefault()})}function x(){var ae=[S,H,T,B,ad,I];a.each(ae,function(af,ag){if(ag.hasFailed){N(ag.campaignType,false);ag.start()}})}function G(ae){a("#campaigns-filterOptions").buttonset({disabled:ae})}function b(aj){var ai=aj.all_stats["||"];var ah=ai.daily_stats;var ag;var af;var ae=D(ah[ah.length-1]);if(ah.length>=2){ag=D(ah[ah.length-2])}af=D(ai.sum);a("#stats-breakdown-impressions .today .inner").html(ae.impression_count);a("#stats-breakdown-revenue .today .inner").html(ae.revenue);a("#stats-breakdown-clicks .today .inner").html(ae.click_count);a("#stats-breakdown-ctr .today .inner").html(ae.ctr);if(ag!=null){a("#stats-breakdown-impressions .yesterday .inner").html(ag.impression_count);a("#stats-breakdown-revenue .yesterday .inner").html(ag.revenue);a("#stats-breakdown-clicks .yesterday .inner").html(ag.click_count);a("#stats-breakdown-ctr .yesterday .inner").html(ag.ctr)}a("#stats-breakdown-impressions .all .inner").html(af.impression_count);a("#stats-breakdown-revenue .all .inner").html(af.revenue);a("#stats-breakdown-clicks .all .inner").html(af.click_count);a("#stats-breakdown-ctr .all .inner").html(af.ctr)}function D(ag){var af=a.extend(true,{},ag);af.impression_count=mopub.Utils.formatNumberWithCommas(af.impression_count);af.conversion_count=mopub.Utils.formatNumberWithCommas(af.conversion_count)+" ("+mopub.Utils.formatNumberAsPercentage(af.conv_rate)+")";af.request_count=mopub.Utils.formatNumberWithCommas(af.request_count);af.click_count=mopub.Utils.formatNumberWithCommas(af.click_count);af.cpa="$"+af.cpa.toFixed(2);af.cpc="$"+af.cpc.toFixed(2);af.cpm="$"+af.cpm.toFixed(2);af.revenue="$"+af.revenue.toFixed(2);af.ctr=mopub.Utils.formatNumberAsPercentage(af.ctr);af.fill_rate=mopub.Utils.formatNumberAsPercentage(af.fill_rate);var ae="";if(af.status=="Running"){if(af.on_schedule=="on pace"){ae='<span class="osi-success"> On pace <a href="#" id="campaign-osi-success-helpLink" class="whatsthis"><div class="whatsthis-icon"></div></a></span>'}else{if(af.on_schedule=="behind"){ae='<span class="osi-failure""> Behind <a href="#" id="campaign-osi-failure-helpLink" class="whatsthis"><div class="whatsthis-icon"></div></a></span>'}}}af.on_schedule=ae;return af}function E(ae){var af=ae.all_stats["||"]["daily_stats"];mopub.dashboardStatsChartData={pointStart:mopub.graphStartDate,pointInterval:86400000,impressions:[{Total:mopub.Stats.statArrayFromDailyStats(af,"impression_count")}],revenue:[{Total:mopub.Stats.statArrayFromDailyStats(af,"revenue")}],clicks:[{Total:mopub.Stats.statArrayFromDailyStats(af,"click_count")}],ctr:[{Total:mopub.Stats.statArrayFromDailyStats(af,"ctr")}]};mopub.Chart.setupDashboardStatsChart(i())}function t(){var al=u(n.All);a.each(al,function(an,ao){s[ao]={}});var ah={days:f()||14,startDate:h()};var am=u(n.Guaranteed);var ae=u(n.Promotional);var aj=u(n.Network);var ak=u(n.Backfill);var af=u(n.Marketplace);var ag=u(n.BackfillMarketplace);S=Q(am,ah);S.campaignType=n.Guaranteed;H=Q(ae,ah);H.campaignType=n.Promotional;T=Q(aj,ah);T.campaignType=n.Network;B=Q(ak,ah);B.campaignType=n.Backfill;ad=Q(af,ah);ad.campaignType=n.Marketplace;I=Q(ag,ah);I.campaignType=n.BackfillMarketplace;var ai=[S,H,T,B,ad,I];a.each(ai,function(an,ao){N(ao.campaignType,false);ao.start()})}function f(){var ae=a("input[name=dashboard-dateOptions-option]:checked").val();if(!ae||ae=="custom"){var ah=document.location.href;var ag=/r=(\d+)/g;var af=ag.exec(ah);if(!af||af.length<2){return null}else{return af[1]}}else{return ae}}function h(){var ag=document.location.href;var af=/s=(\d+-\d+-\d+)/g;var ae=af.exec(ag);if(!ae||ae.length<2){return null}else{return ae[1]}}function Q(ag,ae){var af={items:ag,urlConstructor:F,chunkComplete:q,chunkFailure:j,fetchComplete:X};a.extend(true,af,ae);return new mopub.Utils.AjaxChunkedFetch(af)}function F(ag,ae){var af="/campaigns/stats/ajax/?";a.each(ag,function(ah,ai){if(ah==0){af+="adv="+ai}else{af+="&adv="+ai}});if(ae.days){af+="&date_range="+ae.days}if(ae.startDate){af+="&start_date="+ae.startDate}return af}function q(al,ah,ag){var ak=al.all_stats;for(var aj in ak){var ae=aj.split("||")[1];var ai=ak[aj]["sum"];s[ae]=ak[aj];var af=D(ai);a.each(af,function(am,an){U(ae,am,an)});aa(ae,af.status);k()}p()}function U(ai,ah,ag){if(!ai){return}var af=M[ah];if(!af){return}var ae="#"+ai+" ."+af;a(ae).html(ag)}function aa(af,ag){var ae="#"+af;a(ae).removeClass("incomplete").addClass("complete").addClass("campaign-status-"+ag)}function k(){a(".complete .ecpm-helpLink").html("What's this?");a(".whatsthis").click(function(ae){ae.preventDefault();a("#"+a(this).attr("id").replace("helpLink","helpContent")).dialog({buttons:{Close:function(){a(this).dialog("close")}}})})}function j(af,ae){a("#ajaxFailure").show();N(ae.campaignType,true)}function X(af){var ag=af.campaignType;var ae=(ag===n.Marketplace);W(ag,ae);if(g()){ac()}}function g(){return(S&&S.isComplete&&H&&H.isComplete&&T&&T.isComplete&&B&&B.isComplete&&ad&&ad.isComplete&&I&&I.isComplete)}function ac(){G(false);d();R()}function R(){mopub.dashboardStatsChartData={pointStart:mopub.graphStartDate,pointInterval:86400000,impressions:O(),revenue:C(),clicks:P(),ctr:z()};mopub.Chart.setupDashboardStatsChart(i())}function L(ae){var ag=u(ae);var af=[];a.each(s,function(ah,ai){if(a.inArray(ah,ag)!=-1){var aj={};aj.key=ai.name.replace("||","");aj.stats=ai;af.push(aj)}});return af}function O(){var af=L(n.All);var ae=mopub.Stats.sortStatsObjectsByStat(af,"impression_count");return mopub.Stats.getGraphSummedStatsForStatName("impression_count",ae)}function C(){var af=L(n.Guaranteed);var ae=mopub.Stats.sortStatsObjectsByStat(af,"revenue");return mopub.Stats.getGraphSummedStatsForStatName("revenue",ae)}function P(){var af=L(n.All);var ae=mopub.Stats.sortStatsObjectsByStat(af,"impression_count");return mopub.Stats.getGraphSummedStatsForStatName("click_count",ae)}function z(){var ai=L(n.All);var ah=mopub.Stats.sortStatsObjectsByStat(ai,"impression_count");var ae=mopub.Stats.getGraphCtrStats(ah);var ag=mopub.accountStats.all_stats["||"]["daily_stats"];var af={"MoPub Optimized":mopub.Stats.statArrayFromDailyStats(ag,"ctr"),};ae.push(af);return ae}function Z(){var af=false;a.each([a("#campaignDataTable-direct-high"),a("#campaignDataTable-direct-low"),a("#campaignDataTable-direct-normal")],function(){a(this).show()});function ae(){var ag=a(this).find(".campaignData:visible");if(ag.length===0){a(this).hide()}else{af=true}}a.each([a("#campaignDataTable-direct-high"),a("#campaignDataTable-direct-low")],ae);if(af){a.each([a("#campaignDataTable-direct-normal")],ae)}}function p(){var af=a("#campaigns-filterOptions").find(":checked").val();if(!af){return}var ae=a("#campaigns-appFilterOptions").val();window.location.hash="status:"+af+"&app:"+ae;a(".campaignData").hide();a("."+ae).filter("."+af).show();Z();r();d()}a("#campaigns-filterOptions, #campaigns-appFilterOptions").change(function(){p()});p();a("#campaigns-appFilterOptions").selectmenu({style:"popup",maxHeight:300,width:184});a("#creativeCreateForm-submit").button({icons:{secondary:"ui-icon-circle-triangle-e"}}).click(function(ae){ae.preventDefault();a("#creativeCreateForm-loading").show();a("#creativeCreateForm").submit()});a("#creativeCreateForm-cancel").button().click(function(ae){ae.preventDefault();a("#advertiser-creativeAddForm").slideUp("fast",function(){a("#advertiser-adgroups-addCreativeButton").show()})});a(".creativeFormAdvancedToggleButton").button("option",{icons:{primary:"ui-icon-triangle-1-s"}}).click(function(af){af.preventDefault();var ae=a(this).parents("form").find(".creativeForm-advanced-options");if(ae.is(":hidden")){ae.slideDown("fast").removeClass("hidden");a(this).button("option",{icons:{primary:"ui-icon-triangle-1-n"}});a(".ui-button-text",this).text("Less Options")}else{ae.slideUp("fast").addClass("hidden");a(this).button("option",{icons:{primary:"ui-icon-triangle-1-s"}});a(".ui-button-text",this).text("More Options")}});a(".creativeAddForm-url-helpLink").click(function(ae){ae.preventDefault();a("#creativeAddForm-url-helpContent").dialog({buttons:{Close:function(){a(this).dialog("close")}}})});a('#creativeAddForm input[name="creative_type"]').click(function(ae){a("#creativeCreate-text_icon").hide();a("#creativeCreate-image").hide();a("#creativeCreate-html").hide();a("#creativeCreate-"+a(this).val()).show()}).filter(":checked").click();a("#creativeAddForm-cancel").button().click(function(ae){ae.preventDefault();a("#advertiser-creativeAddForm").slideUp("fast",function(){a("#advertiser-adgroups-addCreativeButton").show()})});a("#campaign-status-options").change(function(ae){var af=a(this).val();a("#fake-campaignForm").find("#action").attr("value",af).end().submit()});a("#campaign-status-options-menu").find("li").first().hide();a("#device_targeting_False").click(function(){a("#target-by-device").slideUp()});a("#device_targeting_True").click(function(){a("#target-by-device").slideDown()});if(a("#device_targeting_True:checked").length===0){a("#target-by-device").hide()}function i(){var ae=a("#dashboard-stats .stats-breakdown .active");if(ae.attr("id")=="stats-breakdown-ctr"){return"line"}else{return"area"}}a(".stats-breakdown tr").click(function(ae){a("#dashboard-stats-chart").fadeOut(100,function(){mopub.Chart.setupDashboardStatsChart(i());a(this).show()})});a("#dashboard-dateOptions input").click(function(){var af=a(this).val();var ag=document.location.hash;if(af=="custom"){a("#dashboard-dateOptions-custom-modal").dialog({width:570,buttons:[{text:"Set dates",css:{fontWeight:"600"},click:function(){var am=a("#dashboard-dateOptions-custom-from").datepicker("getDate");var ai=a("#dashboard-dateOptions-custom-to").datepicker("getDate");var ak=Math.ceil((ai.getTime()-am.getTime())/(86400000))+1;var al=am.getDate();var ah=am.getMonth()+1;var an=am.getFullYear();a(this).dialog("close");var aj=document.location.href.replace(ag,"").replace(/\?.*/,"");document.location.href=aj+"?r="+ak+"&s="+an+"-"+ah+"-"+al+ag}},{text:"Cancel",click:function(){a(this).dialog("close")}}]})}else{var ae=document.location.href.replace(ag,"").replace(/\?.*/,"");document.location.href=ae+"?r="+af+ag}});a("#stats-breakdown-dateOptions input").click(function(){a(".stats-breakdown-value").hide();a(".stats-breakdown-value."+a(this).val()).show()});a("#dashboard-dateOptions-custom-from").datepicker({defaultDate:"-15d",maxDate:"0d",onSelect:function(ah){var af=a("#dashboard-dateOptions-custom-to");var ae=a(this).data("datepicker");var ag=a.datepicker.parseDate(ae.settings.dateFormat||a.datepicker._defaults.dateFormat,ah,ae.settings);af.datepicker("option","minDate",ag)}});a("#dashboard-dateOptions-custom-to").datepicker({defaultDate:"-1d",maxDate:"0d",onSelect:function(ah){var af=a("#dashboard-dateOptions-custom-from");var ae=a(this).data("datepicker");var ag=a.datepicker.parseDate(ae.settings.dateFormat||a.datepicker._defaults.dateFormat,ah,ae.settings);af.datepicker("option","maxDate",ag)}});a("#dashboard-apps-addAppButton").button({icons:{primary:"ui-icon-circle-plus"}});a("#dashboard-apps-editAppButton").button({icons:{primary:"ui-icon-wrench"}});a("#dashboard-apps-toggleAllButton").button({icons:{primary:"ui-icon-triangle-2-n-s"}}).click(function(ae){ae.preventDefault()});a(".appData-details").each(function(){var ag=a(this);var ah=a(".appData-details-inner",ag);var af=a(".appData-details-toggleButton",ag);function aj(){var ak=a(".ui-button-text",af);if(ak.length===0){ak=af}return ak}function ae(){ah.removeClass("hide");ah.addClass("show");af.button("option",{icons:{primary:"ui-icon-triangle-1-n"}});aj().text("Hide details")}function ai(){ah.removeClass("show");ah.addClass("hide");af.button("option",{icons:{primary:"ui-icon-triangle-1-s"}});aj().text("Show details")}if(ah.hasClass("show")){ae()}else{ah.hide();ai()}af.click(function(ak){ak.preventDefault();if(ah.hasClass("show")){ah.slideUp("fast");ai()}else{ah.slideDown("fast");ae()}})});a("#dashboard-apps-toggleAllButton").click(function(ae){ae.preventDefault();var af=a(".appData-details .hide").parents(".appData-details");var ag=a(".appData-details .show").parents(".appData-details");if(af.length>0){af.each(function(){a(".appData-details-toggleButton",a(this)).click()})}else{ag.each(function(){a(".appData-details-toggleButton",a(this)).click()})}});a("#advertiser-adgroups-exportSelect").change(function(ae){ae.preventDefault();var af=a(this).val();if(af!="exp"){a("#campaignExportForm").find("#campaignExportType").val(af).end().submit()}a(this).selectmenu("index",0)});a("#advertiser-adgroups-exportSelect-menu").find("li").first().hide();if(a("#campaignForm-details")!=[]){var K=window.location.hash.substr(1);a("#advertiser-CampaignType-"+K).click()}})})(this.jQuery);