
{% extends "publisher/base.html" %}

{% load filters %}


{% block content %}
	<h3>		
		Apps
		<div class="toolbar">
      <button onClick="location.href='{% url publisher_app_create %}'" class="btn"><span><span>+ New App</span></span></button>
      &nbsp; &nbsp; &nbsp; &nbsp;<a href="{% url publisher_index_geo %}">Heat Map</a>
    <div class="graphselect">
      <button class="btn btn_active pill-l" onClick="show_today(this);"><span><span>Today</span></span></button>
      <button class="btn pill-r" onClick="show_yesterday(this);"><span><span>Yesterday</span></span></button>
    </div>
		</div>
	</h3>
  {% if not apps %}
	<p>
		<b>Apps</b> are your individual applications.  You can create <b>Ad Units</b> are used to organize your mobile inventory. Each ad unit should be a single ad slot in your app.<br/> 
	</p> 
  {% endif %}
		
  <table class="rollups">
    <tr>
      <td class="rollup rollup_selected" onClick="show_graph_imp(this);"><b>Requests</b><br/><div class="data_today">{{today.request_count|withsep}}</div><div class="data_yesterday" style="display:none;">{{yesterday.request_count|withsep}}</div></td>
      <td class="rollup" onClick="show_graph_imp(this);"><b>Impressions</b><br/><div class="data_today">{{today.impression_count|withsep}}</div><div class="data_yesterday" style="display:none;">{{yesterday.impression_count|withsep}}</div></td>
      <td class="rollup" onClick="show_graph_clk(this);"><b>Clicks</b><br/><div class="data_today">{{today.click_count|withsep}} ({{today.ctr|percentage}})</div><div class="data_yesterday" style="display:none;">{{yesterday.click_count|withsep}} ({{yesterday.ctr|percentage}})</div></td>      	
	    <td class="rollup" onClick="show_graph_rev(this);"><b>Revenue (est.)</b><br/><div class="data_today">{{today.revenue|currency}}</div><div class="data_yesterday" style="display:none;">{{yesterday.revenue|currency}}</div></td>
	    <td class="rollup" onClick="show_graph_users(this);"><b>Users</b><br/><div class="data_today">{{today.unique_user_count|withsep}}</div><div class="data_yesterday" style="display:none;">{{yesterday.unique_user_count|withsep}}</div></td>
	
    </tr>
  </table> 
	<img id="chart_img" src="{{chart_urls.imp}}" width=580 height=200 style="padding: 5px 0 10px 0;"/>
	<img id="pie_chart_img" src="{{pie_chart_urls.imp}}" width=200 height=200 style="padding: 5px 0 10px 0; float:right;"/>
  <div style="padding:12px;position:relative">
  {% include "range_select.html" %}
  </div>  
	<table class="wide">
		<thead>
			<tr>
			<th width="50px">App</th>
			<th>Ad Unit</th>
			<th class="numeric">Requests</th>
			<th class="numeric">Clicks</th>
			<th class="numeric">CTR</th>
			</tr>
		</thead>
		{% for a in apps %}
			<tr class="highlighted">
				<td colspan="2"><a href="{% url publisher_app_show app_key=a.key %}"><b>{{a.name}}</b></a> ({{a.app_type}})</td>
				<td class="numeric"><strong>{{a.stats.request_count|withsep}}</strong></td>
				<td class="numeric"><strong>{{a.stats.click_count|withsep}}</strong></td>
				<td class="numeric"><strong>{{a.stats.ctr|percentage}}</strong></td>
			</tr>
		  {% for au in a.adunits %}
			<tr>
        <td></td>
				<td><a href="{% url publisher_adunit_show adunit_key=au.key %}">{{au.name}}</a></td>
				<td class="numeric">{{au.stats.request_count|withsep}}</td>
				<td class="numeric">{{au.stats.click_count|withsep}}</td>
				<td class="numeric">{{au.stats.ctr|percentage}}</td>
			</tr>
		  {% endfor %}
		{% endfor %}
	</table>
	
{% endblock %}
