{% extends 'publisher/base.html' %}

{% load filters %}

{% block pageTitleTag %}
  - Dashboard β
{% endblock %}

{% block extraScripts %}
{% include_script "controllers/dashboard" %}

{% include_script "libs/rickshaw" %}
{% include_script "libs/Rickshaw.Graph.Axis.X" %}
{% include_script "libs/Rickshaw.Graph.MoPubHoverDetail" %}
{% include_script "libs/moment.min" %}

<script type="text/javascript">
$(function () {
    DashboardController.initializeDashboard({
        account: '{{ account.key }}',
        names: {{ names|to_json|safe }}
    });
});
</script>
<script id="chart" type="text/html">
{% include 'publisher/partials/dashboard_chart.html' %}
</script>
<script id="filter_header_row" type="text/html">
{% include 'publisher/partials/dashboard_filter_header_row.html' %}
</script>
<script id="filter_body_row" type="text/html">
{% include 'publisher/partials/dashboard_filter_body_row.html' %}
</script>
{% endblock extraScripts %}

{% block pageTitle %}
  <h1>Dashboard (β)</h1>
{% endblock pageTitle %}

{% block dateButtons %}{% endblock dateButtons %}

{% block titleBarRight %}{% endblock titleBarRight %}

{% block content %}

  <div id="controls">

    <div id="datepicker-custom-range" class="hidden">
      <div class="date-field-container">
        <span class="start-date date-label"> From: </span>
        <input id="datepicker-start-input"
               name="start-date"
               type="text"
               value='{{ start_date|date:'m-d-Y' }}'
               data-date='{{ start_date|date:'m-d-Y' }}'
               data-date-format="mm-dd-yyyy" />
      </div>
      <div class="date-field-container">
        <span class="end-date date-label"> To: </span>
        <input id="datepicker-end-input"
               name="end-date"
               type="text"
               value="{{ end_date|date:"m-d-Y" }}"
               data-date='{{ end_date|date:'m-d-Y' }}'
               data-date-format="mm-dd-yyyy" />
       </div>
       <a id="custom-date-submit" class="right btn btn-primary"> Submit </a>
    </div>

    <select name="date_range">
      <option value="day">Day</option>
      <option selected="selected" value="week">Week</option>
      <option value="two_weeks">Two Weeks</option>
      <option value="custom">Custom</option>
    </select>
    <span class="hidden" id="custom_date_range"></span>

    <select name="granularity">
      <option value="hourly">Hourly</option>
      <option selected="selected" value="daily">Daily</option>
    </select>

    <label>
      <input name="compare" type="checkbox" /> Compare to <span id="comparison_range">the week before</span>
    </label>

    <button class="btn btn-small" id="export">Export</button>

    <div class="modal hidden" id="export_wizard">
      <div class="modal-header">
        <a class="close" data-dismiss="modal">×</a>
        <h3>Export</h3>
        </div>
        <div class="modal-body">
          Breakdown by
          <select name="advertiser_breakdown">
            <option value=""></option>
            <option value="source">Source</option>
            <option value="campaign">Campaign</option>
            <option value="adgroup">Ad Group</option>
          </select>
          and
          <select name="publisher_breakdown">
            <option value=""></option>
            <option value="app">App</option>
            <option value="adunit">Ad Unit</option>
          </select>
        </div>
        <div class="modal-footer">
          <button class="btn" data-dismiss="modal">Cancel</button>
          <button class="btn btn-primary" id="download">Download</button>
        </div>
    </div>

</div>

<div id="charts">

  <div id="rev" class="chart_container">

    <div class="summed_stats">
      <div class="title">Revenue</div>
      <div class="value"></div>
      <div class="delta"></div>
    </div>

    <div id="rev_chart" class="chart"></div>

  </div>

  <div id="imp" class="chart_container">

    <div class="summed_stats">
      <div class="title">Impressions</div>
      <div class="value"></div>
      <div class="delta"></div>
    </div>

    <div id="imp_chart" class="chart"></div>

  </div>

  <div id="clk" class="chart_container">

    <div class="summed_stats">
      <div class="title">Clicks</div>
      <div class="value"></div>
      <div class="delta"></div>
    </div>

    <div id="clk_chart" class="chart"></div>

  </div>

  <div id="ctr" class="chart_container">

    <div class="summed_stats">
      <div class="title">CTR</div>
      <div class="value"></div>
      <div class="delta"></div>
    </div>

    <div id="ctr_chart" class="chart"></div>

  </div>

</div>

<div id="advertiser_filters">
    <input id="advertiser_order" type="hidden" value="rev" />
    <label><input name="advertiser_compare" type="checkbox" /> Compare</label>
    <table id="advertiser">
        <thead>
        </thead>
        <tbody>
        </tbody>
    </table>
    <button class="btn btn-small" id="advertiser_expand">more</button>
</div>

<div id="publisher_filters">
    <input id="publisher_order" type="hidden" value="rev" />
    <label><input name="publisher_compare" type="checkbox" /> Compare</label>
    <table id="publisher">
        <thead>
        </thead>
        <tbody>
        </tbody>
    </table>
    <button class="btn btn-small" id="publisher_expand">more</button>
</div>
{% endblock content %}
